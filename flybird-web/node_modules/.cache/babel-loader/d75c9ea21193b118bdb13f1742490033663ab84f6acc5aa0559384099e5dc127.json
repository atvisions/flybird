{"ast":null,"code":"import { createCommentVNode as _createCommentVNode } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _createCommentVNode(\" No changes to template section \");\n}","map":{"version":3,"names":["_createCommentVNode"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/user/MyProfile/components/UserHome.vue"],"sourcesContent":["<template>\n  <!-- No changes to template section -->\n</template>\n\n<script setup>\n// No changes to imports or setup section\n\n// 用户信息的计算属性\nconst userInfo = computed(() => {\n  return {\n    uid: store.state.userInfo?.data?.uid,\n    username: store.state.userInfo?.data?.username || '未设置用户名',\n    avatar: store.state.userInfo?.data?.avatar,\n    background_image: store.state.userInfo?.data?.background_image,\n    bio: store.state.userInfo?.data?.bio || null,\n    position: store.state.userInfo?.data?.position || null\n  }\n})\n\n// 计算背景图 URL\nconst backgroundUrl = computed(() => {\n  const bgImage = userInfo.value?.background_image\n  return bgImage ? formatImageUrl(bgImage) : defaultBackground\n})\n\n// 处理背景图上传\nconst handleBackgroundUpload = async () => {\n  // 创建文件输入框\n  const input = document.createElement('input')\n  input.type = 'file'\n  input.accept = 'image/*'\n  \n  // 监听文件选择\n  input.onchange = async (e) => {\n    const file = e.target.files[0]\n    if (!file) return\n    \n    // 验证文件\n    if (!file.type.startsWith('image/')) {\n      showToast('请选择图片文件', 'error')\n      return\n    }\n    \n    const maxSize = 5 * 1024 * 1024 // 5MB\n    if (file.size > maxSize) {\n      showToast('图片大小不能超过5MB', 'error')\n      return\n    }\n    \n    try {\n      loading.value = true\n      const response = await user.uploadBackground(file)\n      if (response.data?.code === 200) {\n        showToast('背景图上传成功', 'success')\n        // 更新 store 中的用户信息\n        store.commit('SET_USER_INFO', {\n          ...store.state.userInfo,\n          data: {\n            ...store.state.userInfo.data,\n            background_image: response.data.data.background_image\n          }\n        })\n      } else {\n        throw new Error(response.data?.message || '上传失败')\n      }\n    } catch (error) {\n      console.error('背景图上传失败:', error)\n      showToast(error.message || '背景图上传失败，请稍后重试', 'error')\n    } finally {\n      loading.value = false\n      input.value = ''  // 清空文件选择器\n    }\n  }\n  \n  // 触发文件选择\n  input.click()\n}\n\n// No changes to rest of the script section\n</script>\n\n<style scoped>\n/* No changes to style section */\n</style> "],"mappings":";;SACEA,mBAAA,oCAAuC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}