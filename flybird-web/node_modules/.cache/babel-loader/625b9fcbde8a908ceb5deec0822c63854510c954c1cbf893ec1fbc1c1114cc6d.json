{"ast":null,"code":"import { createElementVNode as _createElementVNode, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"fixed inset-0 overflow-y-auto\"\n};\nconst _hoisted_2 = {\n  class: \"flex min-h-full items-center justify-center p-4 text-center\"\n};\nconst _hoisted_3 = {\n  class: \"mt-2 p-4 bg-blue-50 rounded-lg\"\n};\nconst _hoisted_4 = {\n  class: \"flex\"\n};\nconst _hoisted_5 = {\n  class: \"flex-shrink-0\"\n};\nconst _hoisted_6 = {\n  class: \"mt-4\"\n};\nconst _hoisted_7 = {\n  class: \"flex flex-col items-center\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"relative w-full h-64 mb-4 bg-gray-100 rounded-lg overflow-hidden\"\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200 mb-4\"\n};\nconst _hoisted_10 = [\"src\"];\nconst _hoisted_11 = {\n  class: \"cursor-pointer inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n};\nconst _hoisted_12 = {\n  class: \"mt-6 flex justify-end space-x-3\"\n};\nconst _hoisted_13 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"TransitionRoot\"], {\n    appear: \"\",\n    show: $props.modelValue,\n    as: \"template\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Dialog\"], {\n      as: \"div\",\n      class: \"relative z-50\",\n      onClose: $setup.closeDialog\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0\",\n        \"enter-to\": \"opacity-100\",\n        leave: \"duration-200 ease-in\",\n        \"leave-from\": \"opacity-100\",\n        \"leave-to\": \"opacity-0\"\n      }, {\n        default: _withCtx(() => _cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n          class: \"fixed inset-0 bg-black/25\"\n        }, null, -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0 scale-95\",\n        \"enter-to\": \"opacity-100 scale-100\",\n        leave: \"duration-200 ease-in\",\n        \"leave-from\": \"opacity-100 scale-100\",\n        \"leave-to\": \"opacity-0 scale-95\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"DialogPanel\"], {\n          class: \"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all\"\n        }, {\n          default: _withCtx(() => [_createVNode($setup[\"DialogTitle\"], {\n            as: \"h3\",\n            class: \"text-lg font-medium leading-6 text-gray-900\"\n          }, {\n            default: _withCtx(() => _cache[1] || (_cache[1] = [_createTextVNode(\" 上传职业头像 \")])),\n            _: 1 /* STABLE */\n          }), _createCommentVNode(\" 提示信息 \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createVNode($setup[\"InformationCircleIcon\"], {\n            class: \"h-5 w-5 text-blue-400\"\n          })]), _cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n            class: \"ml-3\"\n          }, [_createElementVNode(\"p\", {\n            class: \"text-sm text-blue-700\"\n          }, \" 一张专业的职业头像能让您的简历更加出众： \"), _createElementVNode(\"ul\", {\n            class: \"mt-2 text-sm text-blue-600 list-disc list-inside\"\n          }, [_createElementVNode(\"li\", null, \"建议使用正面照，保持微笑\"), _createElementVNode(\"li\", null, \"着装整洁得体，背景简单\"), _createElementVNode(\"li\", null, \"光线充足，图片清晰\")])], -1 /* HOISTED */))])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createCommentVNode(\" 裁剪区域 \"), $setup.imageUrl ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_createVNode($setup[\"Cropper\"], {\n            ref: \"cropperRef\",\n            class: \"cropper\",\n            src: $setup.imageUrl,\n            \"stencil-props\": {\n              aspectRatio: 1\n            },\n            \"default-size\": {\n              width: '80%',\n              height: '80%'\n            },\n            \"image-restriction\": \"stencil\",\n            \"default-boundaries\": {\n              width: '100%',\n              height: '100%'\n            },\n            \"default-position\": {\n              left: '50%',\n              top: '50%'\n            }\n          }, null, 8 /* PROPS */, [\"src\"])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 预览区域 \"), $setup.imageUrl ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [$setup.previewUrl ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 0,\n            src: $setup.previewUrl,\n            class: \"w-full h-full object-cover\",\n            alt: \"预览\"\n          }, null, 8 /* PROPS */, _hoisted_10)) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 上传按钮 \"), _createElementVNode(\"label\", _hoisted_11, [_createElementVNode(\"input\", {\n            type: \"file\",\n            class: \"hidden\",\n            accept: \"image/*\",\n            onChange: $setup.handleFileChange\n          }, null, 32 /* NEED_HYDRATION */), _createTextVNode(\" \" + _toDisplayString($setup.imageUrl ? '重新选择' : '选择图片'), 1 /* TEXT */)])])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50\",\n            onClick: $setup.closeDialog\n          }, \" 取消 \"), _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700\",\n            disabled: !$setup.hasImage,\n            onClick: $setup.handleCrop\n          }, \" 确认上传 \", 8 /* PROPS */, _hoisted_13)])]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })])])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"show\"]);\n}","map":{"version":3,"names":["class","key","_createBlock","$setup","appear","show","$props","modelValue","as","default","_withCtx","_createVNode","onClose","closeDialog","enter","leave","_cache","_createElementVNode","_","_hoisted_1","_hoisted_2","_createTextVNode","_createCommentVNode","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","imageUrl","_createElementBlock","_hoisted_8","ref","src","width","height","left","top","_hoisted_9","previewUrl","alt","_hoisted_10","_hoisted_11","type","accept","onChange","handleFileChange","_toDisplayString","_hoisted_12","onClick","disabled","hasImage","handleCrop","_hoisted_13"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/components/ProfileAvatarCropper.vue"],"sourcesContent":["<template>\n  <TransitionRoot appear :show=\"modelValue\" as=\"template\">\n    <Dialog as=\"div\" class=\"relative z-50\" @close=\"closeDialog\">\n      <TransitionChild\n        as=\"template\"\n        enter=\"duration-300 ease-out\"\n        enter-from=\"opacity-0\"\n        enter-to=\"opacity-100\"\n        leave=\"duration-200 ease-in\"\n        leave-from=\"opacity-100\"\n        leave-to=\"opacity-0\"\n      >\n        <div class=\"fixed inset-0 bg-black/25\" />\n      </TransitionChild>\n\n      <div class=\"fixed inset-0 overflow-y-auto\">\n        <div class=\"flex min-h-full items-center justify-center p-4 text-center\">\n          <TransitionChild\n            as=\"template\"\n            enter=\"duration-300 ease-out\"\n            enter-from=\"opacity-0 scale-95\"\n            enter-to=\"opacity-100 scale-100\"\n            leave=\"duration-200 ease-in\"\n            leave-from=\"opacity-100 scale-100\"\n            leave-to=\"opacity-0 scale-95\"\n          >\n            <DialogPanel class=\"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all\">\n              <DialogTitle as=\"h3\" class=\"text-lg font-medium leading-6 text-gray-900\">\n                上传职业头像\n              </DialogTitle>\n\n              <!-- 提示信息 -->\n              <div class=\"mt-2 p-4 bg-blue-50 rounded-lg\">\n                <div class=\"flex\">\n                  <div class=\"flex-shrink-0\">\n                    <InformationCircleIcon class=\"h-5 w-5 text-blue-400\" />\n                  </div>\n                  <div class=\"ml-3\">\n                    <p class=\"text-sm text-blue-700\">\n                      一张专业的职业头像能让您的简历更加出众：\n                    </p>\n                    <ul class=\"mt-2 text-sm text-blue-600 list-disc list-inside\">\n                      <li>建议使用正面照，保持微笑</li>\n                      <li>着装整洁得体，背景简单</li>\n                      <li>光线充足，图片清晰</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"mt-4\">\n                <div class=\"flex flex-col items-center\">\n                  <!-- 裁剪区域 -->\n                  <div v-if=\"imageUrl\" class=\"relative w-full h-64 mb-4 bg-gray-100 rounded-lg overflow-hidden\">\n                    <Cropper\n                      ref=\"cropperRef\"\n                      class=\"cropper\"\n                      :src=\"imageUrl\"\n                      :stencil-props=\"{\n                        aspectRatio: 1\n                      }\"\n                      :default-size=\"{\n                        width: '80%',\n                        height: '80%'\n                      }\"\n                      image-restriction=\"stencil\"\n                      :default-boundaries=\"{ width: '100%', height: '100%' }\"\n                      :default-position=\"{ left: '50%', top: '50%' }\"\n                    />\n                  </div>\n\n                  <!-- 预览区域 -->\n                  <div v-if=\"imageUrl\" class=\"w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200 mb-4\">\n                    <img v-if=\"previewUrl\" :src=\"previewUrl\" class=\"w-full h-full object-cover\" alt=\"预览\" />\n                  </div>\n\n                  <!-- 上传按钮 -->\n                  <label class=\"cursor-pointer inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\">\n                    <input\n                      type=\"file\"\n                      class=\"hidden\"\n                      accept=\"image/*\"\n                      @change=\"handleFileChange\"\n                    >\n                    {{ imageUrl ? '重新选择' : '选择图片' }}\n                  </label>\n                </div>\n              </div>\n\n              <div class=\"mt-6 flex justify-end space-x-3\">\n                <button\n                  type=\"button\"\n                  class=\"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50\"\n                  @click=\"closeDialog\"\n                >\n                  取消\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700\"\n                  :disabled=\"!hasImage\"\n                  @click=\"handleCrop\"\n                >\n                  确认上传\n                </button>\n              </div>\n            </DialogPanel>\n          </TransitionChild>\n        </div>\n      </div>\n    </Dialog>\n  </TransitionRoot>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { Cropper } from 'vue-advanced-cropper'\nimport 'vue-advanced-cropper/dist/style.css'\nimport {\n  Dialog,\n  DialogPanel,\n  DialogTitle,\n  TransitionChild,\n  TransitionRoot,\n} from '@headlessui/vue'\nimport { InformationCircleIcon } from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\n\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    required: true\n  }\n})\n\nconst emit = defineEmits(['update:modelValue', 'upload'])\n\nconst cropperRef = ref(null)\nconst imageUrl = ref('')\nconst previewUrl = ref('')\nconst hasImage = ref(false)\n\n// 处理文件选择\nconst handleFileChange = (event) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  // 验证文件类型\n  if (!file.type.startsWith('image/')) {\n    showToast('请选择图片文件', 'error')\n    return\n  }\n\n  // 验证文件大小（2MB）\n  const maxSize = 2 * 1024 * 1024\n  if (file.size > maxSize) {\n    showToast('图片大小不能超过 2MB', 'error')\n    return\n  }\n\n  // 创建预览\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    imageUrl.value = e.target.result\n    hasImage.value = true\n  }\n  reader.readAsDataURL(file)\n}\n\n// 处理裁剪\nconst handleCrop = async () => {\n  if (!cropperRef.value || !hasImage.value) return\n  \n  try {\n    const { coordinates, canvas } = cropperRef.value.getResult()\n    \n    // 将 canvas 转换为 blob\n    canvas.toBlob(async (blob) => {\n      // 创建文件对象\n      const file = new File([blob], 'profile_avatar.png', { type: 'image/png' })\n      \n      // 触发上传事件\n      await emit('upload', file)\n      \n      // 清理\n      clearImage()\n    }, 'image/png', 0.9)\n  } catch (error) {\n    console.error('裁剪失败:', error)\n    showToast('图片处理失败，请重试', 'error')\n  }\n}\n\n// 关闭对话框\nconst closeDialog = () => {\n  emit('update:modelValue', false)\n  clearImage()\n}\n\n// 清理图片\nconst clearImage = () => {\n  imageUrl.value = ''\n  previewUrl.value = ''\n  hasImage.value = false\n}\n\n// 监听裁剪变化\nconst onCrop = ({ coordinates, canvas }) => {\n  previewUrl.value = canvas.toDataURL()\n}\n\n// 监听对话框关闭\nwatch(() => props.modelValue, (newVal) => {\n  if (!newVal) {\n    clearImage()\n  }\n})\n</script>\n\n<style>\n.cropper {\n  height: 100%;\n  background: #f3f4f6;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}