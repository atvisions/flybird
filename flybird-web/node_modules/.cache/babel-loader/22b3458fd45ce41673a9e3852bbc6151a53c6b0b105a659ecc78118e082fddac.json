{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_card_title = _resolveComponent(\"v-card-title\");\n  const _component_v_text_field = _resolveComponent(\"v-text-field\");\n  const _component_v_select = _resolveComponent(\"v-select\");\n  const _component_v_file_input = _resolveComponent(\"v-file-input\");\n  const _component_v_textarea = _resolveComponent(\"v-textarea\");\n  const _component_v_switch = _resolveComponent(\"v-switch\");\n  const _component_v_form = _resolveComponent(\"v-form\");\n  const _component_v_card_text = _resolveComponent(\"v-card-text\");\n  const _component_v_spacer = _resolveComponent(\"v-spacer\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_v_dialog = _resolveComponent(\"v-dialog\");\n  return _openBlock(), _createBlock(_component_v_dialog, {\n    \"model-value\": $props.modelValue,\n    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => _ctx.$emit('update:modelValue', $event)),\n    \"max-width\": \"600\",\n    persistent: \"\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_card, null, {\n      default: _withCtx(() => [_createVNode(_component_v_card_title, {\n        class: \"text-h5\"\n      }, {\n        default: _withCtx(() => _cache[8] || (_cache[8] = [_createTextVNode(\"保存为模板\")])),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_card_text, null, {\n        default: _withCtx(() => [_createVNode(_component_v_form, {\n          ref: \"form\",\n          modelValue: $setup.valid,\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.valid = $event)\n        }, {\n          default: _withCtx(() => [_createVNode(_component_v_text_field, {\n            modelValue: $setup.formData.name,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.formData.name = $event),\n            label: \"模板名称\",\n            rules: [v => !!v || '请输入模板名称'],\n            required: \"\",\n            \"validate-on\": \"input\"\n          }, null, 8 /* PROPS */, [\"modelValue\", \"rules\"]), $setup.categories.length > 0 ? (_openBlock(), _createBlock(_component_v_select, {\n            key: 0,\n            modelValue: $setup.formData.category,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.formData.category = $event),\n            items: $setup.categories,\n            \"item-title\": \"name\",\n            \"item-value\": \"id\",\n            label: \"选择分类\",\n            rules: [v => !!v || '请选择分类'],\n            required: \"\",\n            \"validate-on\": \"input\"\n          }, null, 8 /* PROPS */, [\"modelValue\", \"items\", \"rules\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_v_file_input, {\n            modelValue: $setup.formData.thumbnail,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.formData.thumbnail = $event),\n            label: \"缩略图\",\n            accept: \"image/*\",\n            rules: [v => !!v || '请上传缩略图', v => !v || !v.length || v[0].size < 2000000 || '图片大小不能超过2MB'],\n            required: \"\",\n            \"validate-on\": \"input\",\n            onChange: $setup.handleFileChange,\n            \"show-size\": \"\",\n            \"prepend-icon\": \"mdi-camera\"\n          }, null, 8 /* PROPS */, [\"modelValue\", \"rules\"]), _createVNode(_component_v_textarea, {\n            modelValue: $setup.formData.description,\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.formData.description = $event),\n            label: \"模板描述\",\n            rules: [v => !!v || '请输入模板描述'],\n            required: \"\",\n            \"validate-on\": \"input\"\n          }, null, 8 /* PROPS */, [\"modelValue\", \"rules\"]), _createVNode(_component_v_switch, {\n            modelValue: $setup.formData.is_vip,\n            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.formData.is_vip = $event),\n            label: \"VIP模板\",\n            color: \"primary\"\n          }, null, 8 /* PROPS */, [\"modelValue\"])]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_card_actions, null, {\n        default: _withCtx(() => [_createVNode(_component_v_spacer), _createVNode(_component_v_btn, {\n          color: \"grey-darken-1\",\n          variant: \"text\",\n          onClick: _cache[6] || (_cache[6] = $event => _ctx.$emit('update:modelValue', false))\n        }, {\n          default: _withCtx(() => _cache[9] || (_cache[9] = [_createTextVNode(\" 取消 \")])),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_btn, {\n          color: \"primary\",\n          variant: \"text\",\n          loading: $setup.loading,\n          disabled: !$setup.valid,\n          onClick: $setup.handleSave\n        }, {\n          default: _withCtx(() => _cache[10] || (_cache[10] = [_createTextVNode(\" 保存 \")])),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"loading\", \"disabled\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model-value\"]);\n}","map":{"version":3,"names":["_createBlock","_component_v_dialog","$props","modelValue","_cache","$event","_ctx","$emit","persistent","default","_withCtx","_createVNode","_component_v_card","_component_v_card_title","class","_createTextVNode","_","_component_v_card_text","_component_v_form","ref","$setup","valid","_component_v_text_field","formData","name","label","rules","v","required","categories","length","_component_v_select","key","category","items","_createCommentVNode","_component_v_file_input","thumbnail","accept","size","onChange","handleFileChange","_component_v_textarea","description","_component_v_switch","is_vip","color","_component_v_card_actions","_component_v_spacer","_component_v_btn","variant","onClick","loading","disabled","handleSave"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/SaveTemplateDialog.vue"],"sourcesContent":["<template>\n  <v-dialog\n    :model-value=\"modelValue\"\n    @update:model-value=\"$emit('update:modelValue', $event)\"\n    max-width=\"600\"\n    persistent\n  >\n    <v-card>\n      <v-card-title class=\"text-h5\">保存为模板</v-card-title>\n      <v-card-text>\n        <v-form ref=\"form\" v-model=\"valid\">\n          <v-text-field\n            v-model=\"formData.name\"\n            label=\"模板名称\"\n            :rules=\"[v => !!v || '请输入模板名称']\"\n            required\n            validate-on=\"input\"\n          ></v-text-field>\n\n          <v-select\n            v-if=\"categories.length > 0\"\n            v-model=\"formData.category\"\n            :items=\"categories\"\n            item-title=\"name\"\n            item-value=\"id\"\n            label=\"选择分类\"\n            :rules=\"[v => !!v || '请选择分类']\"\n            required\n            validate-on=\"input\"\n          ></v-select>\n\n          <v-file-input\n            v-model=\"formData.thumbnail\"\n            label=\"缩略图\"\n            accept=\"image/*\"\n            :rules=\"[\n              v => !!v || '请上传缩略图',\n              v => !v || !v.length || v[0].size < 2000000 || '图片大小不能超过2MB'\n            ]\"\n            required\n            validate-on=\"input\"\n            @change=\"handleFileChange\"\n            show-size\n            prepend-icon=\"mdi-camera\"\n          ></v-file-input>\n\n          <v-textarea\n            v-model=\"formData.description\"\n            label=\"模板描述\"\n            :rules=\"[v => !!v || '请输入模板描述']\"\n            required\n            validate-on=\"input\"\n          ></v-textarea>\n\n          <v-switch\n            v-model=\"formData.is_vip\"\n            label=\"VIP模板\"\n            color=\"primary\"\n          ></v-switch>\n        </v-form>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn \n          color=\"grey-darken-1\" \n          variant=\"text\" \n          @click=\"$emit('update:modelValue', false)\"\n        >\n          取消\n        </v-btn>\n        <v-btn\n          color=\"primary\"\n          variant=\"text\"\n          :loading=\"loading\"\n          :disabled=\"!valid\"\n          @click=\"handleSave\"\n        >\n          保存\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script setup>\nimport { ref, watch, onMounted } from 'vue'\nimport { useTemplateStore } from '@/stores/template'\n\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    required: true\n  }\n})\n\nconst emit = defineEmits(['update:modelValue', 'save'])\n\n// 表单数据\nconst form = ref(null)\nconst valid = ref(false)\nconst loading = ref(false)\nconst formData = ref({\n  name: '',\n  category: null,\n  thumbnail: null,\n  description: '',\n  is_vip: false\n})\n\n// 模板分类\nconst templateStore = useTemplateStore()\nconst categories = ref([])\n\n// 获取分类数据\nconst fetchCategories = async () => {\n  try {\n    const response = await templateStore.getCategories()\n    if (response.code === 200) {\n      categories.value = response.data\n    } else {\n      console.error('获取分类失败:', response.message)\n      categories.value = []\n    }\n  } catch (error) {\n    console.error('获取分类出错:', error)\n    categories.value = []\n  }\n}\n\n// 监听对话框显示状态\nwatch(() => props.modelValue, (val) => {\n  if (val) {\n    if (categories.value.length === 0) {\n      fetchCategories()\n    }\n  }\n  if (!val) {\n    // 重置表单\n    form.value?.reset()\n    formData.value = {\n      name: '',\n      category: null,\n      thumbnail: null,\n      description: '',\n      is_vip: false\n    }\n    valid.value = false\n  }\n})\n\n// 处理文件变化\nconst handleFileChange = async (files) => {\n  if (files && files.length > 0) {\n    const file = files[0]\n    if (file.size > 2000000) {\n      formData.value.thumbnail = null\n      return\n    }\n  }\n  await validateForm()\n}\n\n// 手动验证表单\nconst validateForm = async () => {\n  if (form.value) {\n    const { valid: isValid } = await form.value.validate()\n    valid.value = isValid\n  }\n}\n\n// 监听表单数据变化\nwatch(formData, async () => {\n  await validateForm()\n}, { deep: true })\n\n// 保存模板\nconst handleSave = async () => {\n  await validateForm()\n  if (!valid.value) return\n\n  loading.value = true\n  try {\n    // 检查必填字段\n    if (!formData.value.category) {\n      throw new Error('请选择分类')\n    }\n    if (!formData.value.thumbnail) {\n      throw new Error('请上传缩略图')\n    }\n\n    // 转换布尔值为字符串\n    const data = {\n      ...formData.value,\n      is_vip: formData.value.is_vip.toString()\n    }\n    emit('save', data)\n  } catch (error) {\n    console.error('保存失败:', error)\n    throw error\n  } finally {\n    loading.value = false\n  }\n}\n\n// 初始化时获取分类数据\nonMounted(() => {\n  if (props.modelValue) {\n    fetchCategories()\n  }\n})\n</script> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}