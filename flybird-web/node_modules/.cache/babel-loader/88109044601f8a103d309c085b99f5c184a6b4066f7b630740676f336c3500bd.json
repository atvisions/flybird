{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { useUserStore } from '@/stores/user';\nexport function useChangePassword() {\n  const userStore = useUserStore();\n  const state = ref({\n    oldPassword: '',\n    newPassword: '',\n    confirmPassword: '',\n    loading: false,\n    error: '',\n    strength: 0\n  });\n  const validatePassword = password => {\n    if (!password) return 0;\n    let strength = 0;\n\n    // 长度检查 (8-20位)\n    if (password.length >= 8 && password.length <= 20) strength++;\n\n    // 包含字母\n    if (/[a-zA-Z]/.test(password)) strength++;\n\n    // 包含数字\n    if (/\\d/.test(password)) strength++;\n\n    // 包含大写字母\n    if (/[A-Z]/.test(password)) strength++;\n\n    // 包含特殊字符\n    if (/[!@#$%^&*]/.test(password)) strength++;\n\n    // 添加调试日志\n    console.log('Password strength check:', {\n      password: password.replace(/./g, '*'),\n      // 隐藏实际密码\n      length: password.length,\n      hasLetters: /[a-zA-Z]/.test(password),\n      hasNumbers: /\\d/.test(password),\n      hasUppercase: /[A-Z]/.test(password),\n      hasSpecial: /[!@#$%^&*]/.test(password),\n      strength\n    });\n    return strength;\n  };\n  const checkPasswordStrength = password => {\n    let score = 0;\n    if (password.length >= 8) score += 1;\n    if (password.length >= 12) score += 1;\n    if (/[a-z]/.test(password)) score += 1;\n    if (/[A-Z]/.test(password)) score += 1;\n    if (/\\d/.test(password)) score += 1;\n    if (/[!@#$%^&*]/.test(password)) score += 1;\n    return score;\n  };\n  const updatePasswordStrength = password => {\n    state.value.strength = checkPasswordStrength(password);\n  };\n  const isPasswordValid = computed(() => {\n    const password = state.value.newPassword;\n    return password && password.length >= 8 && /[A-Za-z]/.test(password) && /\\d/.test(password);\n  });\n  const strengthText = computed(() => {\n    const strength = state.value.strength;\n    if (strength <= 1) return '弱';\n    if (strength <= 3) return '中';\n    if (strength <= 5) return '强';\n    return '非常强';\n  });\n  const strengthTextClass = computed(() => {\n    const strength = state.value.strength;\n    if (strength <= 1) return 'text-red-500';\n    if (strength <= 3) return 'text-yellow-500';\n    if (strength <= 5) return 'text-green-500';\n    return 'text-green-600';\n  });\n  const strengthColorClass = computed(() => {\n    const strength = state.value.strength;\n    if (strength <= 1) return 'bg-red-500';\n    if (strength <= 3) return 'bg-yellow-500';\n    if (strength <= 5) return 'bg-green-500';\n    return 'bg-green-600';\n  });\n  return {\n    state,\n    validatePassword,\n    updatePasswordStrength,\n    isPasswordValid,\n    strengthText,\n    strengthTextClass,\n    strengthColorClass,\n    userStore\n  };\n}","map":{"version":3,"names":["ref","computed","useUserStore","useChangePassword","userStore","state","oldPassword","newPassword","confirmPassword","loading","error","strength","validatePassword","password","length","test","console","log","replace","hasLetters","hasNumbers","hasUppercase","hasSpecial","checkPasswordStrength","score","updatePasswordStrength","value","isPasswordValid","strengthText","strengthTextClass","strengthColorClass"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/composables/useChangePassword.js"],"sourcesContent":["import { ref, computed } from 'vue'\nimport { useUserStore } from '@/stores/user'\n\nexport function useChangePassword() {\n  const userStore = useUserStore()\n  const state = ref({\n    oldPassword: '',\n    newPassword: '',\n    confirmPassword: '',\n    loading: false,\n    error: '',\n    strength: 0\n  })\n\n  const validatePassword = (password) => {\n    if (!password) return 0\n    \n    let strength = 0\n    \n    // 长度检查 (8-20位)\n    if (password.length >= 8 && password.length <= 20) strength++\n    \n    // 包含字母\n    if (/[a-zA-Z]/.test(password)) strength++\n    \n    // 包含数字\n    if (/\\d/.test(password)) strength++\n    \n    // 包含大写字母\n    if (/[A-Z]/.test(password)) strength++\n    \n    // 包含特殊字符\n    if (/[!@#$%^&*]/.test(password)) strength++\n    \n    // 添加调试日志\n    console.log('Password strength check:', {\n      password: password.replace(/./g, '*'),  // 隐藏实际密码\n      length: password.length,\n      hasLetters: /[a-zA-Z]/.test(password),\n      hasNumbers: /\\d/.test(password),\n      hasUppercase: /[A-Z]/.test(password),\n      hasSpecial: /[!@#$%^&*]/.test(password),\n      strength\n    })\n    \n    return strength\n  }\n\n  const checkPasswordStrength = (password) => {\n    let score = 0\n    \n    if (password.length >= 8) score += 1\n    if (password.length >= 12) score += 1\n    \n    if (/[a-z]/.test(password)) score += 1\n    if (/[A-Z]/.test(password)) score += 1\n    if (/\\d/.test(password)) score += 1\n    if (/[!@#$%^&*]/.test(password)) score += 1\n    \n    return score\n  }\n\n  const updatePasswordStrength = (password) => {\n    state.value.strength = checkPasswordStrength(password)\n  }\n\n  const isPasswordValid = computed(() => {\n    const password = state.value.newPassword\n    return password &&\n           password.length >= 8 &&\n           /[A-Za-z]/.test(password) &&\n           /\\d/.test(password)\n  })\n\n  const strengthText = computed(() => {\n    const strength = state.value.strength\n    if (strength <= 1) return '弱'\n    if (strength <= 3) return '中'\n    if (strength <= 5) return '强'\n    return '非常强'\n  })\n\n  const strengthTextClass = computed(() => {\n    const strength = state.value.strength\n    if (strength <= 1) return 'text-red-500'\n    if (strength <= 3) return 'text-yellow-500'\n    if (strength <= 5) return 'text-green-500'\n    return 'text-green-600'\n  })\n\n  const strengthColorClass = computed(() => {\n    const strength = state.value.strength\n    if (strength <= 1) return 'bg-red-500'\n    if (strength <= 3) return 'bg-yellow-500'\n    if (strength <= 5) return 'bg-green-500'\n    return 'bg-green-600'\n  })\n\n  return {\n    state,\n    validatePassword,\n    updatePasswordStrength,\n    isPasswordValid,\n    strengthText,\n    strengthTextClass,\n    strengthColorClass,\n    userStore\n  }\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}