{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { useRoute } from 'vue-router';\nimport HeadView from '@/components/HeadView.vue';\nimport FootView from '@/components/FootView.vue';\nimport { membership } from '@/api/membership';\nimport { showToast } from '@/components/ToastMessage';\nexport default {\n  __name: 'PaymentResult',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const status = ref('success');\n    const errorMessage = ref('');\n    const errorMessages = {\n      'order_not_found': '订单不存在',\n      'verify_failed': '支付验证失败',\n      'system_error': '系统错误',\n      'unknown': '未知错误'\n    };\n    onMounted(async () => {\n      // 从URL参数中获取支付状态\n      const reason = route.query.reason;\n      if (reason) {\n        status.value = 'fail';\n        errorMessage.value = errorMessages[reason] || '支付失败，请重试';\n      } else {\n        // 处理支付宝回调\n        const orderNo = route.query.out_trade_no;\n        if (orderNo) {\n          try {\n            // 调用后端接口验证支付状态\n            const response = await membership.verifyPayment(orderNo);\n            if (response?.data?.code === 200) {\n              status.value = 'success';\n              showToast('支付成功', 'success');\n            } else {\n              status.value = 'fail';\n              errorMessage.value = '支付验证失败';\n              showToast('支付验证失败', 'error');\n            }\n          } catch (error) {\n            console.error('支付验证失败:', error);\n            status.value = 'fail';\n            errorMessage.value = '系统错误';\n            showToast('支付验证失败', 'error');\n          }\n        }\n      }\n    });\n    const __returned__ = {\n      route,\n      status,\n      errorMessage,\n      errorMessages,\n      ref,\n      onMounted,\n      get useRoute() {\n        return useRoute;\n      },\n      HeadView,\n      FootView,\n      get membership() {\n        return membership;\n      },\n      get showToast() {\n        return showToast;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","useRoute","HeadView","FootView","membership","showToast","route","status","errorMessage","errorMessages","reason","query","value","orderNo","out_trade_no","response","verifyPayment","data","code","error","console"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/payment/PaymentResult.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50\">\n    <HeadView />\n    \n    <div class=\"max-w-3xl mx-auto px-4 py-16\">\n      <!-- 支付成功 -->\n      <div v-if=\"status === 'success'\" class=\"text-center\">\n        <div class=\"mb-8\">\n          <svg class=\"mx-auto h-16 w-16 text-green-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\" />\n          </svg>\n        </div>\n        <h2 class=\"text-2xl font-bold text-gray-900 mb-4\">支付成功</h2>\n        <p class=\"text-gray-600 mb-8\">您的会员已经开通，立即开始享受会员权益吧！</p>\n        <div class=\"flex justify-center space-x-4\">\n          <router-link \n            to=\"/member\" \n            class=\"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700\"\n          >\n            查看会员信息\n          </router-link>\n          <router-link \n            to=\"/\" \n            class=\"inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\n          >\n            返回首页\n          </router-link>\n        </div>\n      </div>\n\n      <!-- 支付失败 -->\n      <div v-else class=\"text-center\">\n        <div class=\"mb-8\">\n          <svg class=\"mx-auto h-16 w-16 text-red-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </div>\n        <h2 class=\"text-2xl font-bold text-gray-900 mb-4\">支付失败</h2>\n        <p class=\"text-gray-600 mb-2\">抱歉，支付过程中出现了问题</p>\n        <p class=\"text-gray-500 text-sm mb-8\">{{ errorMessage }}</p>\n        <div class=\"flex justify-center space-x-4\">\n          <router-link \n            to=\"/pro\" \n            class=\"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700\"\n          >\n            重新支付\n          </router-link>\n          <router-link \n            to=\"/\" \n            class=\"inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\n          >\n            返回首页\n          </router-link>\n        </div>\n      </div>\n    </div>\n\n    <FootView />\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { useRoute } from 'vue-router'\nimport HeadView from '@/components/HeadView.vue'\nimport FootView from '@/components/FootView.vue'\nimport { membership } from '@/api/membership'\nimport { showToast } from '@/components/ToastMessage'\n\nconst route = useRoute()\nconst status = ref('success')\nconst errorMessage = ref('')\n\nconst errorMessages = {\n  'order_not_found': '订单不存在',\n  'verify_failed': '支付验证失败',\n  'system_error': '系统错误',\n  'unknown': '未知错误'\n}\n\nonMounted(async () => {\n  // 从URL参数中获取支付状态\n  const reason = route.query.reason\n  if (reason) {\n    status.value = 'fail'\n    errorMessage.value = errorMessages[reason] || '支付失败，请重试'\n  } else {\n    // 处理支付宝回调\n    const orderNo = route.query.out_trade_no\n    if (orderNo) {\n      try {\n        // 调用后端接口验证支付状态\n        const response = await membership.verifyPayment(orderNo)\n        if (response?.data?.code === 200) {\n          status.value = 'success'\n          showToast('支付成功', 'success')\n        } else {\n          status.value = 'fail'\n          errorMessage.value = '支付验证失败'\n          showToast('支付验证失败', 'error')\n        }\n      } catch (error) {\n        console.error('支付验证失败:', error)\n        status.value = 'fail'\n        errorMessage.value = '系统错误'\n        showToast('支付验证失败', 'error')\n      }\n    }\n  }\n})\n</script> "],"mappings":"AA8DA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAI;AACnC,SAASC,QAAQ,QAAQ,YAAW;AACpC,OAAOC,QAAQ,MAAM,2BAA0B;AAC/C,OAAOC,QAAQ,MAAM,2BAA0B;AAC/C,SAASC,UAAU,QAAQ,kBAAiB;AAC5C,SAASC,SAAS,QAAQ,2BAA0B;;;;;;;IAEpD,MAAMC,KAAK,GAAGL,QAAQ,CAAC;IACvB,MAAMM,MAAM,GAAGR,GAAG,CAAC,SAAS;IAC5B,MAAMS,YAAY,GAAGT,GAAG,CAAC,EAAE;IAE3B,MAAMU,aAAa,GAAG;MACpB,iBAAiB,EAAE,OAAO;MAC1B,eAAe,EAAE,QAAQ;MACzB,cAAc,EAAE,MAAM;MACtB,SAAS,EAAE;IACb;IAEAT,SAAS,CAAC,YAAY;MACpB;MACA,MAAMU,MAAM,GAAGJ,KAAK,CAACK,KAAK,CAACD,MAAK;MAChC,IAAIA,MAAM,EAAE;QACVH,MAAM,CAACK,KAAK,GAAG,MAAK;QACpBJ,YAAY,CAACI,KAAK,GAAGH,aAAa,CAACC,MAAM,CAAC,IAAI,UAAS;MACzD,CAAC,MAAM;QACL;QACA,MAAMG,OAAO,GAAGP,KAAK,CAACK,KAAK,CAACG,YAAW;QACvC,IAAID,OAAO,EAAE;UACX,IAAI;YACF;YACA,MAAME,QAAQ,GAAG,MAAMX,UAAU,CAACY,aAAa,CAACH,OAAO;YACvD,IAAIE,QAAQ,EAAEE,IAAI,EAAEC,IAAI,KAAK,GAAG,EAAE;cAChCX,MAAM,CAACK,KAAK,GAAG,SAAQ;cACvBP,SAAS,CAAC,MAAM,EAAE,SAAS;YAC7B,CAAC,MAAM;cACLE,MAAM,CAACK,KAAK,GAAG,MAAK;cACpBJ,YAAY,CAACI,KAAK,GAAG,QAAO;cAC5BP,SAAS,CAAC,QAAQ,EAAE,OAAO;YAC7B;UACF,CAAC,CAAC,OAAOc,KAAK,EAAE;YACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;YAC9BZ,MAAM,CAACK,KAAK,GAAG,MAAK;YACpBJ,YAAY,CAACI,KAAK,GAAG,MAAK;YAC1BP,SAAS,CAAC,QAAQ,EAAE,OAAO;UAC7B;QACF;MACF;IACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}