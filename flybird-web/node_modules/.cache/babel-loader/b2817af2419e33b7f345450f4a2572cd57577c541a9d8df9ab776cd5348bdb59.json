{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"image-wrapper\"\n};\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  key: 0,\n  class: \"binding-indicator\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"design-element\", {\n      selected: $props.isSelected\n    }]),\n    style: _normalizeStyle($setup.elementStyle),\n    onMousedown: _withModifiers($setup.handleMouseDown, [\"stop\"])\n  }, [_createCommentVNode(\" 图片元素 \"), $props.element.type === 'image' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"img\", {\n    src: $props.element.content || $props.element.placeholder,\n    style: _normalizeStyle($setup.imageStyle),\n    draggable: \"false\"\n  }, null, 12 /* STYLE, PROPS */, _hoisted_2), $props.element.dataBinding ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \" 已绑定: \" + _toDisplayString($props.element.dataBinding.field), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 调整大小的手柄 \"), $props.isSelected ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createElementVNode(\"div\", {\n    class: \"resize-handle tl\",\n    onMousedown: _cache[0] || (_cache[0] = _withModifiers(e => $setup.startResize(e, 'tl'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle tr\",\n    onMousedown: _cache[1] || (_cache[1] = _withModifiers(e => $setup.startResize(e, 'tr'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle bl\",\n    onMousedown: _cache[2] || (_cache[2] = _withModifiers(e => $setup.startResize(e, 'bl'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle br\",\n    onMousedown: _cache[3] || (_cache[3] = _withModifiers(e => $setup.startResize(e, 'br'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createCommentVNode(\" 旋转手柄 \"), _createElementVNode(\"div\", {\n    class: \"rotate-handle\",\n    onMousedown: _withModifiers($setup.startRotate, [\"stop\"])\n  }, null, 32 /* NEED_HYDRATION */)], 64 /* STABLE_FRAGMENT */)) : _createCommentVNode(\"v-if\", true)], 38 /* CLASS, STYLE, NEED_HYDRATION */);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_normalizeClass","selected","$props","isSelected","style","_normalizeStyle","$setup","elementStyle","onMousedown","_withModifiers","handleMouseDown","_createCommentVNode","element","type","_hoisted_1","_createElementVNode","src","content","placeholder","imageStyle","draggable","_hoisted_2","dataBinding","_hoisted_3","_toDisplayString","field","_Fragment","_cache","e","startResize","startRotate"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/DesignElement.vue"],"sourcesContent":["<template>\n  <div \n    class=\"design-element\"\n    :class=\"{ selected: isSelected }\"\n    :style=\"elementStyle\"\n    @mousedown.stop=\"handleMouseDown\"\n  >\n    <!-- 图片元素 -->\n    <template v-if=\"element.type === 'image'\">\n      <div class=\"image-wrapper\">\n        <img \n          :src=\"element.content || element.placeholder\" \n          :style=\"imageStyle\"\n          draggable=\"false\"\n        >\n        <div v-if=\"element.dataBinding\" class=\"binding-indicator\">\n          已绑定: {{ element.dataBinding.field }}\n        </div>\n      </div>\n    </template>\n\n    <!-- 调整大小的手柄 -->\n    <template v-if=\"isSelected\">\n      <div class=\"resize-handle tl\" @mousedown.stop=\"(e) => startResize(e, 'tl')\"></div>\n      <div class=\"resize-handle tr\" @mousedown.stop=\"(e) => startResize(e, 'tr')\"></div>\n      <div class=\"resize-handle bl\" @mousedown.stop=\"(e) => startResize(e, 'bl')\"></div>\n      <div class=\"resize-handle br\" @mousedown.stop=\"(e) => startResize(e, 'br')\"></div>\n      <!-- 旋转手柄 -->\n      <div class=\"rotate-handle\" @mousedown.stop=\"startRotate\"></div>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed } from 'vue'\n\nconst props = defineProps({\n  element: {\n    type: Object,\n    required: true\n  },\n  isSelected: {\n    type: Boolean,\n    default: false\n  },\n  scale: {\n    type: Number,\n    default: 1\n  }\n})\n\nconst emit = defineEmits(['select', 'update'])\n\n// 处理鼠标按下事件\nconst handleMouseDown = (e) => {\n  // 如果点击的是控制点，不触发选择\n  if (e.target.classList.contains('resize-handle') || \n      e.target.classList.contains('rotate-handle')) {\n    return\n  }\n  \n  e.stopPropagation()\n  emit('select', props.element)\n\n  // 只有在不是控制点的情况下才开始拖拽\n  const startX = e.clientX\n  const startY = e.clientY\n  const startElementX = props.element.x\n  const startElementY = props.element.y\n\n  const handleMouseMove = (e) => {\n    const deltaX = (e.clientX - startX) / props.scale\n    const deltaY = (e.clientY - startY) / props.scale\n\n    emit('update', {\n      ...props.element,\n      x: startElementX + deltaX,\n      y: startElementY + deltaY\n    })\n  }\n\n  const handleMouseUp = () => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  }\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n}\n\n// 处理缩放\nconst startResize = (e, handle) => {\n  e.stopPropagation()\n  const startX = e.clientX\n  const startY = e.clientY\n  const startWidth = props.element.width\n  const startHeight = props.element.height\n  const startElementX = props.element.x\n  const startElementY = props.element.y\n\n  const handleMouseMove = (e) => {\n    e.preventDefault()\n    const deltaX = (e.clientX - startX) / props.scale\n    const deltaY = (e.clientY - startY) / props.scale\n    \n    let newWidth = startWidth\n    let newHeight = startHeight\n    let newX = startElementX\n    let newY = startElementY\n    \n    switch (handle) {\n      case 'br':\n        newWidth = startWidth + deltaX\n        newHeight = startHeight + deltaY\n        break\n      case 'bl':\n        newWidth = startWidth - deltaX\n        newHeight = startHeight + deltaY\n        newX = startElementX + deltaX\n        break\n      case 'tr':\n        newWidth = startWidth + deltaX\n        newHeight = startHeight - deltaY\n        newY = startElementY + deltaY\n        break\n      case 'tl':\n        newWidth = startWidth - deltaX\n        newHeight = startHeight - deltaY\n        newX = startElementX + deltaX\n        newY = startElementY + deltaY\n        break\n    }\n    \n    // 确保尺寸不小于最小值\n    newWidth = Math.max(20, newWidth)\n    newHeight = Math.max(20, newHeight)\n    \n    emit('update', {\n      ...props.element,\n      width: newWidth,\n      height: newHeight,\n      x: newX,\n      y: newY\n    })\n  }\n  \n  const handleMouseUp = () => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n}\n\n// 处理旋转\nconst startRotate = (e) => {\n  e.stopPropagation()\n  const elementRect = e.currentTarget.getBoundingClientRect()\n  const elementCenterX = elementRect.left + elementRect.width / 2\n  const elementCenterY = elementRect.top + elementRect.height / 2\n  \n  const handleMouseMove = (e) => {\n    const angle = Math.atan2(\n      e.clientY - elementCenterY,\n      e.clientX - elementCenterX\n    ) * (180 / Math.PI)\n    \n    emit('update', {\n      ...props.element,\n      rotation: angle + 90\n    })\n  }\n  \n  const handleMouseUp = () => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n}\n\n// 元素基础样式\nconst elementStyle = computed(() => ({\n  transform: `translate(${props.element.x}px, ${props.element.y}px) rotate(${props.element.rotation || 0}deg)`,\n  width: `${props.element.width}px`,\n  height: `${props.element.height}px`,\n  ...props.element.styles\n}))\n\n// 图片样式\nconst imageStyle = computed(() => ({\n  width: '100%',\n  height: '100%',\n  objectFit: 'cover',\n  borderRadius: props.element.styles?.borderRadius\n}))\n</script>\n\n<style scoped>\n.design-element {\n  position: absolute;\n  cursor: move;\n  user-select: none;\n}\n\n.design-element.selected {\n  outline: 2px solid #1867C0;\n}\n\n.resize-handle {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: #fff;\n  border: 1px solid #1867C0;\n  border-radius: 50%;\n  z-index: 100;\n}\n\n.resize-handle.tl { top: -4px; left: -4px; cursor: nw-resize; }\n.resize-handle.tr { top: -4px; right: -4px; cursor: ne-resize; }\n.resize-handle.bl { bottom: -4px; left: -4px; cursor: sw-resize; }\n.resize-handle.br { bottom: -4px; right: -4px; cursor: se-resize; }\n\n.rotate-handle {\n  position: absolute;\n  top: -20px;\n  left: 50%;\n  width: 8px;\n  height: 8px;\n  background: #1867C0;\n  border-radius: 50%;\n  transform: translateX(-50%);\n  cursor: grab;\n  z-index: 100;\n}\n\n.rotate-handle:active {\n  cursor: grabbing;\n}\n\n.binding-indicator {\n  position: absolute;\n  top: -20px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: rgba(24, 103, 192, 0.9);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n  white-space: nowrap;\n  pointer-events: none;\n}\n\n.image-wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\nimg {\n  pointer-events: none;\n}\n</style> "],"mappings":";;EAAAA,GAAA;EASWC,KAAK,EAAC;;mBATjB;;EAAAD,GAAA;EAewCC,KAAK,EAAC;;;uBAd5CC,mBAAA,CA6BM;IA5BJD,KAAK,EAFTE,eAAA,EAEU,gBAAgB;MAAAC,QAAA,EACFC,MAAA,CAAAC;IAAU;IAC7BC,KAAK,EAJVC,eAAA,CAIYC,MAAA,CAAAC,YAAY;IACnBC,WAAS,EALdC,cAAA,CAKqBH,MAAA,CAAAI,eAAe;MAEhCC,mBAAA,UAAa,EACGT,MAAA,CAAAU,OAAO,CAACC,IAAI,gB,cAC1Bd,mBAAA,CASM,OATNe,UASM,GARJC,mBAAA,CAIC;IAHEC,GAAG,EAAEd,MAAA,CAAAU,OAAO,CAACK,OAAO,IAAIf,MAAA,CAAAU,OAAO,CAACM,WAAW;IAC3Cd,KAAK,EAZhBC,eAAA,CAYkBC,MAAA,CAAAa,UAAU;IAClBC,SAAS,EAAC;kCAbpBC,UAAA,GAemBnB,MAAA,CAAAU,OAAO,CAACU,WAAW,I,cAA9BvB,mBAAA,CAEM,OAFNwB,UAEM,EAFoD,QACnD,GAAAC,gBAAA,CAAGtB,MAAA,CAAAU,OAAO,CAACU,WAAW,CAACG,KAAK,oBAhB3Cd,mBAAA,e,KAAAA,mBAAA,gBAqBIA,mBAAA,aAAgB,EACAT,MAAA,CAAAC,UAAU,I,cAA1BJ,mBAAA,CAOW2B,SAAA;IA7Bf7B,GAAA;EAAA,IAuBMkB,mBAAA,CAAkF;IAA7EjB,KAAK,EAAC,kBAAkB;IAAEU,WAAS,EAAAmB,MAAA,QAAAA,MAAA,MAvB9ClB,cAAA,CAuBsDmB,CAAC,IAAKtB,MAAA,CAAAuB,WAAW,CAACD,CAAC;qCACnEb,mBAAA,CAAkF;IAA7EjB,KAAK,EAAC,kBAAkB;IAAEU,WAAS,EAAAmB,MAAA,QAAAA,MAAA,MAxB9ClB,cAAA,CAwBsDmB,CAAC,IAAKtB,MAAA,CAAAuB,WAAW,CAACD,CAAC;qCACnEb,mBAAA,CAAkF;IAA7EjB,KAAK,EAAC,kBAAkB;IAAEU,WAAS,EAAAmB,MAAA,QAAAA,MAAA,MAzB9ClB,cAAA,CAyBsDmB,CAAC,IAAKtB,MAAA,CAAAuB,WAAW,CAACD,CAAC;qCACnEb,mBAAA,CAAkF;IAA7EjB,KAAK,EAAC,kBAAkB;IAAEU,WAAS,EAAAmB,MAAA,QAAAA,MAAA,MA1B9ClB,cAAA,CA0BsDmB,CAAC,IAAKtB,MAAA,CAAAuB,WAAW,CAACD,CAAC;qCACnEjB,mBAAA,UAAa,EACbI,mBAAA,CAA+D;IAA1DjB,KAAK,EAAC,eAAe;IAAEU,WAAS,EA5B3CC,cAAA,CA4BkDH,MAAA,CAAAwB,WAAW;mEA5B7DnB,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}