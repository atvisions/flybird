{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"template-editor\"\n};\nconst _hoisted_2 = {\n  class: \"editor-toolbar\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_button_group = _resolveComponent(\"el-button-group\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 顶部工具栏 \"), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_button_group, null, {\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: $setup.handleSave\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"Save\"])]),\n        _: 1 /* STABLE */\n      }), _cache[1] || (_cache[1] = _createTextVNode(\" 保存 \"))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      onClick: $setup.handlePreview\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"View\"])]),\n        _: 1 /* STABLE */\n      }), _cache[2] || (_cache[2] = _createTextVNode(\" 预览 \"))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      onClick: $setup.handleExport\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"Download\"])]),\n        _: 1 /* STABLE */\n      }), _cache[3] || (_cache[3] = _createTextVNode(\" 导出 \"))]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_input, {\n    modelValue: $setup.templateName,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.templateName = $event),\n    placeholder: \"模板名称\",\n    class: \"template-name\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])]), _createCommentVNode(\" GrapesJS 编辑器容器 \"), _cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n    id: \"gjs\",\n    class: \"editor-container\"\n  }, null, -1 /* HOISTED */))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","_createVNode","_component_el_button_group","default","_withCtx","_component_el_button","onClick","$setup","handleSave","_component_el_icon","_","_createTextVNode","handlePreview","handleExport","_component_el_input","modelValue","templateName","_cache","$event","placeholder","id"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/template-editor/views/TemplateEditor.vue"],"sourcesContent":["<!-- 模板编辑器主视图 -->\n<template>\n  <div class=\"template-editor\">\n    <!-- 顶部工具栏 -->\n    <div class=\"editor-toolbar\">\n      <el-button-group>\n        <el-button @click=\"handleSave\">\n          <el-icon><Save /></el-icon>\n          保存\n        </el-button>\n        <el-button @click=\"handlePreview\">\n          <el-icon><View /></el-icon>\n          预览\n        </el-button>\n        <el-button @click=\"handleExport\">\n          <el-icon><Download /></el-icon>\n          导出\n        </el-button>\n      </el-button-group>\n      \n      <el-input\n        v-model=\"templateName\"\n        placeholder=\"模板名称\"\n        class=\"template-name\"\n      />\n    </div>\n    \n    <!-- GrapesJS 编辑器容器 -->\n    <div id=\"gjs\" class=\"editor-container\"></div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, onUnmounted } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { ElMessage } from 'element-plus'\nimport { Save, View, Download } from '@element-plus/icons-vue'\nimport 'grapesjs/dist/css/grapes.min.css'\nimport grapesjs from 'grapesjs'\nimport 'grapesjs-preset-webpage'\nimport 'grapesjs-blocks-basic'\n\n// 模板数据\nconst templateName = ref('新建模板')\nconst editor = ref(null)\nconst route = useRoute()\n\n// 初始化编辑器\nonMounted(() => {\n  // 基础配置\n  editor.value = grapesjs.init({\n    container: '#gjs',\n    height: 'calc(100vh - 64px)',\n    width: 'auto',\n    storageManager: false,\n    \n    // 面板配置\n    panels: {\n      defaults: [\n        {\n          id: 'panel-devices',\n          el: '.panel__devices',\n          buttons: [{\n            id: 'device-desktop',\n            label: 'Desktop',\n            command: 'set-device-desktop',\n            active: true,\n            togglable: false,\n          }, {\n            id: 'device-tablet',\n            label: 'Tablet',\n            command: 'set-device-tablet',\n            togglable: false,\n          }, {\n            id: 'device-mobile',\n            label: 'Mobile',\n            command: 'set-device-mobile',\n            togglable: false,\n          }],\n        },\n        {\n          id: 'panel-switcher',\n          el: '.panel__switcher',\n          buttons: [{\n            id: 'show-blocks',\n            active: true,\n            label: '组件',\n            command: 'show-blocks',\n            togglable: false,\n          }, {\n            id: 'show-style',\n            label: '样式',\n            command: 'show-styles',\n            togglable: false,\n          }],\n        }\n      ]\n    },\n    \n    // 侧边栏配置\n    sideBar: {\n      toolPanel: true,\n      contentPanel: true\n    },\n    \n    // 加载插件\n    plugins: ['gjs-preset-webpage', 'gjs-blocks-basic'],\n    \n    // 插件配置\n    pluginsOpts: {\n      'gjs-blocks-basic': {\n        blocks: ['column1', 'column2', 'column3', 'text', 'link', 'image', 'video'],\n        flexGrid: true\n      },\n      'gjs-preset-webpage': {\n        modalImportTitle: '导入模板',\n        modalImportLabel: '粘贴您的HTML/CSS代码',\n        modalImportContent: '',\n        textCleanCanvas: '确定要清空画布吗?',\n        showStylesOnChange: true\n      }\n    },\n    \n    // 画布设置\n    canvas: {\n      styles: [\n        'https://unpkg.com/element-plus/dist/index.css'\n      ],\n      scripts: [\n        'https://unpkg.com/vue@3',\n        'https://unpkg.com/element-plus'\n      ]\n    },\n    \n    // 设备管理器配置\n    deviceManager: {\n      devices: [\n        {\n          name: 'Desktop',\n          width: '1024px',\n          widthMedia: '1024px'\n        },\n        {\n          name: 'Tablet',\n          width: '768px',\n          widthMedia: '768px'\n        },\n        {\n          name: 'Mobile',\n          width: '320px',\n          widthMedia: '320px'\n        }\n      ]\n    },\n    \n    // 样式管理器配置\n    styleManager: {\n      sectors: [{\n        name: '尺寸',\n        open: false,\n        properties: [\n          'width',\n          'height',\n          'min-width',\n          'min-height',\n          'max-width',\n          'max-height',\n          'padding',\n          'margin'\n        ]\n      },\n      {\n        name: '排版',\n        open: false,\n        properties: [\n          'font-family',\n          'font-size',\n          'font-weight',\n          'letter-spacing',\n          'color',\n          'line-height',\n          'text-align',\n          'text-decoration',\n          'text-shadow'\n        ]\n      },\n      {\n        name: '装饰',\n        open: false,\n        properties: [\n          'background-color',\n          'border',\n          'border-radius',\n          'box-shadow'\n        ]\n      },\n      {\n        name: '定位',\n        open: false,\n        properties: [\n          'position',\n          'top',\n          'right',\n          'bottom',\n          'left',\n          'z-index'\n        ]\n      }]\n    }\n  })\n  \n  // 添加自定义简历组件\n  addResumeBlocks()\n  \n  // 如果有模板 ID，加载模板数据\n  if (route.params.id) {\n    loadTemplate(route.params.id)\n  }\n})\n\n// 添加简历专用组件\nconst addResumeBlocks = () => {\n  const blockManager = editor.value.BlockManager\n  \n  // 基本信息组件\n  blockManager.add('basic-info', {\n    label: '基本信息',\n    category: '简历组件',\n    content: `\n      <div class=\"basic-info\">\n        <div class=\"avatar\">\n          <img src=\"https://via.placeholder.com/100\" alt=\"头像\" />\n        </div>\n        <div class=\"info\">\n          <h2>姓名</h2>\n          <p>性别 | 年龄</p>\n          <p>电话 | 邮箱</p>\n          <p>所在地</p>\n        </div>\n      </div>\n    `,\n    style: {\n      'basic-info': {\n        padding: '20px',\n        display: 'flex',\n        'align-items': 'center',\n        gap: '20px',\n        'background-color': '#f5f7fa',\n        'border-radius': '8px'\n      }\n    }\n  })\n  \n  // 工作经历组件\n  blockManager.add('work-experience', {\n    label: '工作经历',\n    category: '简历组件',\n    content: `\n      <div class=\"work-experience\">\n        <h3>工作经历</h3>\n        <div class=\"experience-item\">\n          <div class=\"company\">公司名称</div>\n          <div class=\"position\">职位</div>\n          <div class=\"date\">2020.01 - 至今</div>\n          <div class=\"description\">工作描述</div>\n        </div>\n      </div>\n    `,\n    style: {\n      'work-experience': {\n        padding: '20px',\n        'background-color': '#ffffff',\n        'border-radius': '8px',\n        'box-shadow': '0 2px 4px rgba(0,0,0,0.05)'\n      }\n    }\n  })\n  \n  // 教育经历组件\n  blockManager.add('education', {\n    label: '教育经历',\n    category: '简历组件',\n    content: `\n      <div class=\"education\">\n        <h3>教育经历</h3>\n        <div class=\"education-item\">\n          <div class=\"school\">学校名称</div>\n          <div class=\"major\">专业</div>\n          <div class=\"date\">2016.09 - 2020.06</div>\n          <div class=\"degree\">学位</div>\n        </div>\n      </div>\n    `,\n    style: {\n      'education': {\n        padding: '20px',\n        'background-color': '#ffffff',\n        'border-radius': '8px',\n        'box-shadow': '0 2px 4px rgba(0,0,0,0.05)'\n      }\n    }\n  })\n}\n\n// 加载模板数据\nconst loadTemplate = async (id) => {\n  try {\n    // TODO: 从后端加载模板数据\n    const template = await fetch(`/api/v1/resume/templates/${id}`).then(res => res.json())\n    templateName.value = template.name\n    editor.value.setComponents(template.content)\n  } catch (error) {\n    ElMessage.error('加载模板失败')\n  }\n}\n\n// 保存模板\nconst handleSave = async () => {\n  try {\n    const html = editor.value.getHtml()\n    const css = editor.value.getCss()\n    \n    // TODO: 保存到后端\n    await fetch('/api/v1/resume/templates', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        name: templateName.value,\n        content: html,\n        styles: css\n      })\n    })\n    \n    ElMessage.success('保存成功')\n  } catch (error) {\n    ElMessage.error('保存失败')\n  }\n}\n\n// 预览模板\nconst handlePreview = () => {\n  const html = editor.value.getHtml()\n  const css = editor.value.getCss()\n  \n  // 在新窗口中预览\n  const win = window.open('', '_blank')\n  win.document.write(`\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <style>${css}</style>\n      </head>\n      <body>${html}</body>\n    </html>\n  `)\n}\n\n// 导出模板\nconst handleExport = () => {\n  const html = editor.value.getHtml()\n  const css = editor.value.getCss()\n  \n  // TODO: 调用后端导出 PDF\n}\n\n// 组件销毁时清理编辑器\nonUnmounted(() => {\n  if (editor.value) {\n    editor.value.destroy()\n  }\n})\n</script>\n\n<style lang=\"scss\">\n.template-editor {\n  @apply h-full flex flex-col;\n  \n  .editor-toolbar {\n    @apply h-16 px-4 flex items-center justify-between bg-white border-b border-gray-200;\n    \n    .template-name {\n      @apply w-64;\n    }\n  }\n  \n  .editor-container {\n    @apply flex-1;\n    \n    // GrapesJS 样式覆盖\n    .gjs-cv-canvas {\n      @apply h-full;\n      \n      .gjs-frame {\n        @apply bg-white;\n      }\n    }\n    \n    .gjs-pn-panel {\n      @apply bg-white border-gray-200;\n    }\n    \n    .gjs-block {\n      @apply bg-white border border-gray-200 rounded-lg;\n      \n      &:hover {\n        @apply border-blue-500;\n      }\n    }\n    \n    .gjs-block-category {\n      @apply bg-gray-50;\n    }\n  }\n}\n</style> "],"mappings":";;EAEOA,KAAK,EAAC;AAAiB;;EAErBA,KAAK,EAAC;AAAgB;;;;;;uBAF7BC,mBAAA,CA2BM,OA3BNC,UA2BM,GA1BJC,mBAAA,WAAc,EACdC,mBAAA,CAqBM,OArBNC,UAqBM,GApBJC,YAAA,CAakBC,0BAAA;IAlBxBC,OAAA,EAAAC,QAAA,CAMQ,MAGY,CAHZH,YAAA,CAGYI,oBAAA;MAHAC,OAAK,EAAEC,MAAA,CAAAC;IAAU;MANrCL,OAAA,EAAAC,QAAA,CAOU,MAA2B,CAA3BH,YAAA,CAA2BQ,kBAAA;QAPrCN,OAAA,EAAAC,QAAA,CAOmB,MAAQ,CAARH,YAAA,CAAQM,MAAA,U;QAP3BG,CAAA;oCAAAC,gBAAA,CAOqC,MAE7B,G;MATRD,CAAA;QAUQT,YAAA,CAGYI,oBAAA;MAHAC,OAAK,EAAEC,MAAA,CAAAK;IAAa;MAVxCT,OAAA,EAAAC,QAAA,CAWU,MAA2B,CAA3BH,YAAA,CAA2BQ,kBAAA;QAXrCN,OAAA,EAAAC,QAAA,CAWmB,MAAQ,CAARH,YAAA,CAAQM,MAAA,U;QAX3BG,CAAA;oCAAAC,gBAAA,CAWqC,MAE7B,G;MAbRD,CAAA;QAcQT,YAAA,CAGYI,oBAAA;MAHAC,OAAK,EAAEC,MAAA,CAAAM;IAAY;MAdvCV,OAAA,EAAAC,QAAA,CAeU,MAA+B,CAA/BH,YAAA,CAA+BQ,kBAAA;QAfzCN,OAAA,EAAAC,QAAA,CAemB,MAAY,CAAZH,YAAA,CAAYM,MAAA,c;QAf/BG,CAAA;oCAAAC,gBAAA,CAeyC,MAEjC,G;MAjBRD,CAAA;;IAAAA,CAAA;MAoBMT,YAAA,CAIEa,mBAAA;IAxBRC,UAAA,EAqBiBR,MAAA,CAAAS,YAAY;IArB7B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAqBiBX,MAAA,CAAAS,YAAY,GAAAE,MAAA;IACrBC,WAAW,EAAC,MAAM;IAClBxB,KAAK,EAAC;6CAIVG,mBAAA,oBAAuB,E,0BACvBC,mBAAA,CAA6C;IAAxCqB,EAAE,EAAC,KAAK;IAACzB,KAAK,EAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}