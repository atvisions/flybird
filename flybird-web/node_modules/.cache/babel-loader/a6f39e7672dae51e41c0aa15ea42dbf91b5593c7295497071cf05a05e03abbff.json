{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { ref, computed } from 'vue';\nimport draggable from 'vuedraggable';\nimport BasicInfoDisplay from './BasicInfoDisplay.vue';\nimport BasicInfo from './BasicInfo.vue';\nexport default {\n  __name: 'Canvas',\n  props: {\n    scale: {\n      type: Number,\n      default: 1\n    }\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n    const components = ref([]);\n    const isDragOver = ref(false);\n    const showEditor = ref(false);\n    const currentComponent = ref(null);\n    const editingIndex = ref(-1);\n    const handleDragEnter = event => {\n      event.preventDefault();\n      isDragOver.value = true;\n    };\n    const handleDragLeave = event => {\n      event.preventDefault();\n      isDragOver.value = false;\n    };\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n    const handleChange = event => {\n      if (event.added) {\n        const component = JSON.parse(event.added.element);\n        const newComponent = {\n          id: Date.now(),\n          type: component.type,\n          name: component.name,\n          config: component.config,\n          data: {}\n        };\n        components.value.splice(event.added.newIndex, 1, newComponent);\n        // 添加新组件后立即打开编辑器\n        openEditor(newComponent, event.added.newIndex);\n      }\n    };\n    const getComponentDisplay = component => {\n      const componentMap = {\n        'contact': BasicInfoDisplay\n      };\n      return componentMap[component.type];\n    };\n    const getComponentEditor = component => {\n      const componentMap = {\n        'contact': BasicInfo\n      };\n      return componentMap[component.type];\n    };\n    const openEditor = (component, index) => {\n      currentComponent.value = _objectSpread({}, component);\n      editingIndex.value = index !== undefined ? index : components.value.findIndex(c => c.id === component.id);\n      showEditor.value = true;\n    };\n    const saveComponent = () => {\n      if (editingIndex.value > -1) {\n        components.value[editingIndex.value] = _objectSpread({}, currentComponent.value);\n      }\n      showEditor.value = false;\n    };\n    const removeComponent = component => {\n      const index = components.value.findIndex(c => c.id === component.id);\n      if (index > -1) {\n        components.value.splice(index, 1);\n      }\n    };\n    const __returned__ = {\n      props,\n      components,\n      isDragOver,\n      showEditor,\n      currentComponent,\n      editingIndex,\n      handleDragEnter,\n      handleDragLeave,\n      handleDragOver,\n      handleChange,\n      getComponentDisplay,\n      getComponentEditor,\n      openEditor,\n      saveComponent,\n      removeComponent,\n      ref,\n      computed,\n      get draggable() {\n        return draggable;\n      },\n      BasicInfoDisplay,\n      BasicInfo\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","draggable","BasicInfoDisplay","BasicInfo","props","__props","components","isDragOver","showEditor","currentComponent","editingIndex","handleDragEnter","event","preventDefault","value","handleDragLeave","handleDragOver","handleChange","added","component","JSON","parse","element","newComponent","id","Date","now","type","name","config","data","splice","newIndex","openEditor","getComponentDisplay","componentMap","getComponentEditor","index","_objectSpread","undefined","findIndex","c","saveComponent","removeComponent"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/Canvas.vue"],"sourcesContent":["<template>\n  <div class=\"canvas-container\">\n    <div class=\"canvas-wrapper\">\n      <div class=\"canvas-content\" :style=\"{ transform: `scale(${scale})` }\">\n        <draggable\n          v-model=\"components\"\n          :group=\"{ name: 'resume', pull: false, put: true }\"\n          item-key=\"id\"\n          class=\"canvas-drop-area\"\n          :class=\"{ 'drag-over': isDragOver }\"\n          @change=\"handleChange\"\n          @dragenter=\"handleDragEnter\"\n          @dragleave=\"handleDragLeave\"\n          @dragover=\"handleDragOver\"\n        >\n          <template #item=\"{ element }\">\n            <div class=\"component-item\">\n              <div class=\"component-actions\">\n                <v-btn\n                  icon=\"mdi-pencil\"\n                  size=\"small\"\n                  color=\"primary\"\n                  variant=\"text\"\n                  @click=\"openEditor(element)\"\n                ></v-btn>\n                <v-btn\n                  icon=\"mdi-delete\"\n                  size=\"small\"\n                  color=\"error\"\n                  variant=\"text\"\n                  @click=\"removeComponent(element)\"\n                ></v-btn>\n              </div>\n              <component\n                :is=\"getComponentDisplay(element)\"\n                :data=\"element.data\"\n              ></component>\n            </div>\n          </template>\n\n          <template #header>\n            <div v-if=\"components.length === 0\" class=\"placeholder\">\n              <v-icon size=\"32\" class=\"mb-2\">mdi-plus</v-icon>\n              <span>拖拽组件到此处</span>\n            </div>\n          </template>\n        </draggable>\n      </div>\n    </div>\n\n    <!-- 编辑对话框 -->\n    <v-dialog v-model=\"showEditor\" width=\"500\">\n      <v-card>\n        <v-card-title class=\"text-h6\">\n          编辑{{ currentComponent?.name || '组件' }}\n        </v-card-title>\n        <v-card-text>\n          <component\n            v-if=\"currentComponent\"\n            :is=\"getComponentEditor(currentComponent)\"\n            v-model=\"currentComponent.data\"\n          ></component>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" variant=\"text\" @click=\"saveComponent\">\n            保存\n          </v-btn>\n          <v-btn color=\"grey\" variant=\"text\" @click=\"showEditor = false\">\n            取消\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport draggable from 'vuedraggable'\nimport BasicInfoDisplay from './BasicInfoDisplay.vue'\nimport BasicInfo from './BasicInfo.vue'\n\nconst props = defineProps({\n  scale: {\n    type: Number,\n    default: 1\n  }\n})\n\nconst components = ref([])\nconst isDragOver = ref(false)\nconst showEditor = ref(false)\nconst currentComponent = ref(null)\nconst editingIndex = ref(-1)\n\nconst handleDragEnter = (event) => {\n  event.preventDefault()\n  isDragOver.value = true\n}\n\nconst handleDragLeave = (event) => {\n  event.preventDefault()\n  isDragOver.value = false\n}\n\nconst handleDragOver = (event) => {\n  event.preventDefault()\n}\n\nconst handleChange = (event) => {\n  if (event.added) {\n    const component = JSON.parse(event.added.element)\n    const newComponent = {\n      id: Date.now(),\n      type: component.type,\n      name: component.name,\n      config: component.config,\n      data: {}\n    }\n    components.value.splice(event.added.newIndex, 1, newComponent)\n    // 添加新组件后立即打开编辑器\n    openEditor(newComponent, event.added.newIndex)\n  }\n}\n\nconst getComponentDisplay = (component) => {\n  const componentMap = {\n    'contact': BasicInfoDisplay\n  }\n  return componentMap[component.type]\n}\n\nconst getComponentEditor = (component) => {\n  const componentMap = {\n    'contact': BasicInfo\n  }\n  return componentMap[component.type]\n}\n\nconst openEditor = (component, index) => {\n  currentComponent.value = { ...component }\n  editingIndex.value = index !== undefined ? index : components.value.findIndex(c => c.id === component.id)\n  showEditor.value = true\n}\n\nconst saveComponent = () => {\n  if (editingIndex.value > -1) {\n    components.value[editingIndex.value] = { ...currentComponent.value }\n  }\n  showEditor.value = false\n}\n\nconst removeComponent = (component) => {\n  const index = components.value.findIndex(c => c.id === component.id)\n  if (index > -1) {\n    components.value.splice(index, 1)\n  }\n}\n</script>\n\n<style scoped>\n.canvas-container {\n  flex: 1;\n  height: 100%;\n  overflow: auto;\n  background: #f5f7fa;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.canvas-wrapper {\n  padding: 40px;\n  min-height: 100%;\n  min-width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.canvas-content {\n  width: 595px;\n  height: 842px;\n  background: #ffffff;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  transform-origin: center center;\n  overflow: hidden;\n}\n\n.canvas-drop-area {\n  height: 100%;\n  padding: 24px;\n}\n\n.canvas-drop-area.drag-over {\n  background: #ecf5ff;\n  border: 2px dashed #409eff;\n}\n\n.placeholder {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n  font-size: 14px;\n}\n\n.component-item {\n  margin-bottom: 16px;\n  position: relative;\n}\n\n.component-item:last-child {\n  margin-bottom: 0;\n}\n\n.component-actions {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.3s;\n}\n\n.component-item:hover .component-actions {\n  opacity: 1;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}