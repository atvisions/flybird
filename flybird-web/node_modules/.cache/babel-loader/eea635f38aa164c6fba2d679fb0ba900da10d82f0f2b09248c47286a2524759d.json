{"ast":null,"code":"import { ref, watch } from 'vue';\nimport { useTemplateStore } from '@/stores/template';\nexport default {\n  __name: 'SaveTemplateDialog',\n  props: {\n    modelValue: Boolean\n  },\n  emits: ['update:modelValue', 'save'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n\n    // 表单数据\n    const form = ref(null);\n    const valid = ref(false);\n    const loading = ref(false);\n    const formData = ref({\n      name: '',\n      category: null,\n      thumbnail: null,\n      description: '',\n      is_vip: false\n    });\n\n    // 模板分类\n    const templateStore = useTemplateStore();\n    const categories = ref([]);\n\n    // 获取分类数据\n    const fetchCategories = async () => {\n      try {\n        const data = await templateStore.getCategories();\n        categories.value = data;\n      } catch (error) {\n        console.error('获取分类失败:', error);\n      }\n    };\n\n    // 对话框显示状态\n    const dialog = ref(false);\n    watch(() => props.modelValue, val => {\n      dialog.value = val;\n    });\n    watch(dialog, val => {\n      emit('update:modelValue', val);\n      if (!val) {\n        // 重置表单\n        form.value?.reset();\n        formData.value = {\n          name: '',\n          category: null,\n          thumbnail: null,\n          description: '',\n          is_vip: false\n        };\n      }\n    });\n\n    // 保存模板\n    const handleSave = async () => {\n      if (!form.value?.validate()) return;\n      loading.value = true;\n      try {\n        emit('save', formData.value);\n      } catch (error) {\n        console.error('保存失败:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 初始化时获取分类数据\n    fetchCategories();\n    const __returned__ = {\n      props,\n      emit,\n      form,\n      valid,\n      loading,\n      formData,\n      templateStore,\n      categories,\n      fetchCategories,\n      dialog,\n      handleSave,\n      ref,\n      watch,\n      get useTemplateStore() {\n        return useTemplateStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","useTemplateStore","props","__props","emit","__emit","form","valid","loading","formData","name","category","thumbnail","description","is_vip","templateStore","categories","fetchCategories","data","getCategories","value","error","console","dialog","modelValue","val","reset","handleSave","validate"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/SaveTemplateDialog.vue"],"sourcesContent":["<template>\n  <v-dialog v-model=\"dialog\" max-width=\"600\">\n    <v-card>\n      <v-card-title class=\"text-h5\">保存为模板</v-card-title>\n      <v-card-text>\n        <v-form ref=\"form\" v-model=\"valid\">\n          <v-text-field\n            v-model=\"formData.name\"\n            label=\"模板名称\"\n            :rules=\"[v => !!v || '请输入模板名称']\"\n            required\n          ></v-text-field>\n\n          <v-select\n            v-model=\"formData.category\"\n            :items=\"categories\"\n            item-title=\"name\"\n            item-value=\"id\"\n            label=\"选择分类\"\n            :rules=\"[v => !!v || '请选择分类']\"\n            required\n          ></v-select>\n\n          <v-file-input\n            v-model=\"formData.thumbnail\"\n            label=\"缩略图\"\n            accept=\"image/*\"\n            :rules=\"[v => !!v || '请上传缩略图']\"\n            required\n          ></v-file-input>\n\n          <v-textarea\n            v-model=\"formData.description\"\n            label=\"模板描述\"\n            :rules=\"[v => !!v || '请输入模板描述']\"\n            required\n          ></v-textarea>\n\n          <v-switch\n            v-model=\"formData.is_vip\"\n            label=\"VIP模板\"\n            color=\"primary\"\n          ></v-switch>\n        </v-form>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"grey-darken-1\" variant=\"text\" @click=\"dialog = false\">\n          取消\n        </v-btn>\n        <v-btn\n          color=\"primary\"\n          variant=\"text\"\n          :loading=\"loading\"\n          :disabled=\"!valid\"\n          @click=\"handleSave\"\n        >\n          保存\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { useTemplateStore } from '@/stores/template'\n\nconst props = defineProps({\n  modelValue: Boolean\n})\n\nconst emit = defineEmits(['update:modelValue', 'save'])\n\n// 表单数据\nconst form = ref(null)\nconst valid = ref(false)\nconst loading = ref(false)\nconst formData = ref({\n  name: '',\n  category: null,\n  thumbnail: null,\n  description: '',\n  is_vip: false\n})\n\n// 模板分类\nconst templateStore = useTemplateStore()\nconst categories = ref([])\n\n// 获取分类数据\nconst fetchCategories = async () => {\n  try {\n    const data = await templateStore.getCategories()\n    categories.value = data\n  } catch (error) {\n    console.error('获取分类失败:', error)\n  }\n}\n\n// 对话框显示状态\nconst dialog = ref(false)\nwatch(() => props.modelValue, (val) => {\n  dialog.value = val\n})\nwatch(dialog, (val) => {\n  emit('update:modelValue', val)\n  if (!val) {\n    // 重置表单\n    form.value?.reset()\n    formData.value = {\n      name: '',\n      category: null,\n      thumbnail: null,\n      description: '',\n      is_vip: false\n    }\n  }\n})\n\n// 保存模板\nconst handleSave = async () => {\n  if (!form.value?.validate()) return\n\n  loading.value = true\n  try {\n    emit('save', formData.value)\n  } catch (error) {\n    console.error('保存失败:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\n// 初始化时获取分类数据\nfetchCategories()\n</script> "],"mappings":"AAiEA,SAASA,GAAG,EAAEC,KAAK,QAAQ,KAAI;AAC/B,SAASC,gBAAgB,QAAQ,mBAAkB;;;;;;;;;;;;IAEnD,MAAMC,KAAK,GAAGC,OAAA;IAId,MAAMC,IAAI,GAAGC,MAAA;;IAEb;IACA,MAAMC,IAAI,GAAGP,GAAG,CAAC,IAAI;IACrB,MAAMQ,KAAK,GAAGR,GAAG,CAAC,KAAK;IACvB,MAAMS,OAAO,GAAGT,GAAG,CAAC,KAAK;IACzB,MAAMU,QAAQ,GAAGV,GAAG,CAAC;MACnBW,IAAI,EAAE,EAAE;MACRC,QAAQ,EAAE,IAAI;MACdC,SAAS,EAAE,IAAI;MACfC,WAAW,EAAE,EAAE;MACfC,MAAM,EAAE;IACV,CAAC;;IAED;IACA,MAAMC,aAAa,GAAGd,gBAAgB,CAAC;IACvC,MAAMe,UAAU,GAAGjB,GAAG,CAAC,EAAE;;IAEzB;IACA,MAAMkB,eAAe,GAAG,MAAAA,CAAA,KAAY;MAClC,IAAI;QACF,MAAMC,IAAI,GAAG,MAAMH,aAAa,CAACI,aAAa,CAAC;QAC/CH,UAAU,CAACI,KAAK,GAAGF,IAAG;MACxB,CAAC,CAAC,OAAOG,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;MAChC;IACF;;IAEA;IACA,MAAME,MAAM,GAAGxB,GAAG,CAAC,KAAK;IACxBC,KAAK,CAAC,MAAME,KAAK,CAACsB,UAAU,EAAGC,GAAG,IAAK;MACrCF,MAAM,CAACH,KAAK,GAAGK,GAAE;IACnB,CAAC;IACDzB,KAAK,CAACuB,MAAM,EAAGE,GAAG,IAAK;MACrBrB,IAAI,CAAC,mBAAmB,EAAEqB,GAAG;MAC7B,IAAI,CAACA,GAAG,EAAE;QACR;QACAnB,IAAI,CAACc,KAAK,EAAEM,KAAK,CAAC;QAClBjB,QAAQ,CAACW,KAAK,GAAG;UACfV,IAAI,EAAE,EAAE;UACRC,QAAQ,EAAE,IAAI;UACdC,SAAS,EAAE,IAAI;UACfC,WAAW,EAAE,EAAE;UACfC,MAAM,EAAE;QACV;MACF;IACF,CAAC;;IAED;IACA,MAAMa,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI,CAACrB,IAAI,CAACc,KAAK,EAAEQ,QAAQ,CAAC,CAAC,EAAE;MAE7BpB,OAAO,CAACY,KAAK,GAAG,IAAG;MACnB,IAAI;QACFhB,IAAI,CAAC,MAAM,EAAEK,QAAQ,CAACW,KAAK;MAC7B,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;MAC9B,CAAC,SAAS;QACRb,OAAO,CAACY,KAAK,GAAG,KAAI;MACtB;IACF;;IAEA;IACAH,eAAe,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}