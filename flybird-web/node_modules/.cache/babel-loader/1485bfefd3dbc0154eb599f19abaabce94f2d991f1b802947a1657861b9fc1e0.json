{"ast":null,"code":"import { defineStore } from 'pinia';\nimport profile from '@/api/profile';\nimport { ref, computed } from 'vue';\nexport const useProfileStore = defineStore('profile', {\n  state: () => ({\n    basicInfo: null,\n    avatarUpdateTime: null\n  }),\n  getters: {\n    profileAvatar: state => {\n      const url = state.basicInfo?.avatar;\n      return url ? `${import.meta.env.VITE_API_URL}${url}` : null;\n    }\n  },\n  actions: {\n    // 获取档案基本信息\n    async fetchBasicInfo() {\n      try {\n        const response = await profile.getData();\n        if (response?.data?.code === 200 && response?.data?.data?.basic_info) {\n          this.basicInfo = response.data.data.basic_info;\n          this.avatarUpdateTime = Date.now();\n          return this.basicInfo;\n        }\n        return null;\n      } catch (error) {\n        console.error('获取档案基本信息失败:', error);\n        throw error;\n      }\n    },\n    // 更新头像\n    async updateAvatar(formData) {\n      try {\n        const response = await profile.uploadAvatar(formData);\n        if (response?.data?.code === 200) {\n          // 直接更新头像\n          if (this.basicInfo) {\n            console.log('Updating avatar:', response.data.data.avatar);\n            this.basicInfo.avatar = response.data.data.avatar;\n            this.avatarUpdateTime = Date.now();\n          }\n          return response;\n        }\n        throw new Error('上传失败');\n      } catch (error) {\n        throw error;\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","profile","ref","computed","useProfileStore","state","basicInfo","avatarUpdateTime","getters","profileAvatar","url","avatar","import","meta","env","VITE_API_URL","actions","fetchBasicInfo","response","getData","data","code","basic_info","Date","now","error","console","updateAvatar","formData","uploadAvatar","log","Error"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/stores/profile.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport profile from '@/api/profile'\nimport { ref, computed } from 'vue'\n\nexport const useProfileStore = defineStore('profile', {\n  state: () => ({\n    basicInfo: null,\n    avatarUpdateTime: null\n  }),\n\n  getters: {\n    profileAvatar: (state) => {\n      const url = state.basicInfo?.avatar\n      return url ? `${import.meta.env.VITE_API_URL}${url}` : null\n    }\n  },\n\n  actions: {\n    // 获取档案基本信息\n    async fetchBasicInfo() {\n      try {\n        const response = await profile.getData()\n        if (response?.data?.code === 200 && response?.data?.data?.basic_info) {\n          this.basicInfo = response.data.data.basic_info\n          this.avatarUpdateTime = Date.now()\n          return this.basicInfo\n        }\n        return null\n      } catch (error) {\n        console.error('获取档案基本信息失败:', error)\n        throw error\n      }\n    },\n\n    // 更新头像\n    async updateAvatar(formData) {\n      try {\n        const response = await profile.uploadAvatar(formData)\n        if (response?.data?.code === 200) {\n          // 直接更新头像\n          if (this.basicInfo) {\n            console.log('Updating avatar:', response.data.data.avatar)\n            this.basicInfo.avatar = response.data.data.avatar\n            this.avatarUpdateTime = Date.now()\n          }\n          return response\n        }\n        throw new Error('上传失败')\n      } catch (error) {\n        throw error\n      }\n    }\n  }\n}) "],"mappings":"AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,OAAOC,OAAO,MAAM,eAAe;AACnC,SAASC,GAAG,EAAEC,QAAQ,QAAQ,KAAK;AAEnC,OAAO,MAAMC,eAAe,GAAGJ,WAAW,CAAC,SAAS,EAAE;EACpDK,KAAK,EAAEA,CAAA,MAAO;IACZC,SAAS,EAAE,IAAI;IACfC,gBAAgB,EAAE;EACpB,CAAC,CAAC;EAEFC,OAAO,EAAE;IACPC,aAAa,EAAGJ,KAAK,IAAK;MACxB,MAAMK,GAAG,GAAGL,KAAK,CAACC,SAAS,EAAEK,MAAM;MACnC,OAAOD,GAAG,GAAG,GAAGE,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,YAAY,GAAGL,GAAG,EAAE,GAAG,IAAI;IAC7D;EACF,CAAC;EAEDM,OAAO,EAAE;IACP;IACA,MAAMC,cAAcA,CAAA,EAAG;MACrB,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMjB,OAAO,CAACkB,OAAO,CAAC,CAAC;QACxC,IAAID,QAAQ,EAAEE,IAAI,EAAEC,IAAI,KAAK,GAAG,IAAIH,QAAQ,EAAEE,IAAI,EAAEA,IAAI,EAAEE,UAAU,EAAE;UACpE,IAAI,CAAChB,SAAS,GAAGY,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACE,UAAU;UAC9C,IAAI,CAACf,gBAAgB,GAAGgB,IAAI,CAACC,GAAG,CAAC,CAAC;UAClC,OAAO,IAAI,CAAClB,SAAS;QACvB;QACA,OAAO,IAAI;MACb,CAAC,CAAC,OAAOmB,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;QACnC,MAAMA,KAAK;MACb;IACF,CAAC;IAED;IACA,MAAME,YAAYA,CAACC,QAAQ,EAAE;MAC3B,IAAI;QACF,MAAMV,QAAQ,GAAG,MAAMjB,OAAO,CAAC4B,YAAY,CAACD,QAAQ,CAAC;QACrD,IAAIV,QAAQ,EAAEE,IAAI,EAAEC,IAAI,KAAK,GAAG,EAAE;UAChC;UACA,IAAI,IAAI,CAACf,SAAS,EAAE;YAClBoB,OAAO,CAACI,GAAG,CAAC,kBAAkB,EAAEZ,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACT,MAAM,CAAC;YAC1D,IAAI,CAACL,SAAS,CAACK,MAAM,GAAGO,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACT,MAAM;YACjD,IAAI,CAACJ,gBAAgB,GAAGgB,IAAI,CAACC,GAAG,CAAC,CAAC;UACpC;UACA,OAAON,QAAQ;QACjB;QACA,MAAM,IAAIa,KAAK,CAAC,MAAM,CAAC;MACzB,CAAC,CAAC,OAAON,KAAK,EAAE;QACd,MAAMA,KAAK;MACb;IACF;EACF;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}