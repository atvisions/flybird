{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport { ref, computed, watch } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport HeadView from '@/components/HeadView.vue';\nexport default {\n  __name: 'SearchView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n    const searchQuery = computed(() => route.query.q || '');\n    const currentTab = computed(() => {\n      const path = route.path;\n      if (path.includes('/articles')) return 'articles';\n      if (path.includes('/portfolio')) return 'portfolio';\n      if (path.includes('/users')) return 'users';\n      return 'articles';\n    });\n    const page = ref(1);\n    const hasMore = ref(true);\n\n    // 搜索标签配置\n    const searchTabs = ref([{\n      type: 'articles',\n      label: '文章',\n      count: 0,\n      path: '/search/articles'\n    }, {\n      type: 'portfolio',\n      label: '作品集',\n      count: 0,\n      path: '/search/portfolio'\n    }, {\n      type: 'users',\n      label: '用户',\n      count: 0,\n      path: '/search/users'\n    }]);\n\n    // 搜索结果数据\n    const articles = ref([]);\n    const portfolios = ref([]);\n    const users = ref([]);\n\n    // 总结果数\n    const totalResults = computed(() => {\n      return searchTabs.value.reduce((total, tab) => total + tab.count, 0);\n    });\n\n    // 监听搜索关键词变化\n    watch(() => route.query.q, async newQuery => {\n      if (newQuery) {\n        page.value = 1;\n        await fetchSearchResults();\n      }\n    }, {\n      immediate: true\n    });\n\n    // 获取搜索结果\n    const fetchSearchResults = async () => {\n      try {\n        // TODO: 调用搜索 API\n        // const response = await api.search({\n        //   query: searchQuery.value,\n        //   type: currentTab.value,\n        //   page: page.value\n        // })\n\n        // 模拟数据\n        const mockData = {\n          articles: [{\n            id: 1,\n            title: '2024年前端开发趋势',\n            description: '探讨新的前端框架和工具...',\n            author: {\n              name: '张三',\n              avatar: '/avatar1.jpg'\n            },\n            createTime: '2小时前'\n          }],\n          portfolios: [{\n            id: 1,\n            title: '个人作品集',\n            description: '包含最新的设计作品...',\n            cover: '/cover1.jpg',\n            author: {\n              name: '李四',\n              avatar: '/avatar2.jpg'\n            }\n          }],\n          users: [{\n            id: 1,\n            name: '王五',\n            avatar: '/avatar3.jpg',\n            bio: '资深UI设计师，专注用户体验'\n          }]\n        };\n\n        // 更新数据\n        if (page.value === 1) {\n          articles.value = mockData.articles;\n          portfolios.value = mockData.portfolios;\n          users.value = mockData.users;\n        } else {\n          articles.value.push(...mockData.articles);\n          portfolios.value.push(...mockData.portfolios);\n          users.value.push(...mockData.users);\n        }\n\n        // 更新计数\n        searchTabs.value = searchTabs.value.map(tab => _objectSpread(_objectSpread({}, tab), {}, {\n          count: mockData[tab.type]?.length || 0\n        }));\n\n        // 模拟是否还有更多数据\n        hasMore.value = page.value < 3;\n      } catch (error) {\n        console.error('搜索失败:', error);\n      }\n    };\n\n    // 加载更多\n    const loadMore = async () => {\n      page.value++;\n      await fetchSearchResults();\n    };\n\n    // 修改标签点击处理\n    const handleTabChange = type => {\n      router.push({\n        path: `/search/${type}`,\n        query: {\n          q: searchQuery.value\n        }\n      });\n    };\n    const __returned__ = {\n      route,\n      router,\n      searchQuery,\n      currentTab,\n      page,\n      hasMore,\n      searchTabs,\n      articles,\n      portfolios,\n      users,\n      totalResults,\n      fetchSearchResults,\n      loadMore,\n      handleTabChange,\n      ref,\n      computed,\n      watch,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      HeadView\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","watch","useRoute","useRouter","HeadView","route","router","searchQuery","query","q","currentTab","path","includes","page","hasMore","searchTabs","type","label","count","articles","portfolios","users","totalResults","value","reduce","total","tab","newQuery","fetchSearchResults","immediate","mockData","id","title","description","author","name","avatar","createTime","cover","bio","push","map","_objectSpread","length","error","console","loadMore","handleTabChange"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/search/SearchView.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50\">\n    <HeadView />\n    \n    <div class=\"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-24\">\n      <!-- 搜索结果头部 -->\n      <div class=\"mb-8\">\n        <h1 class=\"text-2xl font-medium text-gray-900\">\n          搜索结果：{{ searchQuery }}\n        </h1>\n        <div class=\"mt-2 text-sm text-gray-500\">\n          共找到 {{ totalResults }} 个相关结果\n        </div>\n      </div>\n\n      <!-- 搜索类型切换 -->\n      <div class=\"mb-6 border-b border-gray-200\">\n        <nav class=\"-mb-px flex space-x-8\">\n          <button\n            v-for=\"tab in searchTabs\"\n            :key=\"tab.type\"\n            @click=\"handleTabChange(tab.type)\"\n            class=\"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm\"\n            :class=\"[\n              currentTab === tab.type\n                ? 'border-indigo-500 text-indigo-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            ]\"\n          >\n            {{ tab.label }}\n            <span class=\"ml-2 rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-600\">\n              {{ tab.count }}\n            </span>\n          </button>\n        </nav>\n      </div>\n\n      <!-- 搜索结果列表 -->\n      <div class=\"space-y-6\">\n        <!-- 文章搜索结果 -->\n        <template v-if=\"currentTab === 'articles'\">\n          <div v-for=\"article in articles\" :key=\"article.id\" \n            class=\"bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow\">\n            <router-link :to=\"`/article/${article.id}`\" class=\"block\">\n              <h2 class=\"text-xl font-medium text-gray-900 hover:text-indigo-600\">\n                {{ article.title }}\n              </h2>\n              <p class=\"mt-2 text-gray-600 line-clamp-2\">{{ article.description }}</p>\n              <div class=\"mt-4 flex items-center text-sm text-gray-500\">\n                <img :src=\"article.author.avatar\" class=\"w-6 h-6 rounded-full mr-2\">\n                <span>{{ article.author.name }}</span>\n                <span class=\"mx-2\">·</span>\n                <span>{{ article.createTime }}</span>\n              </div>\n            </router-link>\n          </div>\n        </template>\n\n        <!-- 作品集搜索结果 -->\n        <template v-if=\"currentTab === 'portfolio'\">\n          <div v-for=\"work in portfolios\" :key=\"work.id\" \n            class=\"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden\">\n            <router-link :to=\"`/portfolio/${work.id}`\" class=\"block\">\n              <div class=\"aspect-w-16 aspect-h-9\">\n                <img :src=\"work.cover\" class=\"object-cover w-full h-full\">\n              </div>\n              <div class=\"p-6\">\n                <h2 class=\"text-xl font-medium text-gray-900 hover:text-indigo-600\">\n                  {{ work.title }}\n                </h2>\n                <p class=\"mt-2 text-gray-600 line-clamp-2\">{{ work.description }}</p>\n                <div class=\"mt-4 flex items-center text-sm text-gray-500\">\n                  <img :src=\"work.author.avatar\" class=\"w-6 h-6 rounded-full mr-2\">\n                  <span>{{ work.author.name }}</span>\n                </div>\n              </div>\n            </router-link>\n          </div>\n        </template>\n\n        <!-- 用户搜索结果 -->\n        <template v-if=\"currentTab === 'users'\">\n          <div v-for=\"user in users\" :key=\"user.id\" \n            class=\"bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow\">\n            <router-link :to=\"`/user/${user.id}`\" class=\"flex items-center\">\n              <img :src=\"user.avatar\" class=\"w-12 h-12 rounded-full\">\n              <div class=\"ml-4\">\n                <h2 class=\"text-lg font-medium text-gray-900\">{{ user.name }}</h2>\n                <p class=\"mt-1 text-sm text-gray-500\">{{ user.bio }}</p>\n              </div>\n              <button class=\"ml-auto px-4 py-2 text-sm text-indigo-600 border border-indigo-600 rounded-md hover:bg-indigo-50\">\n                关注\n              </button>\n            </router-link>\n          </div>\n        </template>\n      </div>\n\n      <!-- 加载更多 -->\n      <div v-if=\"hasMore\" class=\"mt-8 text-center\">\n        <button \n          @click=\"loadMore\"\n          class=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\n        >\n          加载更多\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport HeadView from '@/components/HeadView.vue'\n\nconst route = useRoute()\nconst router = useRouter()\nconst searchQuery = computed(() => route.query.q || '')\nconst currentTab = computed(() => {\n  const path = route.path\n  if (path.includes('/articles')) return 'articles'\n  if (path.includes('/portfolio')) return 'portfolio'\n  if (path.includes('/users')) return 'users'\n  return 'articles'\n})\nconst page = ref(1)\nconst hasMore = ref(true)\n\n// 搜索标签配置\nconst searchTabs = ref([\n  { \n    type: 'articles', \n    label: '文章', \n    count: 0,\n    path: '/search/articles'\n  },\n  { \n    type: 'portfolio', \n    label: '作品集', \n    count: 0,\n    path: '/search/portfolio'\n  },\n  { \n    type: 'users', \n    label: '用户', \n    count: 0,\n    path: '/search/users'\n  }\n])\n\n// 搜索结果数据\nconst articles = ref([])\nconst portfolios = ref([])\nconst users = ref([])\n\n// 总结果数\nconst totalResults = computed(() => {\n  return searchTabs.value.reduce((total, tab) => total + tab.count, 0)\n})\n\n// 监听搜索关键词变化\nwatch(() => route.query.q, async (newQuery) => {\n  if (newQuery) {\n    page.value = 1\n    await fetchSearchResults()\n  }\n}, { immediate: true })\n\n// 获取搜索结果\nconst fetchSearchResults = async () => {\n  try {\n    // TODO: 调用搜索 API\n    // const response = await api.search({\n    //   query: searchQuery.value,\n    //   type: currentTab.value,\n    //   page: page.value\n    // })\n    \n    // 模拟数据\n    const mockData = {\n      articles: [\n        {\n          id: 1,\n          title: '2024年前端开发趋势',\n          description: '探讨新的前端框架和工具...',\n          author: {\n            name: '张三',\n            avatar: '/avatar1.jpg'\n          },\n          createTime: '2小时前'\n        }\n      ],\n      portfolios: [\n        {\n          id: 1,\n          title: '个人作品集',\n          description: '包含最新的设计作品...',\n          cover: '/cover1.jpg',\n          author: {\n            name: '李四',\n            avatar: '/avatar2.jpg'\n          }\n        }\n      ],\n      users: [\n        {\n          id: 1,\n          name: '王五',\n          avatar: '/avatar3.jpg',\n          bio: '资深UI设计师，专注用户体验'\n        }\n      ]\n    }\n\n    // 更新数据\n    if (page.value === 1) {\n      articles.value = mockData.articles\n      portfolios.value = mockData.portfolios\n      users.value = mockData.users\n    } else {\n      articles.value.push(...mockData.articles)\n      portfolios.value.push(...mockData.portfolios)\n      users.value.push(...mockData.users)\n    }\n\n    // 更新计数\n    searchTabs.value = searchTabs.value.map(tab => ({\n      ...tab,\n      count: mockData[tab.type]?.length || 0\n    }))\n\n    // 模拟是否还有更多数据\n    hasMore.value = page.value < 3\n  } catch (error) {\n    console.error('搜索失败:', error)\n  }\n}\n\n// 加载更多\nconst loadMore = async () => {\n  page.value++\n  await fetchSearchResults()\n}\n\n// 修改标签点击处理\nconst handleTabChange = (type) => {\n  router.push({\n    path: `/search/${type}`,\n    query: { q: searchQuery.value }\n  })\n}\n</script> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}