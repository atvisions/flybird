{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport { ref, shallowRef, onBeforeUnmount, watch, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue';\nimport { PhotoIcon, XMarkIcon, ChevronUpDownIcon, CheckIcon, CodeBracketIcon, ServerIcon, DevicePhoneMobileIcon, ChartBarIcon, DatabaseIcon, CpuChipIcon, BeakerIcon } from '@heroicons/vue/24/outline';\nimport { showToast } from '@/components/ToastMessage';\nimport { Listbox, ListboxButton, ListboxOptions, ListboxOption } from '@headlessui/vue';\n\n// 引入编辑器样式\nimport '@wangeditor/editor/dist/css/style.css';\nconst DRAFT_KEY = 'article_draft';\nexport default {\n  __name: 'ArticleForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n\n    // 编辑器实例，必须用 shallowRef\n    const editorRef = shallowRef();\n\n    // 编辑器配置\n    const toolbarConfig = {\n      excludeKeys: ['group-video', 'insertTable', 'group-indent', 'headerSelect']\n    };\n    const editorConfig = {\n      placeholder: '请输入文章内容...',\n      MENU_CONF: {\n        uploadImage: {\n          server: '/api/upload/image',\n          fieldName: 'image',\n          maxFileSize: 10 * 1024 * 1024,\n          // 10M\n          maxNumberOfFiles: 10,\n          allowedFileTypes: ['image/*'],\n          metaWithUrl: true,\n          customInsert(res, insertFn) {\n            // res 即服务端返回的数据\n            insertFn(res.url, res.alt, res.href);\n          }\n        },\n        codeSelectLang: {\n          codeLangs: [{\n            text: 'JavaScript',\n            value: 'javascript'\n          }, {\n            text: 'TypeScript',\n            value: 'typescript'\n          }, {\n            text: 'HTML',\n            value: 'html'\n          }, {\n            text: 'CSS',\n            value: 'css'\n          }, {\n            text: 'Vue',\n            value: 'vue'\n          }, {\n            text: 'Python',\n            value: 'python'\n          }, {\n            text: 'Java',\n            value: 'java'\n          }, {\n            text: 'Go',\n            value: 'go'\n          }, {\n            text: 'SQL',\n            value: 'sql'\n          }, {\n            text: 'Shell',\n            value: 'shell'\n          }]\n        }\n      }\n    };\n\n    // 组件销毁时，也及时销毁编辑器\n    onBeforeUnmount(() => {\n      const editor = editorRef.value;\n      if (editor == null) return;\n      editor.destroy();\n    });\n    const handleCreated = editor => {\n      editorRef.value = editor;\n    };\n\n    // 文章表单数据\n    const articleForm = ref({\n      title: '',\n      category: '',\n      cover: '',\n      content: '',\n      tags: []\n    });\n\n    // 标签相关\n    const newTag = ref('');\n    const addTag = () => {\n      const tag = newTag.value.trim();\n      if (tag && !articleForm.value.tags.includes(tag) && articleForm.value.tags.length < 5) {\n        articleForm.value.tags.push(tag);\n        newTag.value = '';\n      }\n    };\n    const removeTag = tag => {\n      articleForm.value.tags = articleForm.value.tags.filter(t => t !== tag);\n    };\n\n    // 封面图上传\n    const coverInput = ref(null);\n    const uploadCover = () => {\n      coverInput.value.click();\n    };\n    const handleCoverChange = e => {\n      const file = e.target.files[0];\n      if (!file) return;\n\n      // TODO: 调用上传接口\n      const reader = new FileReader();\n      reader.onload = e => {\n        articleForm.value.cover = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    };\n\n    // 草稿相关\n    const lastSavedTime = ref('');\n    const autoSaveTimer = ref(null);\n\n    // 格式化时间\n    const formatTime = date => {\n      const now = new Date();\n      const diff = now - date;\n      if (diff < 60000) {\n        // 小于1分钟\n        return '刚刚';\n      } else if (diff < 3600000) {\n        // 小于1小时\n        return `${Math.floor(diff / 60000)}分钟前`;\n      } else if (diff < 86400000) {\n        // 小于24小时\n        return `${Math.floor(diff / 3600000)}小时前`;\n      } else {\n        return date.toLocaleString();\n      }\n    };\n\n    // 保存草稿\n    const saveDraft = () => {\n      const draft = _objectSpread(_objectSpread({}, articleForm.value), {}, {\n        savedAt: new Date().toISOString()\n      });\n      localStorage.setItem(DRAFT_KEY, JSON.stringify(draft));\n      lastSavedTime.value = formatTime(new Date());\n      showToast('草稿已保存', 'success');\n    };\n\n    // 加载草稿\n    const loadDraft = () => {\n      const draft = localStorage.getItem(DRAFT_KEY);\n      if (draft) {\n        const data = JSON.parse(draft);\n        articleForm.value = {\n          title: data.title || '',\n          category: data.category || '',\n          cover: data.cover || '',\n          content: data.content || '',\n          tags: data.tags || []\n        };\n        if (data.category) {\n          selectedCategory.value = categories.find(c => c.id === data.category) || categories[0];\n        }\n        lastSavedTime.value = formatTime(new Date(data.savedAt));\n      }\n    };\n\n    // 自动保存\n    const startAutoSave = () => {\n      autoSaveTimer.value = setInterval(() => {\n        if (articleForm.value.title || articleForm.value.content) {\n          saveDraft();\n        }\n      }, 60000); // 每分钟自动保存\n    };\n\n    // 清除草稿\n    const clearDraft = () => {\n      localStorage.removeItem(DRAFT_KEY);\n      lastSavedTime.value = '';\n    };\n\n    // 组件挂载时加载草稿并开启自动保存\n    onMounted(() => {\n      loadDraft();\n      startAutoSave();\n    });\n\n    // 组件销毁时清除定时器\n    onBeforeUnmount(() => {\n      if (autoSaveTimer.value) {\n        clearInterval(autoSaveTimer.value);\n      }\n    });\n\n    // 提交文章\n    const submitArticle = () => {\n      // 表单验证\n      if (!articleForm.value.title) {\n        showToast('请输入文章标题', 'warning');\n        return;\n      }\n      if (!articleForm.value.category) {\n        showToast('请选择文章分类', 'warning');\n        return;\n      }\n      if (!articleForm.value.content) {\n        showToast('请输入文章内容', 'warning');\n        return;\n      }\n\n      // TODO: 调用接口提交文章\n      console.log('提交文章:', articleForm.value);\n      clearDraft(); // 发布成功后清除草稿\n      showToast('发布成功', 'success');\n      router.push('/community/articles');\n    };\n\n    // 分类数据\n    const categories = [{\n      id: 'frontend',\n      name: '前端开发',\n      icon: CodeBracketIcon\n    }, {\n      id: 'backend',\n      name: '后端开发',\n      icon: ServerIcon\n    }, {\n      id: 'mobile',\n      name: '移动开发',\n      icon: DevicePhoneMobileIcon\n    }, {\n      id: 'algorithm',\n      name: '算法',\n      icon: ChartBarIcon\n    }, {\n      id: 'database',\n      name: '数据库',\n      icon: DatabaseIcon\n    }, {\n      id: 'devops',\n      name: '运维',\n      icon: CpuChipIcon\n    }, {\n      id: 'ai',\n      name: '人工智能',\n      icon: BeakerIcon\n    }];\n\n    // 选中的分类\n    const selectedCategory = ref(categories[0]);\n\n    // 监听分类变化，更新表单数据\n    watch(selectedCategory, category => {\n      articleForm.value.category = category.id;\n    });\n    const __returned__ = {\n      router,\n      editorRef,\n      toolbarConfig,\n      editorConfig,\n      handleCreated,\n      articleForm,\n      newTag,\n      addTag,\n      removeTag,\n      coverInput,\n      uploadCover,\n      handleCoverChange,\n      DRAFT_KEY,\n      lastSavedTime,\n      autoSaveTimer,\n      formatTime,\n      saveDraft,\n      loadDraft,\n      startAutoSave,\n      clearDraft,\n      submitArticle,\n      categories,\n      selectedCategory,\n      ref,\n      shallowRef,\n      onBeforeUnmount,\n      watch,\n      onMounted,\n      get useRouter() {\n        return useRouter;\n      },\n      get Editor() {\n        return Editor;\n      },\n      get Toolbar() {\n        return Toolbar;\n      },\n      get PhotoIcon() {\n        return PhotoIcon;\n      },\n      get XMarkIcon() {\n        return XMarkIcon;\n      },\n      get ChevronUpDownIcon() {\n        return ChevronUpDownIcon;\n      },\n      get CheckIcon() {\n        return CheckIcon;\n      },\n      get CodeBracketIcon() {\n        return CodeBracketIcon;\n      },\n      get ServerIcon() {\n        return ServerIcon;\n      },\n      get DevicePhoneMobileIcon() {\n        return DevicePhoneMobileIcon;\n      },\n      get ChartBarIcon() {\n        return ChartBarIcon;\n      },\n      get DatabaseIcon() {\n        return DatabaseIcon;\n      },\n      get CpuChipIcon() {\n        return CpuChipIcon;\n      },\n      get BeakerIcon() {\n        return BeakerIcon;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get Listbox() {\n        return Listbox;\n      },\n      get ListboxButton() {\n        return ListboxButton;\n      },\n      get ListboxOptions() {\n        return ListboxOptions;\n      },\n      get ListboxOption() {\n        return ListboxOption;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","shallowRef","onBeforeUnmount","watch","onMounted","useRouter","Editor","Toolbar","PhotoIcon","XMarkIcon","ChevronUpDownIcon","CheckIcon","CodeBracketIcon","ServerIcon","DevicePhoneMobileIcon","ChartBarIcon","DatabaseIcon","CpuChipIcon","BeakerIcon","showToast","Listbox","ListboxButton","ListboxOptions","ListboxOption","DRAFT_KEY","router","editorRef","toolbarConfig","excludeKeys","editorConfig","placeholder","MENU_CONF","uploadImage","server","fieldName","maxFileSize","maxNumberOfFiles","allowedFileTypes","metaWithUrl","customInsert","res","insertFn","url","alt","href","codeSelectLang","codeLangs","text","value","editor","destroy","handleCreated","articleForm","title","category","cover","content","tags","newTag","addTag","tag","trim","includes","length","push","removeTag","filter","t","coverInput","uploadCover","click","handleCoverChange","e","file","target","files","reader","FileReader","onload","result","readAsDataURL","lastSavedTime","autoSaveTimer","formatTime","date","now","Date","diff","Math","floor","toLocaleString","saveDraft","draft","_objectSpread","savedAt","toISOString","localStorage","setItem","JSON","stringify","loadDraft","getItem","data","parse","selectedCategory","categories","find","c","id","startAutoSave","setInterval","clearDraft","removeItem","clearInterval","submitArticle","console","log","name","icon"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/community/components/ArticleForm.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6 pb-24\">\n    <!-- 标题 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章标题</label>\n      <input\n        type=\"text\"\n        v-model=\"articleForm.title\"\n        class=\"block w-full rounded-lg border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500\"\n        placeholder=\"请输入文章标题\"\n      >\n    </div>\n\n    <!-- 分类 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章分类</label>\n      <div class=\"relative\">\n        <!-- 分类选择 -->\n        <Listbox v-model=\"selectedCategory\">\n          <div class=\"relative\">\n            <ListboxButton\n              class=\"relative w-full cursor-pointer rounded-lg bg-white py-2.5 pl-3 pr-10 text-left border border-gray-300 focus:outline-none focus:ring-2 focus:ring-violet-500 sm:text-sm\"\n            >\n              <span class=\"flex items-center\">\n                <component \n                  :is=\"selectedCategory.icon\" \n                  class=\"h-5 w-5 flex-shrink-0 text-gray-400\"\n                  aria-hidden=\"true\"\n                />\n                <span class=\"ml-3 block truncate\">{{ selectedCategory.name }}</span>\n              </span>\n              <span class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2\">\n                <ChevronUpDownIcon class=\"h-5 w-5 text-gray-400\" aria-hidden=\"true\" />\n              </span>\n            </ListboxButton>\n\n            <Transition\n              leave-active-class=\"transition duration-100 ease-in\"\n              leave-from-class=\"opacity-100\"\n              leave-to-class=\"opacity-0\"\n            >\n              <ListboxOptions\n                class=\"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm\"\n              >\n                <ListboxOption\n                  v-for=\"category in categories\"\n                  :key=\"category.id\"\n                  :value=\"category\"\n                  v-slot=\"{ active, selected }\"\n                  as=\"template\"\n                >\n                  <li\n                    :class=\"[\n                      active ? 'bg-violet-600 text-white' : 'text-gray-900',\n                      'relative cursor-pointer select-none py-2 pl-3 pr-9'\n                    ]\"\n                  >\n                    <div class=\"flex items-center\">\n                      <component \n                        :is=\"category.icon\" \n                        :class=\"[\n                          active ? 'text-white' : 'text-gray-400',\n                          'h-5 w-5 flex-shrink-0'\n                        ]\"\n                        aria-hidden=\"true\"\n                      />\n                      <span\n                        :class=\"[\n                          selected ? 'font-semibold' : 'font-normal',\n                          'ml-3 block truncate'\n                        ]\"\n                      >\n                        {{ category.name }}\n                      </span>\n                    </div>\n\n                    <span\n                      v-if=\"selected\"\n                      :class=\"[\n                        active ? 'text-white' : 'text-violet-600',\n                        'absolute inset-y-0 right-0 flex items-center pr-4'\n                      ]\"\n                    >\n                      <CheckIcon class=\"h-5 w-5\" aria-hidden=\"true\" />\n                    </span>\n                  </li>\n                </ListboxOption>\n              </ListboxOptions>\n            </Transition>\n          </div>\n        </Listbox>\n      </div>\n    </div>\n\n    <!-- 封面图 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章封面</label>\n      <div class=\"flex items-center gap-4\">\n        <div \n          v-if=\"articleForm.cover\"\n          class=\"relative w-48 h-32 rounded-lg overflow-hidden group\"\n        >\n          <img \n            :src=\"articleForm.cover\" \n            class=\"w-full h-full object-cover\"\n          >\n          <div \n            class=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\"\n          >\n            <button \n              class=\"text-white text-sm\"\n              @click=\"articleForm.cover = ''\"\n            >\n              删除封面\n            </button>\n          </div>\n        </div>\n        <div v-else>\n          <button \n            class=\"w-48 h-32 rounded-lg border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors flex flex-col items-center justify-center gap-2\"\n            @click=\"uploadCover\"\n          >\n            <PhotoIcon class=\"w-6 h-6 text-gray-400\" />\n            <span class=\"text-sm text-gray-500\">点击上传封面</span>\n          </button>\n          <input\n            ref=\"coverInput\"\n            type=\"file\"\n            accept=\"image/*\"\n            class=\"hidden\"\n            @change=\"handleCoverChange\"\n          >\n        </div>\n      </div>\n    </div>\n\n    <!-- 文章内容 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章内容</label>\n      <div class=\"border rounded-lg border-gray-300\">\n        <Toolbar\n          :editor=\"editorRef\"\n          :defaultConfig=\"toolbarConfig\"\n          mode=\"default\"\n          style=\"border-bottom: 1px solid #e5e7eb\"\n        />\n        <Editor\n          v-model=\"articleForm.content\"\n          :defaultConfig=\"editorConfig\"\n          mode=\"default\"\n          @onCreated=\"handleCreated\"\n          style=\"height: 500px\"\n        />\n      </div>\n    </div>\n\n    <!-- 标签 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">添加标签</label>\n      <div class=\"flex flex-wrap gap-2\">\n        <div\n          v-for=\"tag in articleForm.tags\"\n          :key=\"tag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm flex items-center group\"\n        >\n          <span>{{ tag }}</span>\n          <XMarkIcon \n            class=\"w-4 h-4 ml-1 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity\"\n            @click=\"removeTag(tag)\"\n          />\n        </div>\n        <input\n          v-if=\"articleForm.tags.length < 5\"\n          type=\"text\"\n          v-model=\"newTag\"\n          @keydown.enter=\"addTag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-violet-500\"\n          placeholder=\"按回车添加标签\"\n        >\n      </div>\n      <p class=\"mt-1 text-xs text-gray-500\">最多添加 5 个标签</p>\n    </div>\n\n    <!-- 发布按钮 -->\n    <div class=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 lg:px-8 py-4 z-50\">\n      <div class=\"max-w-4xl mx-auto flex items-center\">\n        <!-- 草稿状态提示 -->\n        <span \n          v-if=\"lastSavedTime\" \n          class=\"text-sm text-gray-500\"\n        >\n          {{ lastSavedTime }} 已保存草稿\n        </span>\n        <div class=\"flex-1\"></div>\n        <button \n          class=\"px-6 h-10 border border-violet-600 text-violet-600 rounded-lg hover:bg-violet-50 transition-colors\"\n          @click=\"saveDraft\"\n        >\n          保存草稿\n        </button>\n        <button \n          class=\"ml-4 px-6 h-10 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors\"\n          @click=\"submitArticle\"\n        >\n          发布文章\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, shallowRef, onBeforeUnmount, watch, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\nimport { \n  PhotoIcon, \n  XMarkIcon, \n  ChevronUpDownIcon, \n  CheckIcon,\n  CodeBracketIcon,\n  ServerIcon,\n  DevicePhoneMobileIcon,\n  ChartBarIcon,\n  DatabaseIcon,\n  CpuChipIcon,\n  BeakerIcon\n} from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\nimport { Listbox, ListboxButton, ListboxOptions, ListboxOption } from '@headlessui/vue'\n\n// 引入编辑器样式\nimport '@wangeditor/editor/dist/css/style.css'\n\nconst router = useRouter()\n\n// 编辑器实例，必须用 shallowRef\nconst editorRef = shallowRef()\n\n// 编辑器配置\nconst toolbarConfig = {\n  excludeKeys: [\n    'group-video',\n    'insertTable',\n    'group-indent',\n    'headerSelect'\n  ]\n}\n\nconst editorConfig = {\n  placeholder: '请输入文章内容...',\n  MENU_CONF: {\n    uploadImage: {\n      server: '/api/upload/image',\n      fieldName: 'image',\n      maxFileSize: 10 * 1024 * 1024, // 10M\n      maxNumberOfFiles: 10,\n      allowedFileTypes: ['image/*'],\n      metaWithUrl: true,\n      customInsert(res, insertFn) {\n        // res 即服务端返回的数据\n        insertFn(res.url, res.alt, res.href)\n      },\n    },\n    codeSelectLang: {\n      codeLangs: [\n        { text: 'JavaScript', value: 'javascript' },\n        { text: 'TypeScript', value: 'typescript' },\n        { text: 'HTML', value: 'html' },\n        { text: 'CSS', value: 'css' },\n        { text: 'Vue', value: 'vue' },\n        { text: 'Python', value: 'python' },\n        { text: 'Java', value: 'java' },\n        { text: 'Go', value: 'go' },\n        { text: 'SQL', value: 'sql' },\n        { text: 'Shell', value: 'shell' }\n      ]\n    }\n  }\n}\n\n// 组件销毁时，也及时销毁编辑器\nonBeforeUnmount(() => {\n  const editor = editorRef.value\n  if (editor == null) return\n  editor.destroy()\n})\n\nconst handleCreated = (editor) => {\n  editorRef.value = editor\n}\n\n// 文章表单数据\nconst articleForm = ref({\n  title: '',\n  category: '',\n  cover: '',\n  content: '',\n  tags: []\n})\n\n// 标签相关\nconst newTag = ref('')\n\nconst addTag = () => {\n  const tag = newTag.value.trim()\n  if (tag && !articleForm.value.tags.includes(tag) && articleForm.value.tags.length < 5) {\n    articleForm.value.tags.push(tag)\n    newTag.value = ''\n  }\n}\n\nconst removeTag = (tag) => {\n  articleForm.value.tags = articleForm.value.tags.filter(t => t !== tag)\n}\n\n// 封面图上传\nconst coverInput = ref(null)\n\nconst uploadCover = () => {\n  coverInput.value.click()\n}\n\nconst handleCoverChange = (e) => {\n  const file = e.target.files[0]\n  if (!file) return\n\n  // TODO: 调用上传接口\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    articleForm.value.cover = e.target.result\n  }\n  reader.readAsDataURL(file)\n}\n\n// 草稿相关\nconst DRAFT_KEY = 'article_draft'\nconst lastSavedTime = ref('')\nconst autoSaveTimer = ref(null)\n\n// 格式化时间\nconst formatTime = (date) => {\n  const now = new Date()\n  const diff = now - date\n  \n  if (diff < 60000) { // 小于1分钟\n    return '刚刚'\n  } else if (diff < 3600000) { // 小于1小时\n    return `${Math.floor(diff / 60000)}分钟前`\n  } else if (diff < 86400000) { // 小于24小时\n    return `${Math.floor(diff / 3600000)}小时前`\n  } else {\n    return date.toLocaleString()\n  }\n}\n\n// 保存草稿\nconst saveDraft = () => {\n  const draft = {\n    ...articleForm.value,\n    savedAt: new Date().toISOString()\n  }\n  localStorage.setItem(DRAFT_KEY, JSON.stringify(draft))\n  lastSavedTime.value = formatTime(new Date())\n  showToast('草稿已保存', 'success')\n}\n\n// 加载草稿\nconst loadDraft = () => {\n  const draft = localStorage.getItem(DRAFT_KEY)\n  if (draft) {\n    const data = JSON.parse(draft)\n    articleForm.value = {\n      title: data.title || '',\n      category: data.category || '',\n      cover: data.cover || '',\n      content: data.content || '',\n      tags: data.tags || []\n    }\n    if (data.category) {\n      selectedCategory.value = categories.find(c => c.id === data.category) || categories[0]\n    }\n    lastSavedTime.value = formatTime(new Date(data.savedAt))\n  }\n}\n\n// 自动保存\nconst startAutoSave = () => {\n  autoSaveTimer.value = setInterval(() => {\n    if (articleForm.value.title || articleForm.value.content) {\n      saveDraft()\n    }\n  }, 60000) // 每分钟自动保存\n}\n\n// 清除草稿\nconst clearDraft = () => {\n  localStorage.removeItem(DRAFT_KEY)\n  lastSavedTime.value = ''\n}\n\n// 组件挂载时加载草稿并开启自动保存\nonMounted(() => {\n  loadDraft()\n  startAutoSave()\n})\n\n// 组件销毁时清除定时器\nonBeforeUnmount(() => {\n  if (autoSaveTimer.value) {\n    clearInterval(autoSaveTimer.value)\n  }\n})\n\n// 提交文章\nconst submitArticle = () => {\n  // 表单验证\n  if (!articleForm.value.title) {\n    showToast('请输入文章标题', 'warning')\n    return\n  }\n  if (!articleForm.value.category) {\n    showToast('请选择文章分类', 'warning')\n    return\n  }\n  if (!articleForm.value.content) {\n    showToast('请输入文章内容', 'warning')\n    return\n  }\n\n  // TODO: 调用接口提交文章\n  console.log('提交文章:', articleForm.value)\n  clearDraft() // 发布成功后清除草稿\n  showToast('发布成功', 'success')\n  router.push('/community/articles')\n}\n\n// 分类数据\nconst categories = [\n  { id: 'frontend', name: '前端开发', icon: CodeBracketIcon },\n  { id: 'backend', name: '后端开发', icon: ServerIcon },\n  { id: 'mobile', name: '移动开发', icon: DevicePhoneMobileIcon },\n  { id: 'algorithm', name: '算法', icon: ChartBarIcon },\n  { id: 'database', name: '数据库', icon: DatabaseIcon },\n  { id: 'devops', name: '运维', icon: CpuChipIcon },\n  { id: 'ai', name: '人工智能', icon: BeakerIcon }\n]\n\n// 选中的分类\nconst selectedCategory = ref(categories[0])\n\n// 监听分类变化，更新表单数据\nwatch(selectedCategory, (category) => {\n  articleForm.value.category = category.id\n})\n</script>\n\n<style>\n.w-e-bar {\n  padding: 0 8px !important;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}