{"ast":null,"code":"import { createElementVNode as _createElementVNode, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"fixed inset-0 overflow-y-auto\"\n};\nconst _hoisted_2 = {\n  class: \"flex min-h-full items-center justify-center p-4 text-center\"\n};\nconst _hoisted_3 = {\n  class: \"mt-2 p-4 bg-blue-50 rounded-lg\"\n};\nconst _hoisted_4 = {\n  class: \"flex\"\n};\nconst _hoisted_5 = {\n  class: \"flex-shrink-0\"\n};\nconst _hoisted_6 = {\n  class: \"mt-4\"\n};\nconst _hoisted_7 = {\n  class: \"flex flex-col items-center\"\n};\nconst _hoisted_8 = {\n  class: \"relative w-full h-64 mb-4 bg-gray-100 rounded-lg overflow-hidden\"\n};\nconst _hoisted_9 = {\n  class: \"cursor-pointer inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n};\nconst _hoisted_10 = {\n  class: \"mt-6 flex justify-end space-x-3\"\n};\nconst _hoisted_11 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"TransitionRoot\"], {\n    appear: \"\",\n    show: $props.modelValue,\n    as: \"template\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Dialog\"], {\n      as: \"div\",\n      class: \"relative z-50\",\n      onClose: $setup.closeDialog\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0\",\n        \"enter-to\": \"opacity-100\",\n        leave: \"duration-200 ease-in\",\n        \"leave-from\": \"opacity-100\",\n        \"leave-to\": \"opacity-0\"\n      }, {\n        default: _withCtx(() => _cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n          class: \"fixed inset-0 bg-black/25\"\n        }, null, -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0 scale-95\",\n        \"enter-to\": \"opacity-100 scale-100\",\n        leave: \"duration-200 ease-in\",\n        \"leave-from\": \"opacity-100 scale-100\",\n        \"leave-to\": \"opacity-0 scale-95\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"DialogPanel\"], {\n          class: \"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all\"\n        }, {\n          default: _withCtx(() => [_createVNode($setup[\"DialogTitle\"], {\n            as: \"h3\",\n            class: \"text-lg font-medium leading-6 text-gray-900\"\n          }, {\n            default: _withCtx(() => _cache[1] || (_cache[1] = [_createTextVNode(\" 上传职业头像 \")])),\n            _: 1 /* STABLE */\n          }), _createCommentVNode(\" 提示信息 \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createVNode($setup[\"InformationCircleIcon\"], {\n            class: \"h-5 w-5 text-blue-400\"\n          })]), _cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n            class: \"ml-3\"\n          }, [_createElementVNode(\"p\", {\n            class: \"text-sm text-blue-700\"\n          }, \" 一张专业的职业头像能让您的简历更加出众： \"), _createElementVNode(\"ul\", {\n            class: \"mt-2 text-sm text-blue-600 list-disc list-inside\"\n          }, [_createElementVNode(\"li\", null, \"建议使用正面照，保持微笑\"), _createElementVNode(\"li\", null, \"着装整洁得体，背景简单\"), _createElementVNode(\"li\", null, \"光线充足，图片清晰\")])], -1 /* HOISTED */))])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createCommentVNode(\" 裁剪区域 \"), _createElementVNode(\"div\", _hoisted_8, [_createVNode($setup[\"VueCropper\"], {\n            ref: \"cropperRef\",\n            src: $setup.imageUrl,\n            \"aspect-ratio\": 1,\n            \"view-mode\": 1,\n            \"guide-lines\": true,\n            background: true,\n            rotatable: false,\n            zoomable: true,\n            movable: true,\n            \"auto-crop-area\": 0.8,\n            \"drag-mode\": \"move\",\n            preview: \".preview\"\n          }, null, 8 /* PROPS */, [\"src\"])]), _createCommentVNode(\" 预览区域 \"), _cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n            class: \"preview w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200 mb-4\"\n          }, null, -1 /* HOISTED */)), _createCommentVNode(\" 上传按钮 \"), _createElementVNode(\"label\", _hoisted_9, [_createElementVNode(\"input\", {\n            type: \"file\",\n            class: \"hidden\",\n            accept: \"image/*\",\n            onChange: $setup.handleFileChange\n          }, null, 32 /* NEED_HYDRATION */), _cache[3] || (_cache[3] = _createTextVNode(\" 选择图片 \"))])])]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50\",\n            onClick: $setup.closeDialog\n          }, \" 取消 \"), _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700\",\n            disabled: !$setup.hasImage,\n            onClick: $setup.handleCrop\n          }, \" 确认上传 \", 8 /* PROPS */, _hoisted_11)])]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })])])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"show\"]);\n}","map":{"version":3,"names":["class","_createBlock","$setup","appear","show","$props","modelValue","as","default","_withCtx","_createVNode","onClose","closeDialog","enter","leave","_cache","_createElementVNode","_","_hoisted_1","_hoisted_2","_createTextVNode","_createCommentVNode","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","ref","src","imageUrl","background","rotatable","zoomable","movable","preview","_hoisted_9","type","accept","onChange","handleFileChange","_hoisted_10","onClick","disabled","hasImage","handleCrop","_hoisted_11"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/components/ProfileAvatarCropper.vue"],"sourcesContent":["<template>\n  <TransitionRoot appear :show=\"modelValue\" as=\"template\">\n    <Dialog as=\"div\" class=\"relative z-50\" @close=\"closeDialog\">\n      <TransitionChild\n        as=\"template\"\n        enter=\"duration-300 ease-out\"\n        enter-from=\"opacity-0\"\n        enter-to=\"opacity-100\"\n        leave=\"duration-200 ease-in\"\n        leave-from=\"opacity-100\"\n        leave-to=\"opacity-0\"\n      >\n        <div class=\"fixed inset-0 bg-black/25\" />\n      </TransitionChild>\n\n      <div class=\"fixed inset-0 overflow-y-auto\">\n        <div class=\"flex min-h-full items-center justify-center p-4 text-center\">\n          <TransitionChild\n            as=\"template\"\n            enter=\"duration-300 ease-out\"\n            enter-from=\"opacity-0 scale-95\"\n            enter-to=\"opacity-100 scale-100\"\n            leave=\"duration-200 ease-in\"\n            leave-from=\"opacity-100 scale-100\"\n            leave-to=\"opacity-0 scale-95\"\n          >\n            <DialogPanel class=\"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all\">\n              <DialogTitle as=\"h3\" class=\"text-lg font-medium leading-6 text-gray-900\">\n                上传职业头像\n              </DialogTitle>\n\n              <!-- 提示信息 -->\n              <div class=\"mt-2 p-4 bg-blue-50 rounded-lg\">\n                <div class=\"flex\">\n                  <div class=\"flex-shrink-0\">\n                    <InformationCircleIcon class=\"h-5 w-5 text-blue-400\" />\n                  </div>\n                  <div class=\"ml-3\">\n                    <p class=\"text-sm text-blue-700\">\n                      一张专业的职业头像能让您的简历更加出众：\n                    </p>\n                    <ul class=\"mt-2 text-sm text-blue-600 list-disc list-inside\">\n                      <li>建议使用正面照，保持微笑</li>\n                      <li>着装整洁得体，背景简单</li>\n                      <li>光线充足，图片清晰</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"mt-4\">\n                <div class=\"flex flex-col items-center\">\n                  <!-- 裁剪区域 -->\n                  <div class=\"relative w-full h-64 mb-4 bg-gray-100 rounded-lg overflow-hidden\">\n                    <vue-cropper\n                      ref=\"cropperRef\"\n                      :src=\"imageUrl\"\n                      :aspect-ratio=\"1\"\n                      :view-mode=\"1\"\n                      :guide-lines=\"true\"\n                      :background=\"true\"\n                      :rotatable=\"false\"\n                      :zoomable=\"true\"\n                      :movable=\"true\"\n                      :auto-crop-area=\"0.8\"\n                      drag-mode=\"move\"\n                      preview=\".preview\"\n                    />\n                  </div>\n\n                  <!-- 预览区域 -->\n                  <div class=\"preview w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200 mb-4\"></div>\n\n                  <!-- 上传按钮 -->\n                  <label class=\"cursor-pointer inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\">\n                    <input\n                      type=\"file\"\n                      class=\"hidden\"\n                      accept=\"image/*\"\n                      @change=\"handleFileChange\"\n                    >\n                    选择图片\n                  </label>\n                </div>\n              </div>\n\n              <div class=\"mt-6 flex justify-end space-x-3\">\n                <button\n                  type=\"button\"\n                  class=\"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50\"\n                  @click=\"closeDialog\"\n                >\n                  取消\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700\"\n                  :disabled=\"!hasImage\"\n                  @click=\"handleCrop\"\n                >\n                  确认上传\n                </button>\n              </div>\n            </DialogPanel>\n          </TransitionChild>\n        </div>\n      </div>\n    </Dialog>\n  </TransitionRoot>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport VueCropper from 'vue-cropperjs'\nimport 'cropperjs/dist/cropper.css'\nimport {\n  Dialog,\n  DialogPanel,\n  DialogTitle,\n  TransitionChild,\n  TransitionRoot,\n} from '@headlessui/vue'\nimport { InformationCircleIcon } from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\n\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    required: true\n  }\n})\n\nconst emit = defineEmits(['update:modelValue', 'upload'])\n\nconst cropperRef = ref(null)\nconst imageUrl = ref('')\nconst hasImage = ref(false)\n\n// 处理文件选择\nconst handleFileChange = (event) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  // 验证文件类型\n  if (!file.type.startsWith('image/')) {\n    showToast('请选择图片文件', 'error')\n    return\n  }\n\n  // 验证文件大小（2MB）\n  const maxSize = 2 * 1024 * 1024\n  if (file.size > maxSize) {\n    showToast('图片大小不能超过 2MB', 'error')\n    return\n  }\n\n  // 创建预览\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    imageUrl.value = e.target.result\n    hasImage.value = true\n  }\n  reader.readAsDataURL(file)\n}\n\n// 处理裁剪\nconst handleCrop = async () => {\n  if (!cropperRef.value || !hasImage.value) return\n  \n  try {\n    // 获取裁剪后的图片 blob\n    const canvas = cropperRef.value.getCroppedCanvas({\n      width: 200,\n      height: 200,\n      imageSmoothingEnabled: true,\n      imageSmoothingQuality: 'high'\n    })\n\n    canvas.toBlob(async (blob) => {\n      // 创建文件对象\n      const file = new File([blob], 'profile_avatar.png', { type: 'image/png' })\n      \n      // 触发上传事件\n      await emit('upload', file)\n      \n      // 清理\n      clearImage()\n    }, 'image/png')\n  } catch (error) {\n    console.error('裁剪失败:', error)\n    showToast('图片处理失败，请重试', 'error')\n  }\n}\n\n// 关闭对话框\nconst closeDialog = () => {\n  emit('update:modelValue', false)\n  clearImage()\n}\n\n// 清理图片\nconst clearImage = () => {\n  imageUrl.value = ''\n  hasImage.value = false\n}\n\n// 监听对话框关闭\nwatch(() => props.modelValue, (newVal) => {\n  if (!newVal) {\n    clearImage()\n  }\n})\n</script>\n\n<style>\n.preview {\n  overflow: hidden;\n  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);\n}\n</style> "],"mappings":";;EAeWA,KAAK,EAAC;AAA+B;;EACnCA,KAAK,EAAC;AAA6D;;EAgB7DA,KAAK,EAAC;AAAgC;;EACpCA,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAAe;;EAgBzBA,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAA4B;;EAEhCA,KAAK,EAAC;AAAkE;;EAqBtEA,KAAK,EAAC;AAAgP;;EAY5PA,KAAK,EAAC;AAAiC;oBAtF1D;;uBACEC,YAAA,CA2GiBC,MAAA;IA3GDC,MAAM,EAAN,EAAM;IAAEC,IAAI,EAAEC,MAAA,CAAAC,UAAU;IAAEC,EAAE,EAAC;;IAD/CC,OAAA,EAAAC,QAAA,CAEI,MAyGS,CAzGTC,YAAA,CAyGSR,MAAA;MAzGDK,EAAE,EAAC,KAAK;MAACP,KAAK,EAAC,eAAe;MAAEW,OAAK,EAAET,MAAA,CAAAU;;MAFnDJ,OAAA,EAAAC,QAAA,CAGM,MAUkB,CAVlBC,YAAA,CAUkBR,MAAA;QAThBK,EAAE,EAAC,UAAU;QACbM,KAAK,EAAC,uBAAuB;QAC7B,YAAU,EAAC,WAAW;QACtB,UAAQ,EAAC,aAAa;QACtBC,KAAK,EAAC,sBAAsB;QAC5B,YAAU,EAAC,aAAa;QACxB,UAAQ,EAAC;;QAVjBN,OAAA,EAAAC,QAAA,CAYQ,MAAyCM,MAAA,QAAAA,MAAA,OAAzCC,mBAAA,CAAyC;UAApChB,KAAK,EAAC;QAA2B,2B;QAZ9CiB,CAAA;UAeMD,mBAAA,CA2FM,OA3FNE,UA2FM,GA1FJF,mBAAA,CAyFM,OAzFNG,UAyFM,GAxFJT,YAAA,CAuFkBR,MAAA;QAtFhBK,EAAE,EAAC,UAAU;QACbM,KAAK,EAAC,uBAAuB;QAC7B,YAAU,EAAC,oBAAoB;QAC/B,UAAQ,EAAC,uBAAuB;QAChCC,KAAK,EAAC,sBAAsB;QAC5B,YAAU,EAAC,uBAAuB;QAClC,UAAQ,EAAC;;QAxBrBN,OAAA,EAAAC,QAAA,CA0BY,MA6Ec,CA7EdC,YAAA,CA6EcR,MAAA;UA7EDF,KAAK,EAAC;QAAoH;UA1BnJQ,OAAA,EAAAC,QAAA,CA2Bc,MAEc,CAFdC,YAAA,CAEcR,MAAA;YAFDK,EAAE,EAAC,IAAI;YAACP,KAAK,EAAC;;YA3BzCQ,OAAA,EAAAC,QAAA,CA2BuF,MAEzEM,MAAA,QAAAA,MAAA,OA7BdK,gBAAA,CA2BuF,UAEzE,E;YA7BdH,CAAA;cA+BcI,mBAAA,UAAa,EACbL,mBAAA,CAgBM,OAhBNM,UAgBM,GAfJN,mBAAA,CAcM,OAdNO,UAcM,GAbJP,mBAAA,CAEM,OAFNQ,UAEM,GADJd,YAAA,CAAuDR,MAAA;YAAhCF,KAAK,EAAC;UAAuB,G,6BAEtDgB,mBAAA,CASM;YATDhB,KAAK,EAAC;UAAM,IACfgB,mBAAA,CAEI;YAFDhB,KAAK,EAAC;UAAuB,GAAC,wBAEjC,GACAgB,mBAAA,CAIK;YAJDhB,KAAK,EAAC;UAAkD,IAC1DgB,mBAAA,CAAqB,YAAjB,cAAY,GAChBA,mBAAA,CAAoB,YAAhB,aAAW,GACfA,mBAAA,CAAkB,YAAd,WAAS,E,4BAMrBA,mBAAA,CAkCM,OAlCNS,UAkCM,GAjCJT,mBAAA,CAgCM,OAhCNU,UAgCM,GA/BJL,mBAAA,UAAa,EACbL,mBAAA,CAeM,OAfNW,UAeM,GAdJjB,YAAA,CAaER,MAAA;YAZA0B,GAAG,EAAC,YAAY;YACfC,GAAG,EAAE3B,MAAA,CAAA4B,QAAQ;YACb,cAAY,EAAE,CAAC;YACf,WAAS,EAAE,CAAC;YACZ,aAAW,EAAE,IAAI;YACjBC,UAAU,EAAE,IAAI;YAChBC,SAAS,EAAE,KAAK;YAChBC,QAAQ,EAAE,IAAI;YACdC,OAAO,EAAE,IAAI;YACb,gBAAc,EAAE,GAAG;YACpB,WAAS,EAAC,MAAM;YAChBC,OAAO,EAAC;8CAIZd,mBAAA,UAAa,E,0BACbL,mBAAA,CAAgG;YAA3FhB,KAAK,EAAC;UAA8E,6BAEzFqB,mBAAA,UAAa,EACbL,mBAAA,CAQQ,SARRoB,UAQQ,GAPNpB,mBAAA,CAKC;YAJCqB,IAAI,EAAC,MAAM;YACXrC,KAAK,EAAC,QAAQ;YACdsC,MAAM,EAAC,SAAS;YACfC,QAAM,EAAErC,MAAA,CAAAsC;uEA/E/BpB,gBAAA,CAgFqB,QAEH,G,OAIJJ,mBAAA,CAgBM,OAhBNyB,WAgBM,GAfJzB,mBAAA,CAMS;YALPqB,IAAI,EAAC,QAAQ;YACbrC,KAAK,EAAC,8IAA8I;YACnJ0C,OAAK,EAAExC,MAAA,CAAAU;aACT,MAED,GACAI,mBAAA,CAOS;YANPqB,IAAI,EAAC,QAAQ;YACbrC,KAAK,EAAC,wJAAwJ;YAC7J2C,QAAQ,GAAGzC,MAAA,CAAA0C,QAAQ;YACnBF,OAAK,EAAExC,MAAA,CAAA2C;aACT,QAED,iBArGhBC,WAAA,E;UAAA7B,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}