{"ast":null,"code":"import { createElementVNode as _createElementVNode, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"fixed inset-0 overflow-y-auto\"\n};\nconst _hoisted_2 = {\n  class: \"flex min-h-full items-center justify-center p-4\"\n};\nconst _hoisted_3 = {\n  class: \"px-4 py-3 bg-primary-50 border-b border-primary-100\"\n};\nconst _hoisted_4 = {\n  class: \"flex items-start space-x-3\"\n};\nconst _hoisted_5 = {\n  class: \"p-4\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"flex flex-col items-center justify-center py-8\"\n};\nconst _hoisted_7 = {\n  class: \"w-full max-w-xs cursor-pointer\"\n};\nconst _hoisted_8 = {\n  class: \"flex flex-col items-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 transition-colors\"\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"space-y-4\"\n};\nconst _hoisted_10 = {\n  class: \"relative aspect-square rounded-lg overflow-hidden bg-gray-100\"\n};\nconst _hoisted_11 = {\n  class: \"flex items-center justify-between\"\n};\nconst _hoisted_12 = {\n  class: \"flex items-center space-x-3\"\n};\nconst _hoisted_13 = {\n  class: \"w-16 h-16 rounded-full overflow-hidden border-2 border-gray-200\"\n};\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"TransitionRoot\"], {\n    appear: \"\",\n    show: $props.modelValue,\n    as: \"template\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Dialog\"], {\n      as: \"div\",\n      class: \"relative z-50\",\n      onClose: $setup.closeDialog\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0\",\n        \"enter-to\": \"opacity-100\"\n      }, {\n        default: _withCtx(() => _cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n          class: \"fixed inset-0 bg-black/25\"\n        }, null, -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode($setup[\"TransitionChild\"], {\n        as: \"template\",\n        enter: \"duration-300 ease-out\",\n        \"enter-from\": \"opacity-0 scale-95\",\n        \"enter-to\": \"opacity-100 scale-100\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"DialogPanel\"], {\n          class: \"w-full max-w-sm transform overflow-hidden rounded-2xl bg-white shadow-xl transition-all\"\n        }, {\n          default: _withCtx(() => [_createCommentVNode(\" 头部提示 \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createVNode($setup[\"InformationCircleIcon\"], {\n            class: \"h-5 w-5 text-primary-500 mt-0.5\"\n          }), _cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n            class: \"flex-1\"\n          }, [_createElementVNode(\"p\", {\n            class: \"text-sm text-primary-700\"\n          }, \"上传一张专业的头像照片，让您的简历更加出众\")], -1 /* HOISTED */))])]), _createCommentVNode(\" 主要内容区 \"), _createElementVNode(\"div\", _hoisted_5, [!$setup.imageUrl ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createCommentVNode(\" 上传区域 \"), _createElementVNode(\"label\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createVNode($setup[\"PhotoIcon\"], {\n            class: \"w-12 h-12 text-gray-400\"\n          }), _cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n            class: \"mt-4 text-center\"\n          }, [_createElementVNode(\"p\", {\n            class: \"text-sm font-medium text-gray-900\"\n          }, \"点击选择照片\"), _createElementVNode(\"p\", {\n            class: \"mt-1 text-xs text-gray-500\"\n          }, \"或将照片拖放到此处\")], -1 /* HOISTED */)), _createElementVNode(\"input\", {\n            type: \"file\",\n            class: \"hidden\",\n            accept: \"image/*\",\n            onChange: $setup.handleFileChange\n          }, null, 32 /* NEED_HYDRATION */)])])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createCommentVNode(\" 裁剪区域 \"), _createElementVNode(\"div\", _hoisted_10, [_createVNode($setup[\"Cropper\"], {\n            ref: \"cropperRef\",\n            class: \"cropper\",\n            src: $setup.imageUrl,\n            \"stencil-props\": {\n              aspectRatio: 1,\n              previewClass: 'rounded-full'\n            },\n            \"default-size\": {\n              width: '80%',\n              height: '80%'\n            },\n            \"image-restriction\": \"stencil\",\n            \"default-boundaries\": {\n              width: '100%',\n              height: '100%'\n            },\n            \"default-position\": {\n              left: '50%',\n              top: '50%'\n            },\n            onChange: $setup.onCrop\n          }, null, 8 /* PROPS */, [\"src\"])]), _createCommentVNode(\" 预览和操作区 \"), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"div\", _hoisted_13, [$setup.previewUrl ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 0,\n            src: $setup.previewUrl,\n            class: \"w-full h-full object-cover\",\n            alt: \"预览\"\n          }, null, 8 /* PROPS */, _hoisted_14)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"text-sm text-gray-600 hover:text-primary-500\",\n            onClick: $setup.handleFileChange\n          }, \" 重新选择 \")]), _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700\",\n            disabled: !$setup.hasImage,\n            onClick: $setup.handleCrop\n          }, \" 确认使用 \", 8 /* PROPS */, _hoisted_15)])]))])]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })])])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"show\"]);\n}","map":{"version":3,"names":["class","key","_createBlock","$setup","appear","show","$props","modelValue","as","default","_withCtx","_createVNode","onClose","closeDialog","enter","_cache","_createElementVNode","_","_hoisted_1","_hoisted_2","_createCommentVNode","_hoisted_3","_hoisted_4","_hoisted_5","imageUrl","_createElementBlock","_hoisted_6","_hoisted_7","_hoisted_8","type","accept","onChange","handleFileChange","_hoisted_9","_hoisted_10","ref","src","width","height","left","top","onCrop","_hoisted_11","_hoisted_12","_hoisted_13","previewUrl","alt","_hoisted_14","onClick","disabled","hasImage","handleCrop","_hoisted_15"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/components/ProfileAvatarCropper.vue"],"sourcesContent":["<template>\n  <TransitionRoot appear :show=\"modelValue\" as=\"template\">\n    <Dialog as=\"div\" class=\"relative z-50\" @close=\"closeDialog\">\n      <TransitionChild as=\"template\" enter=\"duration-300 ease-out\" enter-from=\"opacity-0\" enter-to=\"opacity-100\">\n        <div class=\"fixed inset-0 bg-black/25\" />\n      </TransitionChild>\n\n      <div class=\"fixed inset-0 overflow-y-auto\">\n        <div class=\"flex min-h-full items-center justify-center p-4\">\n          <TransitionChild\n            as=\"template\"\n            enter=\"duration-300 ease-out\"\n            enter-from=\"opacity-0 scale-95\"\n            enter-to=\"opacity-100 scale-100\"\n          >\n            <DialogPanel class=\"w-full max-w-sm transform overflow-hidden rounded-2xl bg-white shadow-xl transition-all\">\n              <!-- 头部提示 -->\n              <div class=\"px-4 py-3 bg-primary-50 border-b border-primary-100\">\n                <div class=\"flex items-start space-x-3\">\n                  <InformationCircleIcon class=\"h-5 w-5 text-primary-500 mt-0.5\" />\n                  <div class=\"flex-1\">\n                    <p class=\"text-sm text-primary-700\">上传一张专业的头像照片，让您的简历更加出众</p>\n                  </div>\n                </div>\n              </div>\n\n              <!-- 主要内容区 -->\n              <div class=\"p-4\">\n                <div v-if=\"!imageUrl\" class=\"flex flex-col items-center justify-center py-8\">\n                  <!-- 上传区域 -->\n                  <label class=\"w-full max-w-xs cursor-pointer\">\n                    <div class=\"flex flex-col items-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 transition-colors\">\n                      <PhotoIcon class=\"w-12 h-12 text-gray-400\" />\n                      <div class=\"mt-4 text-center\">\n                        <p class=\"text-sm font-medium text-gray-900\">点击选择照片</p>\n                        <p class=\"mt-1 text-xs text-gray-500\">或将照片拖放到此处</p>\n                      </div>\n                      <input type=\"file\" class=\"hidden\" accept=\"image/*\" @change=\"handleFileChange\">\n                    </div>\n                  </label>\n                </div>\n\n                <div v-else class=\"space-y-4\">\n                  <!-- 裁剪区域 -->\n                  <div class=\"relative aspect-square rounded-lg overflow-hidden bg-gray-100\">\n                    <Cropper\n                      ref=\"cropperRef\"\n                      class=\"cropper\"\n                      :src=\"imageUrl\"\n                      :stencil-props=\"{\n                        aspectRatio: 1,\n                        previewClass: 'rounded-full'\n                      }\"\n                      :default-size=\"{ width: '80%', height: '80%' }\"\n                      image-restriction=\"stencil\"\n                      :default-boundaries=\"{ width: '100%', height: '100%' }\"\n                      :default-position=\"{ left: '50%', top: '50%' }\"\n                      @change=\"onCrop\"\n                    />\n                  </div>\n\n                  <!-- 预览和操作区 -->\n                  <div class=\"flex items-center justify-between\">\n                    <div class=\"flex items-center space-x-3\">\n                      <div class=\"w-16 h-16 rounded-full overflow-hidden border-2 border-gray-200\">\n                        <img v-if=\"previewUrl\" :src=\"previewUrl\" class=\"w-full h-full object-cover\" alt=\"预览\" />\n                      </div>\n                      <button\n                        type=\"button\"\n                        class=\"text-sm text-gray-600 hover:text-primary-500\"\n                        @click=\"handleFileChange\"\n                      >\n                        重新选择\n                      </button>\n                    </div>\n                    <button\n                      type=\"button\"\n                      class=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700\"\n                      :disabled=\"!hasImage\"\n                      @click=\"handleCrop\"\n                    >\n                      确认使用\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </DialogPanel>\n          </TransitionChild>\n        </div>\n      </div>\n    </Dialog>\n  </TransitionRoot>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { Cropper } from 'vue-advanced-cropper'\nimport 'vue-advanced-cropper/dist/style.css'\nimport { Dialog, DialogPanel, TransitionChild, TransitionRoot } from '@headlessui/vue'\nimport { InformationCircleIcon, PhotoIcon } from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\n\nconst props = defineProps({\n  modelValue: Boolean\n})\n\nconst emit = defineEmits(['update:modelValue', 'upload'])\n\nconst cropperRef = ref(null)\nconst imageUrl = ref('')\nconst previewUrl = ref('')\nconst hasImage = ref(false)\n\n// 处理文件选择\nconst handleFileChange = (event) => {\n  const file = event?.target?.files?.[0]\n  if (!file) return\n\n  if (!file.type.startsWith('image/')) {\n    showToast('请选择图片文件', 'error')\n    return\n  }\n\n  const maxSize = 2 * 1024 * 1024\n  if (file.size > maxSize) {\n    showToast('图片大小不能超过 2MB', 'error')\n    return\n  }\n\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    imageUrl.value = e.target.result\n    hasImage.value = true\n  }\n  reader.readAsDataURL(file)\n}\n\n// 监听裁剪变化\nconst onCrop = ({ coordinates, canvas }) => {\n  previewUrl.value = canvas.toDataURL()\n}\n\n// 处理裁剪\nconst handleCrop = async () => {\n  if (!cropperRef.value || !hasImage.value) return\n  \n  try {\n    const { canvas } = cropperRef.value.getResult()\n    canvas.toBlob(async (blob) => {\n      const file = new File([blob], 'profile_avatar.png', { type: 'image/png' })\n      await emit('upload', file)\n      clearImage()\n    }, 'image/png', 0.9)\n  } catch (error) {\n    console.error('裁剪失败:', error)\n    showToast('图片处理失败，请重试', 'error')\n  }\n}\n\nconst closeDialog = () => {\n  emit('update:modelValue', false)\n  clearImage()\n}\n\nconst clearImage = () => {\n  imageUrl.value = ''\n  previewUrl.value = ''\n  hasImage.value = false\n}\n\nwatch(() => props.modelValue, (newVal) => {\n  if (!newVal) clearImage()\n})\n</script>\n\n<style>\n.cropper {\n  height: 100%;\n  background: #f3f4f6;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}