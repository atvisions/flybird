{"ast":null,"code":"import { ref, computed, nextTick, watch, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport defaultAvatarImage from '@/assets/images/default-avatar.png';\nimport { useStore } from 'vuex';\nimport { MEDIA_URL } from '@/config';\nimport { showToast } from '@/components/ToastMessage';\nimport { PencilIcon, PhoneIcon, EnvelopeIcon, MapPinIcon, BriefcaseIcon, ClockIcon, CurrencyYenIcon, DocumentTextIcon, CameraIcon, UserIcon, CalendarIcon, ChevronDownIcon, ChevronUpIcon, CakeIcon, PencilSquareIcon } from '@heroicons/vue/24/outline';\nimport profile from '@/api/profile';\nimport { eventBus } from '@/utils/eventBus';\nimport { Dialog, DialogPanel, DialogTitle, TransitionChild, TransitionRoot } from '@headlessui/vue';\nimport AvatarUploadDialog from '../dialogs/AvatarUploadDialog.vue';\n\n// 1. 首先声明 props\n\nexport default {\n  __name: 'BasicInfo',\n  props: {\n    resumeData: {\n      type: Object,\n      default: () => ({})\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    bioExpanded: {\n      type: Boolean,\n      default: false\n    },\n    showBioExpandButton: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update', 'edit', 'toggleBioExpand'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n\n    // 2. 声明 emits\n    const emit = __emit;\n\n    // 3. 导入和初始化其他变量\n    const store = useStore();\n    const loading = ref(true);\n    const basicInfo = ref({});\n\n    // 4. 计算属性\n    const formatBasicInfo = computed(() => {\n      // 优先使用父组件传入的 resumeData\n      const info = props.resumeData || {};\n      return {\n        name: info.name || info.username || '未填写',\n        // 添加 username 作为备选\n        gender: formatGender(info.gender),\n        phone: info.phone || '未填写',\n        email: info.email || '未填写',\n        location: info.location || '未填写',\n        age: calculateAge(info.birth_date) || '未填写',\n        personal_summary: info.personal_summary || '未填写'\n      };\n    });\n    const userAvatar = computed(() => {\n      const avatar = props.resumeData?.avatar;\n      if (!avatar) return defaultAvatarImage;\n      return avatar.startsWith('http') || avatar.startsWith('data:') ? avatar : `${MEDIA_URL}${avatar}`;\n    });\n    const currentGender = computed(() => {\n      return props.resumeData?.gender;\n    });\n\n    // 5. 监听器\n    watch(() => props.resumeData, newVal => {\n      if (newVal && Object.keys(newVal).length > 0) {\n        loading.value = false;\n      }\n    }, {\n      immediate: true\n    });\n\n    // 6. 生命周期钩子\n    onMounted(async () => {\n      try {\n        loading.value = true;\n        // 不需要在这里获取数据，因为父组件会处理\n      } catch (error) {\n        console.error('初始化失败:', error);\n      } finally {\n        loading.value = false;\n      }\n    });\n    const __returned__ = {\n      props,\n      emit,\n      store,\n      loading,\n      basicInfo,\n      formatBasicInfo,\n      userAvatar,\n      currentGender,\n      ref,\n      computed,\n      nextTick,\n      watch,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get defaultAvatarImage() {\n        return defaultAvatarImage;\n      },\n      get useStore() {\n        return useStore;\n      },\n      get MEDIA_URL() {\n        return MEDIA_URL;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get PencilIcon() {\n        return PencilIcon;\n      },\n      get PhoneIcon() {\n        return PhoneIcon;\n      },\n      get EnvelopeIcon() {\n        return EnvelopeIcon;\n      },\n      get MapPinIcon() {\n        return MapPinIcon;\n      },\n      get BriefcaseIcon() {\n        return BriefcaseIcon;\n      },\n      get ClockIcon() {\n        return ClockIcon;\n      },\n      get CurrencyYenIcon() {\n        return CurrencyYenIcon;\n      },\n      get DocumentTextIcon() {\n        return DocumentTextIcon;\n      },\n      get CameraIcon() {\n        return CameraIcon;\n      },\n      get UserIcon() {\n        return UserIcon;\n      },\n      get CalendarIcon() {\n        return CalendarIcon;\n      },\n      get ChevronDownIcon() {\n        return ChevronDownIcon;\n      },\n      get ChevronUpIcon() {\n        return ChevronUpIcon;\n      },\n      get CakeIcon() {\n        return CakeIcon;\n      },\n      get PencilSquareIcon() {\n        return PencilSquareIcon;\n      },\n      get profile() {\n        return profile;\n      },\n      get eventBus() {\n        return eventBus;\n      },\n      get Dialog() {\n        return Dialog;\n      },\n      get DialogPanel() {\n        return DialogPanel;\n      },\n      get DialogTitle() {\n        return DialogTitle;\n      },\n      get TransitionChild() {\n        return TransitionChild;\n      },\n      get TransitionRoot() {\n        return TransitionRoot;\n      },\n      AvatarUploadDialog\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","nextTick","watch","onMounted","ElMessage","defaultAvatarImage","useStore","MEDIA_URL","showToast","PencilIcon","PhoneIcon","EnvelopeIcon","MapPinIcon","BriefcaseIcon","ClockIcon","CurrencyYenIcon","DocumentTextIcon","CameraIcon","UserIcon","CalendarIcon","ChevronDownIcon","ChevronUpIcon","CakeIcon","PencilSquareIcon","profile","eventBus","Dialog","DialogPanel","DialogTitle","TransitionChild","TransitionRoot","AvatarUploadDialog","props","__props","emit","__emit","store","loading","basicInfo","formatBasicInfo","info","resumeData","name","username","gender","formatGender","phone","email","location","age","calculateAge","birth_date","personal_summary","userAvatar","avatar","startsWith","currentGender","newVal","Object","keys","length","value","immediate","error","console"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/user/MyProfile/components/BasicInfo.vue"],"sourcesContent":["<!-- src/views/user/MyProfile/components/BasicInfo.vue -->\n<template>\n  <div class=\"bg-white rounded-lg shadow\">\n    <!-- 个人信息卡片 -->\n    <div class=\"px-6 py-6\">\n      <!-- 标题 -->\n      <div class=\"flex items-center mb-6\">\n        <UserIcon class=\"w-5 h-5 text-gray-900 mr-2\" />\n        <h2 class=\"text-base font-medium text-gray-900\">基本信息</h2>\n      </div>\n\n      <!-- 头像和基本信息 -->\n      <div class=\"flex items-start space-x-6 mb-8\">\n        <!-- 头像部分 -->\n        <div class=\"relative group\">\n          <img \n            :src=\"userAvatar\" \n            class=\"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg\"\n            alt=\"用户头像\"\n            @error=\"handleImageError\"\n          />\n          <div \n            @click=\"triggerUpload\"\n            class=\"absolute inset-0 flex items-center justify-center rounded-full bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 cursor-pointer transition-opacity duration-200\"\n          >\n            <CameraIcon class=\"w-8 h-8 text-white\" />\n          </div>\n          <!-- 性别标识 -->\n          <div class=\"absolute bottom-0 right-0 bg-white rounded-full p-1.5 shadow\">\n            <!-- 男性图标 -->\n            <svg \n              v-if=\"currentGender === 'male'\" \n              class=\"w-5 h-5 text-blue-500\" \n              viewBox=\"0 0 24 24\" \n              fill=\"none\" \n              stroke=\"currentColor\"\n            >\n              <circle cx=\"12\" cy=\"12\" r=\"5\" stroke-width=\"2\"/>\n              <path d=\"M16 8L21 3\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              <path d=\"M21 3H16M21 3V8\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n            </svg>\n            <!-- 女性图标 -->\n            <svg \n              v-else-if=\"currentGender === 'female'\" \n              class=\"w-5 h-5 text-pink-500\" \n              viewBox=\"0 0 24 24\" \n              fill=\"none\" \n              stroke=\"currentColor\"\n            >\n              <circle cx=\"12\" cy=\"10\" r=\"5\" stroke-width=\"2\"/>\n              <path d=\"M12 15V21\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              <path d=\"M9 18H15\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n            </svg>\n          </div>\n        </div>\n\n        <!-- 名字和简介 -->\n        <div class=\"flex-1\">\n          <div class=\"flex items-center justify-between\">\n            <h1 class=\"text-xl font-bold text-gray-900\">{{ formatBasicInfo.name }}</h1>\n            <button\n              @click=\"handleEdit\"\n              class=\"p-1.5 rounded-full hover:bg-gray-100 transition-colors\"\n            >\n              <PencilSquareIcon class=\"w-4 h-4 text-gray-500\" />\n            </button>\n          </div>\n          <p class=\"mt-2 text-sm text-gray-600\">{{ formatBasicInfo.personal_summary || '这个人很懒，还没有填写个人简介' }}</p>\n        </div>\n      </div>\n\n      <!-- 基本信息部分 -->\n      <div>\n        <!-- 信息网格 -->\n        <div class=\"grid grid-cols-2 gap-x-12 gap-y-4 border-t border-gray-100 pt-6\">\n          <!-- 联系方式 -->\n          <div>\n            <h2 class=\"text-xs font-medium text-gray-500 mb-3\">联系方式</h2>\n            <div class=\"flex items-center space-x-2\">\n              <PhoneIcon class=\"w-4 h-4 text-gray-400\" />\n              <span class=\"text-sm text-gray-900\">{{ formatBasicInfo.phone }}</span>\n            </div>\n            <div class=\"flex items-center space-x-2 mt-2\">\n              <EnvelopeIcon class=\"w-4 h-4 text-gray-400\" />\n              <span class=\"text-sm text-gray-900\">{{ formatBasicInfo.email }}</span>\n            </div>\n          </div>\n\n          <!-- 基本资料 -->\n          <div>\n            <h2 class=\"text-xs font-medium text-gray-500 mb-3\">基本资料</h2>\n            <div class=\"flex items-center space-x-2\">\n              <MapPinIcon class=\"w-4 h-4 text-gray-400\" />\n              <span class=\"text-sm text-gray-900\">{{ formatBasicInfo.location }}</span>\n            </div>\n            <div class=\"flex items-center space-x-2 mt-2\">\n              <CakeIcon class=\"w-4 h-4 text-gray-400\" />\n              <span class=\"text-sm text-gray-900\">{{ formatBasicInfo.age }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 添加头像上传弹窗 -->\n  <AvatarUploadDialog\n    v-model=\"showAvatarUpload\"\n    :loading=\"loading\"\n    @upload=\"handleAvatarUpload\"\n  />\n</template>\n\n<script setup>\nimport { ref, computed, nextTick, watch, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport defaultAvatarImage from '@/assets/images/default-avatar.png'\nimport { useStore } from 'vuex'\nimport { MEDIA_URL } from '@/config'\nimport { showToast } from '@/components/ToastMessage'\nimport {\n  PencilIcon,\n  PhoneIcon,\n  EnvelopeIcon,\n  MapPinIcon,\n  BriefcaseIcon,\n  ClockIcon,\n  CurrencyYenIcon,\n  DocumentTextIcon,\n  CameraIcon,\n  UserIcon,\n  CalendarIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  CakeIcon,\n  PencilSquareIcon\n} from '@heroicons/vue/24/outline'\nimport profile from '@/api/profile'\nimport { eventBus } from '@/utils/eventBus'\nimport {\n  Dialog,\n  DialogPanel,\n  DialogTitle,\n  TransitionChild,\n  TransitionRoot\n} from '@headlessui/vue'\nimport AvatarUploadDialog from '../dialogs/AvatarUploadDialog.vue'\n\n// 1. 首先声明 props\nconst props = defineProps({\n  resumeData: {\n    type: Object,\n    default: () => ({})\n  },\n  loading: {\n    type: Boolean,\n    default: false\n  },\n  bioExpanded: {\n    type: Boolean,\n    default: false\n  },\n  showBioExpandButton: {\n    type: Boolean,\n    default: false\n  }\n})\n\n// 2. 声明 emits\nconst emit = defineEmits(['update', 'edit', 'toggleBioExpand'])\n\n// 3. 导入和初始化其他变量\nconst store = useStore()\nconst loading = ref(true)\nconst basicInfo = ref({})\n\n// 4. 计算属性\nconst formatBasicInfo = computed(() => {\n  // 优先使用父组件传入的 resumeData\n  const info = props.resumeData || {}\n  \n  return {\n    name: info.name || info.username || '未填写',  // 添加 username 作为备选\n    gender: formatGender(info.gender),\n    phone: info.phone || '未填写',\n    email: info.email || '未填写',\n    location: info.location || '未填写',\n    age: calculateAge(info.birth_date) || '未填写',\n    personal_summary: info.personal_summary || '未填写'\n  }\n})\n\nconst userAvatar = computed(() => {\n  const avatar = props.resumeData?.avatar\n  if (!avatar) return defaultAvatarImage\n  return avatar.startsWith('http') || avatar.startsWith('data:') ? avatar : `${MEDIA_URL}${avatar}`\n})\n\nconst currentGender = computed(() => {\n  return props.resumeData?.gender\n})\n\n// 5. 监听器\nwatch(\n  () => props.resumeData,\n  (newVal) => {\n    if (newVal && Object.keys(newVal).length > 0) {\n      loading.value = false\n    }\n  },\n  { immediate: true }\n)\n\n// 6. 生命周期钩子\nonMounted(async () => {\n  try {\n    loading.value = true\n    // 不需要在这里获取数据，因为父组件会处理\n  } catch (error) {\n    console.error('初始化失败:', error)\n  } finally {\n    loading.value = false\n  }\n})\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}