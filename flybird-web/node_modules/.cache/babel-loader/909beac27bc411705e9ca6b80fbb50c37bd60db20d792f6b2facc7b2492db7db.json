{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"canvas-container\"\n};\nconst _hoisted_2 = {\n  class: \"canvas-wrapper\"\n};\nconst _hoisted_3 = {\n  class: \"component-item\"\n};\nconst _hoisted_4 = {\n  class: \"component-actions\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"placeholder\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  const _component_v_card_title = _resolveComponent(\"v-card-title\");\n  const _component_v_card_text = _resolveComponent(\"v-card-text\");\n  const _component_v_spacer = _resolveComponent(\"v-spacer\");\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_v_dialog = _resolveComponent(\"v-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n    class: \"canvas-content\",\n    style: _normalizeStyle({\n      transform: `scale(${$props.scale})`\n    })\n  }, [_createVNode($setup[\"draggable\"], {\n    modelValue: $setup.components,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.components = $event),\n    group: {\n      name: 'resume',\n      pull: false,\n      put: true\n    },\n    \"item-key\": \"id\",\n    class: _normalizeClass([\"canvas-drop-area\", {\n      'drag-over': $setup.isDragOver\n    }]),\n    onChange: $setup.handleChange,\n    onDragenter: $setup.handleDragEnter,\n    onDragleave: $setup.handleDragLeave,\n    onDragover: $setup.handleDragOver\n  }, {\n    item: _withCtx(({\n      element\n    }) => [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_v_btn, {\n      icon: \"mdi-pencil\",\n      size: \"small\",\n      color: \"primary\",\n      variant: \"text\",\n      onClick: $event => $setup.openEditor(element)\n    }, null, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_v_btn, {\n      icon: \"mdi-delete\",\n      size: \"small\",\n      color: \"error\",\n      variant: \"text\",\n      onClick: $event => $setup.removeComponent(element)\n    }, null, 8 /* PROPS */, [\"onClick\"])]), (_openBlock(), _createBlock(_resolveDynamicComponent($setup.getComponentDisplay(element)), {\n      data: element.data\n    }, null, 8 /* PROPS */, [\"data\"]))])]),\n    header: _withCtx(() => [$setup.components.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_v_icon, {\n      size: \"32\",\n      class: \"mb-2\"\n    }, {\n      default: _withCtx(() => _cache[4] || (_cache[4] = [_createTextVNode(\"mdi-plus\")])),\n      _: 1 /* STABLE */\n    }), _cache[5] || (_cache[5] = _createElementVNode(\"span\", null, \"拖拽组件到此处\", -1 /* HOISTED */))])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"class\"])], 4 /* STYLE */)]), _createCommentVNode(\" 编辑对话框 \"), _createVNode(_component_v_dialog, {\n    modelValue: $setup.showEditor,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.showEditor = $event),\n    width: \"500\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_card, null, {\n      default: _withCtx(() => [_createVNode(_component_v_card_title, {\n        class: \"text-h6\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\" 编辑\" + _toDisplayString($setup.currentComponent?.name || '组件'), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_card_text, null, {\n        default: _withCtx(() => [$setup.currentComponent ? (_openBlock(), _createBlock(_resolveDynamicComponent($setup.getComponentEditor($setup.currentComponent)), {\n          key: 0,\n          modelValue: $setup.currentComponent.data,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.currentComponent.data = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])) : _createCommentVNode(\"v-if\", true)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_card_actions, null, {\n        default: _withCtx(() => [_createVNode(_component_v_spacer), _createVNode(_component_v_btn, {\n          color: \"primary\",\n          variant: \"text\",\n          onClick: $setup.saveComponent\n        }, {\n          default: _withCtx(() => _cache[6] || (_cache[6] = [_createTextVNode(\" 保存 \")])),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_btn, {\n          color: \"grey\",\n          variant: \"text\",\n          onClick: _cache[2] || (_cache[2] = $event => $setup.showEditor = false)\n        }, {\n          default: _withCtx(() => _cache[7] || (_cache[7] = [_createTextVNode(\" 取消 \")])),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","style","_normalizeStyle","transform","$props","scale","_createVNode","$setup","modelValue","components","_cache","$event","group","name","pull","put","_normalizeClass","isDragOver","onChange","handleChange","onDragenter","handleDragEnter","onDragleave","handleDragLeave","onDragover","handleDragOver","item","_withCtx","element","_hoisted_3","_hoisted_4","_component_v_btn","icon","size","color","variant","onClick","openEditor","removeComponent","_createBlock","_resolveDynamicComponent","getComponentDisplay","data","header","length","_hoisted_5","_component_v_icon","default","_createTextVNode","_","_createCommentVNode","_component_v_dialog","showEditor","width","_component_v_card","_component_v_card_title","_toDisplayString","currentComponent","_component_v_card_text","getComponentEditor","_component_v_card_actions","_component_v_spacer","saveComponent"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/Canvas.vue"],"sourcesContent":["<template>\n  <div class=\"canvas-container\">\n    <div class=\"canvas-wrapper\">\n      <div class=\"canvas-content\" :style=\"{ transform: `scale(${scale})` }\">\n        <draggable\n          v-model=\"components\"\n          :group=\"{ name: 'resume', pull: false, put: true }\"\n          item-key=\"id\"\n          class=\"canvas-drop-area\"\n          :class=\"{ 'drag-over': isDragOver }\"\n          @change=\"handleChange\"\n          @dragenter=\"handleDragEnter\"\n          @dragleave=\"handleDragLeave\"\n          @dragover=\"handleDragOver\"\n        >\n          <template #item=\"{ element }\">\n            <div class=\"component-item\">\n              <div class=\"component-actions\">\n                <v-btn\n                  icon=\"mdi-pencil\"\n                  size=\"small\"\n                  color=\"primary\"\n                  variant=\"text\"\n                  @click=\"openEditor(element)\"\n                ></v-btn>\n                <v-btn\n                  icon=\"mdi-delete\"\n                  size=\"small\"\n                  color=\"error\"\n                  variant=\"text\"\n                  @click=\"removeComponent(element)\"\n                ></v-btn>\n              </div>\n              <component\n                :is=\"getComponentDisplay(element)\"\n                :data=\"element.data\"\n              ></component>\n            </div>\n          </template>\n\n          <template #header>\n            <div v-if=\"components.length === 0\" class=\"placeholder\">\n              <v-icon size=\"32\" class=\"mb-2\">mdi-plus</v-icon>\n              <span>拖拽组件到此处</span>\n            </div>\n          </template>\n        </draggable>\n      </div>\n    </div>\n\n    <!-- 编辑对话框 -->\n    <v-dialog v-model=\"showEditor\" width=\"500\">\n      <v-card>\n        <v-card-title class=\"text-h6\">\n          编辑{{ currentComponent?.name || '组件' }}\n        </v-card-title>\n        <v-card-text>\n          <component\n            v-if=\"currentComponent\"\n            :is=\"getComponentEditor(currentComponent)\"\n            v-model=\"currentComponent.data\"\n          ></component>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" variant=\"text\" @click=\"saveComponent\">\n            保存\n          </v-btn>\n          <v-btn color=\"grey\" variant=\"text\" @click=\"showEditor = false\">\n            取消\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport draggable from 'vuedraggable'\nimport BasicInfoDisplay from './BasicInfoDisplay.vue'\nimport BasicInfo from './BasicInfo.vue'\n\nconst props = defineProps({\n  scale: {\n    type: Number,\n    default: 1\n  }\n})\n\nconst components = ref([])\nconst isDragOver = ref(false)\nconst showEditor = ref(false)\nconst currentComponent = ref(null)\nconst editingIndex = ref(-1)\n\nconst handleDragEnter = (event) => {\n  event.preventDefault()\n  isDragOver.value = true\n}\n\nconst handleDragLeave = (event) => {\n  event.preventDefault()\n  isDragOver.value = false\n}\n\nconst handleDragOver = (event) => {\n  event.preventDefault()\n}\n\nconst handleChange = (event) => {\n  if (event.added) {\n    const component = JSON.parse(event.added.element)\n    const newComponent = {\n      id: Date.now(),\n      type: component.type,\n      name: component.name,\n      config: component.config,\n      data: {}\n    }\n    components.value.splice(event.added.newIndex, 1, newComponent)\n    // 添加新组件后立即打开编辑器\n    openEditor(newComponent, event.added.newIndex)\n  }\n}\n\nconst getComponentDisplay = (component) => {\n  const componentMap = {\n    'contact': BasicInfoDisplay\n  }\n  return componentMap[component.type]\n}\n\nconst getComponentEditor = (component) => {\n  const componentMap = {\n    'contact': BasicInfo\n  }\n  return componentMap[component.type]\n}\n\nconst openEditor = (component, index) => {\n  currentComponent.value = { ...component }\n  editingIndex.value = index !== undefined ? index : components.value.findIndex(c => c.id === component.id)\n  showEditor.value = true\n}\n\nconst saveComponent = () => {\n  if (editingIndex.value > -1) {\n    components.value[editingIndex.value] = { ...currentComponent.value }\n  }\n  showEditor.value = false\n}\n\nconst removeComponent = (component) => {\n  const index = components.value.findIndex(c => c.id === component.id)\n  if (index > -1) {\n    components.value.splice(index, 1)\n  }\n}\n</script>\n\n<style scoped>\n.canvas-container {\n  flex: 1;\n  height: 100%;\n  overflow: auto;\n  background: #f5f7fa;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.canvas-wrapper {\n  padding: 40px;\n  min-height: 100%;\n  min-width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.canvas-content {\n  width: 595px;\n  height: 842px;\n  background: #ffffff;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  transform-origin: center center;\n  overflow: hidden;\n}\n\n.canvas-drop-area {\n  height: 100%;\n  padding: 24px;\n}\n\n.canvas-drop-area.drag-over {\n  background: #ecf5ff;\n  border: 2px dashed #409eff;\n}\n\n.placeholder {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n  font-size: 14px;\n}\n\n.component-item {\n  margin-bottom: 16px;\n  position: relative;\n}\n\n.component-item:last-child {\n  margin-bottom: 0;\n}\n\n.component-actions {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.3s;\n}\n\n.component-item:hover .component-actions {\n  opacity: 1;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}