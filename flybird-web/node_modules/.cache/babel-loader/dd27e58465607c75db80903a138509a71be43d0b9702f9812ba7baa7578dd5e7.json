{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport request from '@/utils/request';\nexport const user = {\n  // 获取用户信息\n  getUserInfo: () => {\n    return request.get('/api/v1/users/userInfo/');\n  },\n  // 更新用户信息\n  updateUserInfo: data => {\n    const formData = new FormData();\n    // 遍历对象的所有属性\n    Object.keys(data).forEach(key => {\n      if (data[key] !== null && data[key] !== undefined) {\n        // 如果是文件类型，直接添加\n        if (key === 'avatar' && data[key] instanceof File) {\n          formData.append('avatar', data[key]);\n        }\n        // 其他字段正常处理\n        else {\n          // 如果是用户名，使用专门的接口\n          if (key === 'username') {\n            return user.updateUsername({\n              username: data[key]\n            });\n          }\n          formData.append(key, data[key].toString());\n        }\n      }\n    });\n\n    // 打印 FormData 内容，用于调试\n    for (let pair of formData.entries()) {\n      console.log(pair[0] + ': ' + pair[1]);\n    }\n    return request.put('/api/v1/users/userInfo/', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  },\n  // 更新用户名\n  updateUsername: data => {\n    return request.post('/api/v1/users/account/username/', {\n      username: data.username\n    });\n  },\n  // 更换手机号\n  changePhone: data => {\n    return request.post('/api/v1/users/account/phone/', {\n      phone: data.phone,\n      code: data.code\n    });\n  },\n  // 修改密码\n  updatePassword: data => {\n    return request.post('/api/v1/users/account/password/', {\n      old_password: data.old_password,\n      new_password: data.new_password,\n      confirm_password: data.confirm_password\n    });\n  },\n  // 上传背景图\n  uploadBackground: file => {\n    const formData = new FormData();\n    formData.append('background', file);\n    return request.put('/api/v1/users/userInfo/', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  }\n};\nexport const updateNickname = nickname => {\n  return user.updateUsername({\n    username: nickname\n  });\n};\nexport default user;","map":{"version":3,"names":["request","user","getUserInfo","get","updateUserInfo","data","formData","FormData","Object","keys","forEach","key","undefined","File","append","updateUsername","username","toString","pair","entries","console","log","put","headers","post","changePhone","phone","code","updatePassword","old_password","new_password","confirm_password","uploadBackground","file","updateNickname","nickname"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/api/user.js"],"sourcesContent":["import request from '@/utils/request'\n\nexport const user = {\n  // 获取用户信息\n  getUserInfo: () => {\n    return request.get('/api/v1/users/userInfo/')\n  },\n\n  // 更新用户信息\n  updateUserInfo: (data) => {\n    const formData = new FormData()\n    // 遍历对象的所有属性\n    Object.keys(data).forEach(key => {\n      if (data[key] !== null && data[key] !== undefined) {\n        // 如果是文件类型，直接添加\n        if (key === 'avatar' && data[key] instanceof File) {\n          formData.append('avatar', data[key])\n        } \n        // 其他字段正常处理\n        else {\n          // 如果是用户名，使用专门的接口\n          if (key === 'username') {\n            return user.updateUsername({ username: data[key] })\n          }\n          formData.append(key, data[key].toString())\n        }\n      }\n    })\n\n    // 打印 FormData 内容，用于调试\n    for (let pair of formData.entries()) {\n      console.log(pair[0] + ': ' + pair[1])\n    }\n\n    return request.put('/api/v1/users/userInfo/', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  },\n\n  // 更新用户名\n  updateUsername: (data) => {\n    return request.post('/api/v1/users/account/username/', {\n      username: data.username\n    })\n  },\n\n  // 更换手机号\n  changePhone: (data) => {\n    return request.post('/api/v1/users/account/phone/', {\n      phone: data.phone,\n      code: data.code\n    })\n  },\n\n  // 修改密码\n  updatePassword: (data) => {\n    return request.post('/api/v1/users/account/password/', {\n      old_password: data.old_password,\n      new_password: data.new_password,\n      confirm_password: data.confirm_password\n    })\n  },\n\n  // 上传背景图\n  uploadBackground: (file) => {\n    const formData = new FormData()\n    formData.append('background', file)\n    return request.put('/api/v1/users/userInfo/', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  },\n}\n\nexport const updateNickname = (nickname) => {\n  return user.updateUsername({ username: nickname })\n}\n\nexport default user"],"mappings":";;AAAA,OAAOA,OAAO,MAAM,iBAAiB;AAErC,OAAO,MAAMC,IAAI,GAAG;EAClB;EACAC,WAAW,EAAEA,CAAA,KAAM;IACjB,OAAOF,OAAO,CAACG,GAAG,CAAC,yBAAyB,CAAC;EAC/C,CAAC;EAED;EACAC,cAAc,EAAGC,IAAI,IAAK;IACxB,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC/B;IACAC,MAAM,CAACC,IAAI,CAACJ,IAAI,CAAC,CAACK,OAAO,CAACC,GAAG,IAAI;MAC/B,IAAIN,IAAI,CAACM,GAAG,CAAC,KAAK,IAAI,IAAIN,IAAI,CAACM,GAAG,CAAC,KAAKC,SAAS,EAAE;QACjD;QACA,IAAID,GAAG,KAAK,QAAQ,IAAIN,IAAI,CAACM,GAAG,CAAC,YAAYE,IAAI,EAAE;UACjDP,QAAQ,CAACQ,MAAM,CAAC,QAAQ,EAAET,IAAI,CAACM,GAAG,CAAC,CAAC;QACtC;QACA;QAAA,KACK;UACH;UACA,IAAIA,GAAG,KAAK,UAAU,EAAE;YACtB,OAAOV,IAAI,CAACc,cAAc,CAAC;cAAEC,QAAQ,EAAEX,IAAI,CAACM,GAAG;YAAE,CAAC,CAAC;UACrD;UACAL,QAAQ,CAACQ,MAAM,CAACH,GAAG,EAAEN,IAAI,CAACM,GAAG,CAAC,CAACM,QAAQ,CAAC,CAAC,CAAC;QAC5C;MACF;IACF,CAAC,CAAC;;IAEF;IACA,KAAK,IAAIC,IAAI,IAAIZ,QAAQ,CAACa,OAAO,CAAC,CAAC,EAAE;MACnCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,GAAGA,IAAI,CAAC,CAAC,CAAC,CAAC;IACvC;IAEA,OAAOlB,OAAO,CAACsB,GAAG,CAAC,yBAAyB,EAAEhB,QAAQ,EAAE;MACtDiB,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CAAC,CAAC;EACJ,CAAC;EAED;EACAR,cAAc,EAAGV,IAAI,IAAK;IACxB,OAAOL,OAAO,CAACwB,IAAI,CAAC,iCAAiC,EAAE;MACrDR,QAAQ,EAAEX,IAAI,CAACW;IACjB,CAAC,CAAC;EACJ,CAAC;EAED;EACAS,WAAW,EAAGpB,IAAI,IAAK;IACrB,OAAOL,OAAO,CAACwB,IAAI,CAAC,8BAA8B,EAAE;MAClDE,KAAK,EAAErB,IAAI,CAACqB,KAAK;MACjBC,IAAI,EAAEtB,IAAI,CAACsB;IACb,CAAC,CAAC;EACJ,CAAC;EAED;EACAC,cAAc,EAAGvB,IAAI,IAAK;IACxB,OAAOL,OAAO,CAACwB,IAAI,CAAC,iCAAiC,EAAE;MACrDK,YAAY,EAAExB,IAAI,CAACwB,YAAY;MAC/BC,YAAY,EAAEzB,IAAI,CAACyB,YAAY;MAC/BC,gBAAgB,EAAE1B,IAAI,CAAC0B;IACzB,CAAC,CAAC;EACJ,CAAC;EAED;EACAC,gBAAgB,EAAGC,IAAI,IAAK;IAC1B,MAAM3B,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC/BD,QAAQ,CAACQ,MAAM,CAAC,YAAY,EAAEmB,IAAI,CAAC;IACnC,OAAOjC,OAAO,CAACsB,GAAG,CAAC,yBAAyB,EAAEhB,QAAQ,EAAE;MACtDiB,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CAAC,CAAC;EACJ;AACF,CAAC;AAED,OAAO,MAAMW,cAAc,GAAIC,QAAQ,IAAK;EAC1C,OAAOlC,IAAI,CAACc,cAAc,CAAC;IAAEC,QAAQ,EAAEmB;EAAS,CAAC,CAAC;AACpD,CAAC;AAED,eAAelC,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}