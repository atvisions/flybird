{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { CalendarDaysIcon, StarIcon, TrophyIcon, CheckCircleIcon, ChevronDownIcon, SparklesIcon } from '@heroicons/vue/24/outline';\nimport { membership } from '@/api';\nimport { formatDate } from '@/utils/date';\n\n// 会员状态数据\n\nexport default {\n  __name: 'index',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const vipTypeText = ref('免费用户');\n    const vipExpireText = ref('开通会员享受更多权益');\n    const vipButtonText = ref('开通会员');\n\n    // 积分相关数据\n    const pointsInfo = ref({\n      balance: 0,\n      level: 1,\n      sign_in_days: 0,\n      total_earned: 0\n    });\n    const signInInfo = ref({\n      days: 0,\n      nextReward: null\n    });\n    const canSignIn = ref(true);\n    const loading = ref(false);\n    const currentFilter = ref('all');\n    const currentTab = ref('points');\n    const pointsRecords = ref([]);\n    const hasMore = ref(false);\n    const page = ref(1);\n    const expandedOrders = ref([]);\n\n    // 会员权益列表\n    const memberBenefits = [{\n      key: 'unlimited',\n      name: '无限使用',\n      desc: '无限制使用所有功能',\n      icon: SparklesIcon\n    }\n    // ... 其他权益配置\n    ];\n\n    // 积分筛选选项\n    const pointsFilters = [{\n      label: '全部',\n      value: 'all'\n    }, {\n      label: '获得',\n      value: 'earned'\n    }, {\n      label: '使用',\n      value: 'used'\n    }];\n\n    // tabs配置\n    const tabs = [{\n      key: 'points',\n      name: '积分规则'\n    }, {\n      key: 'privileges',\n      name: '等级权益'\n    }, {\n      key: 'orders',\n      name: '订单记录'\n    }];\n\n    // 积分规则\n    const pointRules = [{\n      action: '每日签到',\n      points: '+1~10',\n      description: '连续签到可获得更多积分奖励',\n      icon: CalendarDaysIcon,\n      bgColor: 'bg-blue-50',\n      iconColor: 'text-blue-500',\n      borderColor: 'border-blue-100',\n      textColor: 'text-blue-600'\n    }\n    // ... 其他规则配置\n    ];\n\n    // 计算属性\n    const filteredRecords = computed(() => {\n      if (currentFilter.value === 'all') return pointsRecords.value;\n      return pointsRecords.value.filter(record => currentFilter.value === 'earned' ? record.points > 0 : record.points < 0);\n    });\n\n    // 方法\n    const handleVipButton = () => {\n      // 处理会员按钮点击\n    };\n    const handleSignIn = async () => {\n      if (!canSignIn.value) return;\n      try {\n        const response = await membership.signIn();\n        if (response?.data?.code === 200) {\n          ElMessage.success('签到成功');\n          canSignIn.value = false;\n          await fetchPointsInfo();\n        }\n      } catch (error) {\n        console.error('签到失败:', error);\n        ElMessage.error('签到失败，请稍后重试');\n      }\n    };\n    const fetchPointsInfo = async () => {\n      try {\n        const response = await membership.getPointsInfo();\n        if (response?.data?.code === 200) {\n          pointsInfo.value = response.data.data;\n        }\n      } catch (error) {\n        console.error('获取积分信息失败:', error);\n      }\n    };\n    const fetchPointsRecords = async () => {\n      if (loading.value) return;\n      loading.value = true;\n      try {\n        const response = await membership.getPointsRecords({\n          page: page.value\n        });\n        if (response?.data?.code === 200) {\n          const {\n            records,\n            has_more\n          } = response.data.data;\n          if (page.value === 1) {\n            pointsRecords.value = records;\n          } else {\n            pointsRecords.value.push(...records);\n          }\n          hasMore.value = has_more;\n        }\n      } catch (error) {\n        console.error('获取积分记录失败:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const loadMore = () => {\n      page.value++;\n      fetchPointsRecords();\n    };\n    const getLevelTitle = level => {\n      const titles = ['初级用户', '普通用户', '高级用户', '资深用户', '专家用户'];\n      return titles[level - 1] || titles[0];\n    };\n    const getLevelRange = level => {\n      const ranges = {\n        1: '0-100积分',\n        2: '101-500积分',\n        3: '501-2000积分',\n        4: '2001-10000积分',\n        5: '10000积分以上'\n      };\n      return ranges[level];\n    };\n    const getLevelProgress = (level, balance) => {\n      const thresholds = [0, 100, 500, 2000, 10000];\n      const currentThreshold = thresholds[level - 1] || 0;\n      const nextThreshold = thresholds[level] || thresholds[thresholds.length - 1];\n      return Math.min((balance - currentThreshold) / (nextThreshold - currentThreshold) * 100, 100);\n    };\n    const getNextLevelPoints = (level, balance) => {\n      const thresholds = [0, 100, 500, 2000, 10000];\n      if (level >= thresholds.length) return 0;\n      return Math.max(thresholds[level] - balance, 0);\n    };\n    const toggleOrderDetail = orderNo => {\n      const index = expandedOrders.value.indexOf(orderNo);\n      if (index > -1) {\n        expandedOrders.value.splice(index, 1);\n      } else {\n        expandedOrders.value.push(orderNo);\n      }\n    };\n\n    // 在组件挂载时获取数据\n    onMounted(async () => {\n      await Promise.all([fetchPointsInfo(), fetchPointsRecords()]);\n    });\n    const __returned__ = {\n      vipTypeText,\n      vipExpireText,\n      vipButtonText,\n      pointsInfo,\n      signInInfo,\n      canSignIn,\n      loading,\n      currentFilter,\n      currentTab,\n      pointsRecords,\n      hasMore,\n      page,\n      expandedOrders,\n      memberBenefits,\n      pointsFilters,\n      tabs,\n      pointRules,\n      filteredRecords,\n      handleVipButton,\n      handleSignIn,\n      fetchPointsInfo,\n      fetchPointsRecords,\n      loadMore,\n      getLevelTitle,\n      getLevelRange,\n      getLevelProgress,\n      getNextLevelPoints,\n      toggleOrderDetail,\n      ref,\n      computed,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get CalendarDaysIcon() {\n        return CalendarDaysIcon;\n      },\n      get StarIcon() {\n        return StarIcon;\n      },\n      get TrophyIcon() {\n        return TrophyIcon;\n      },\n      get CheckCircleIcon() {\n        return CheckCircleIcon;\n      },\n      get ChevronDownIcon() {\n        return ChevronDownIcon;\n      },\n      get SparklesIcon() {\n        return SparklesIcon;\n      },\n      get membership() {\n        return membership;\n      },\n      get formatDate() {\n        return formatDate;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","ElMessage","CalendarDaysIcon","StarIcon","TrophyIcon","CheckCircleIcon","ChevronDownIcon","SparklesIcon","membership","formatDate","vipTypeText","vipExpireText","vipButtonText","pointsInfo","balance","level","sign_in_days","total_earned","signInInfo","days","nextReward","canSignIn","loading","currentFilter","currentTab","pointsRecords","hasMore","page","expandedOrders","memberBenefits","key","name","desc","icon","pointsFilters","label","value","tabs","pointRules","action","points","description","bgColor","iconColor","borderColor","textColor","filteredRecords","filter","record","handleVipButton","handleSignIn","response","signIn","data","code","success","fetchPointsInfo","error","console","getPointsInfo","fetchPointsRecords","getPointsRecords","records","has_more","push","loadMore","getLevelTitle","titles","getLevelRange","ranges","getLevelProgress","thresholds","currentThreshold","nextThreshold","length","Math","min","getNextLevelPoints","max","toggleOrderDetail","orderNo","index","indexOf","splice","Promise","all"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/user/Membership/index.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-8\">\n    <!-- 会员状态卡片 -->\n    <div class=\"bg-white rounded-lg shadow overflow-hidden\">\n      <div class=\"px-6 py-8 bg-gradient-to-br from-[#1A56DB] via-blue-600 to-blue-500 relative overflow-hidden\">\n        <!-- 装饰背景 -->\n        <div class=\"absolute inset-0\">\n          <div class=\"absolute right-0 top-0 w-64 h-64 bg-white bg-opacity-10 rounded-full blur-3xl transform -translate-y-1/2 translate-x-1/2\"></div>\n          <div class=\"absolute left-0 bottom-0 w-32 h-32 bg-white bg-opacity-5 rounded-full blur-2xl\"></div>\n        </div>\n        <!-- 内容 -->\n        <div class=\"flex flex-col lg:flex-row items-start lg:items-center justify-between relative space-y-4 lg:space-y-0\">\n          <div class=\"text-white\">\n            <h3 class=\"text-2xl font-bold tracking-tight\">{{ vipTypeText }}</h3>\n            <p class=\"mt-2 text-white text-opacity-80 font-medium\">{{ vipExpireText }}</p>\n          </div>\n          <button \n            @click=\"handleVipButton\"\n            class=\"w-full lg:w-auto px-6 py-2.5 bg-white bg-opacity-10 backdrop-blur-sm text-white border border-white border-opacity-20 rounded-full text-sm font-medium hover:bg-opacity-20 transition-all duration-300\"\n          >\n            {{ vipButtonText }}\n          </button>\n        </div>\n      </div>\n      \n      <!-- 会员权益 -->\n      <div class=\"px-6 py-4\">\n        <h4 class=\"text-base font-medium text-gray-900 mb-4\">专属会员权益</h4>\n        <div class=\"grid grid-cols-1 lg:grid-cols-5 gap-4 lg:gap-6\">\n          <div v-for=\"benefit in memberBenefits\" :key=\"benefit.key\" \n            class=\"flex lg:flex-col items-center lg:text-center p-3 lg:p-0 bg-gray-50 bg-opacity-50 lg:bg-transparent rounded-lg lg:rounded-none\"\n          >\n            <div class=\"w-10 lg:w-12 h-10 lg:h-12 rounded-full bg-gradient-to-br from-blue-50 to-blue-100 bg-opacity-50 flex items-center justify-center\">\n              <component :is=\"benefit.icon\" class=\"w-6 h-6 text-[#1A56DB]\" />\n            </div>\n            <div class=\"ml-3 lg:ml-0 lg:mt-3\">\n              <div class=\"text-sm font-medium text-gray-900\">{{ benefit.name }}</div>\n              <div class=\"text-xs text-gray-600 mt-1\">{{ benefit.desc }}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 积分信息 -->\n    <div class=\"bg-white rounded-lg shadow overflow-hidden\">\n      <div class=\"px-6 py-8 relative\">\n        <!-- 装饰背景 -->\n        <div class=\"absolute inset-0 opacity-10\">\n          <div class=\"absolute right-0 top-0 w-64 h-64 bg-gradient-to-br from-violet-100 to-purple-100 bg-opacity-20 rounded-full transform -translate-y-1/3 translate-x-1/3\"></div>\n        </div>\n        \n        <!-- 积分和等级概览 -->\n        <div class=\"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0\">\n          <div>\n            <h3 class=\"text-lg lg:text-xl font-semibold text-gray-900\">我的积分</h3>\n            <div class=\"mt-3\">\n              <span class=\"text-4xl lg:text-5xl font-bold bg-gradient-to-r from-[#1A56DB] to-blue-500 bg-clip-text text-transparent\">{{ pointsInfo.balance || 0 }}</span>\n              <span class=\"text-sm text-gray-600 ml-1\">积分</span>\n            </div>\n          </div>\n          \n          <!-- 等级展示 -->\n          <div class=\"text-right\">\n            <div class=\"inline-flex items-center px-4 py-2 rounded-full bg-blue-50 border border-blue-100\">\n              <StarIcon class=\"w-5 h-5 text-[#1A56DB] mr-2\" />\n              <span class=\"text-base font-semibold text-[#1A56DB]\">Lv.{{ pointsInfo.level || 1 }}</span>\n            </div>\n            <div class=\"mt-2 text-sm font-medium text-gray-600\">{{ getLevelTitle(pointsInfo.level) }}</div>\n          </div>\n        </div>\n        \n        <!-- 等级进度条 -->\n        <div class=\"mt-6\">\n          <div class=\"flex items-center justify-between mb-2\">\n            <div class=\"text-sm text-gray-700\">\n              距离 Lv.{{ Math.min((pointsInfo.level || 1) + 1, 5) }} 还需 \n              <span class=\"font-medium text-violet-600\">{{ getNextLevelPoints(pointsInfo.level, pointsInfo.balance) }}</span> 分\n            </div>\n            <div class=\"text-sm text-gray-600\">\n              {{ pointsInfo.balance || 0 }}/{{ getLevelThreshold(pointsInfo.level) }}\n            </div>\n          </div>\n          <div class=\"h-2 bg-gray-100 rounded-full overflow-hidden\">\n            <div \n              class=\"h-full bg-gradient-to-r from-[#1A56DB] to-blue-500 transition-all duration-500\"\n              :style=\"{ width: `${getLevelProgress(pointsInfo.level, pointsInfo.balance)}%` }\"\n            ></div>\n          </div>\n        </div>\n\n        <!-- 签到信息 -->\n        <div class=\"mt-6 flex items-center\">\n          <div class=\"flex flex-wrap lg:flex-nowrap items-center space-x-2 lg:space-x-3 px-3 lg:px-4 py-2 bg-blue-50 rounded-lg border border-blue-100\">\n            <CalendarDaysIcon class=\"w-5 h-5 text-[#1A56DB]\" />\n            <div>\n              <div class=\"text-sm font-medium text-blue-900\">连续签到</div>\n              <div class=\"flex items-baseline space-x-1\">\n                <span class=\"text-xl font-bold text-[#1A56DB]\">{{ pointsInfo.sign_in_days || 0 }}</span>\n                <span class=\"text-sm text-[#1A56DB]\">天</span>\n              </div>\n            </div>\n            <button \n              v-if=\"canSignIn\"\n              @click=\"handleSignIn\"\n              class=\"mt-2 lg:mt-0 w-full lg:w-auto lg:ml-4 px-3 py-1.5 bg-blue-100 hover:bg-blue-200 text-[#1A56DB] text-sm font-medium rounded-full transition-colors cursor-pointer\"\n              :class=\"[\n                canSignIn \n                  ? 'bg-primary-600 text-white hover:bg-primary-700 hover:shadow-sm active:bg-primary-800' \n                  : 'bg-gray-100 text-gray-400 cursor-not-allowed'\n              ]\"\n            >\n              {{ canSignIn ? '立即签到' : '今日已签到' }}\n            </button>\n            <div v-else class=\"mt-2 lg:mt-0 w-full lg:w-auto lg:ml-4 text-center lg:text-left text-sm text-violet-600\">\n              今日已签到\n            </div>\n          </div>\n          \n          <div class=\"hidden lg:block ml-auto text-sm text-gray-500\">\n            {{ getSignInTip() }}\n          </div>\n        </div>\n      </div>\n\n      <!-- 积分明细 -->\n      <div class=\"px-4 lg:px-6 py-4\">\n        <div class=\"flex items-center justify-between mb-3\">\n          <h4 class=\"text-base font-medium text-gray-900\">积分明细</h4>\n          <div class=\"flex space-x-1 lg:space-x-2\">\n            <button \n              v-for=\"filter in pointsFilters\" \n              :key=\"filter.value\"\n              @click=\"currentFilter = filter.value\"\n              class=\"px-1.5 lg:px-2 py-1 text-xs rounded-full transition-colors whitespace-nowrap\"\n              :class=\"[\n                currentFilter === filter.value \n                  ? 'bg-gray-100 text-gray-800' \n                  : 'text-gray-500 hover:text-gray-700'\n              ]\"\n            >\n              {{ filter.label }}\n            </button>\n          </div>\n        </div>\n        <div class=\"divide-y divide-gray-100 max-h-[400px] overflow-y-auto\">\n          <div v-if=\"pointsRecords.length === 0\" class=\"py-8 text-center text-gray-500\">\n            暂无积分记录\n          </div>\n          <div \n            v-else\n            v-for=\"record in filteredRecords\" \n            :key=\"record.id\" \n            class=\"py-3 lg:py-3.5 flex items-center justify-between hover:bg-gray-50 transition-colors px-2\"\n          >\n            <div>\n              <div class=\"text-xs lg:text-sm font-medium text-gray-900\">{{ record.description }}</div>\n              <div class=\"text-[10px] lg:text-xs text-gray-500 mt-0.5\">\n                {{ formatDate(record.created_at, window.innerWidth < 640 ? 'MM-DD HH:mm' : 'YYYY-MM-DD HH:mm') }}\n              </div>\n            </div>\n            <div :class=\"[\n              'text-xs lg:text-sm font-medium ml-2 lg:ml-4',\n              record.points > 0 ? 'text-gray-800' : 'text-red-600'\n            ]\">\n              {{ record.points > 0 ? '+' : '' }}{{ record.points }}\n            </div>\n          </div>\n        </div>\n        <!-- 加载更多按钮 -->\n        <div v-if=\"hasMore\" class=\"mt-4 text-center\">\n          <button \n            @click=\"loadMore\"\n            class=\"text-xs lg:text-sm text-gray-500 hover:text-gray-700 px-3 lg:px-4 py-1.5 lg:py-2 rounded-full hover:bg-gray-100 transition-colors\"\n            :disabled=\"loading\"\n          >\n            {{ loading ? '加载中...' : '加载更多' }}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tab 导航 -->\n    <div class=\"bg-white rounded-lg shadow\">\n      <!-- Tab 头部 -->\n      <div class=\"border-b border-gray-200\">\n        <nav class=\"-mb-px flex\" aria-label=\"Tabs\">\n          <button\n            v-for=\"tab in tabs\"\n            :key=\"tab.key\"\n            @click=\"currentTab = tab.key\"\n            :class=\"[\n              currentTab === tab.key\n                ? 'border-primary-500 text-primary-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300',\n              'w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm transition-colors duration-200'\n            ]\"\n          >\n            {{ tab.name }}\n          </button>\n        </nav>\n      </div>\n\n      <!-- Tab 内容 -->\n      <div class=\"p-6\">\n        <!-- 积分规则 -->\n        <div v-if=\"currentTab === 'points'\" class=\"space-y-6\">\n          <h3 class=\"text-lg font-medium text-gray-900\">积分获取规则</h3>\n          <div class=\"space-y-3\">\n            <div class=\"flex items-center p-4 bg-white border rounded-lg transition-all hover:shadow-sm border-blue-100\">\n              <div class=\"w-10 h-10 rounded-lg flex items-center justify-center bg-blue-50\">\n                <CalendarDaysIcon class=\"w-5 h-5 text-blue-500\" />\n              </div>\n              <div class=\"ml-4 flex-1\">\n                <div class=\"flex items-center justify-between\">\n                  <div class=\"font-medium text-gray-900\">每日签到</div>\n                  <button\n                    @click=\"handleSignIn\"\n                    :disabled=\"!canSignIn\"\n                    class=\"px-4 py-1.5 rounded-full text-sm font-medium transition-colors cursor-pointer\"\n                    :class=\"[\n                      canSignIn \n                        ? 'bg-primary-600 text-white hover:bg-primary-700 hover:shadow-sm active:bg-primary-800' \n                        : 'bg-gray-100 text-gray-400 cursor-not-allowed'\n                    ]\"\n                  >\n                    {{ canSignIn ? '立即签到' : '今日已签到' }}\n                  </button>\n                </div>\n                <div class=\"mt-1 text-sm text-gray-500\">\n                  已连续签到 {{ signInInfo.days }} 天\n                  <template v-if=\"signInInfo.nextReward\">\n                    <span class=\"ml-2\">\n                      再签到 {{ signInInfo.nextReward.days }} 天可获得 \n                      {{ signInInfo.nextReward.points }} 积分奖励\n                    </span>\n                  </template>\n                </div>\n              </div>\n            </div>\n            <div v-for=\"rule in pointRules.slice(1)\" :key=\"rule.action\" \n              class=\"flex items-center p-4 bg-white border rounded-lg transition-all hover:shadow-sm\"\n              :class=\"rule.borderColor\"\n            >\n              <div :class=\"[\n                'w-10 h-10 rounded-lg flex items-center justify-center',\n                rule.bgColor\n              ]\">\n                <component :is=\"rule.icon\" class=\"w-5 h-5\" :class=\"rule.iconColor\" />\n              </div>\n              <div class=\"ml-4 flex-1\">\n                <div class=\"flex items-center justify-between\">\n                  <div class=\"font-medium text-gray-900\">{{ rule.action }}</div>\n                  <div class=\"text-sm font-medium\" :class=\"rule.textColor\">{{ rule.points }}</div>\n                </div>\n                <div class=\"mt-1 text-sm text-gray-500\">{{ rule.description }}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- 等级权益 -->\n        <div v-if=\"currentTab === 'privileges'\" class=\"space-y-6\">\n          <h3 class=\"text-lg font-medium text-gray-900\">等级特权</h3>\n          <div class=\"space-y-6\">\n            <div v-for=\"level in 5\" :key=\"level\" \n              class=\"bg-white border rounded-lg overflow-hidden transition-all hover:shadow-sm\"\n              :class=\"[\n                level === pointsInfo.level ? 'border-primary-500' : 'border-gray-100',\n              ]\"\n            >\n              <!-- 等级头部 -->\n              <div class=\"px-6 py-4 flex items-center justify-between border-b border-gray-100\"\n                :class=\"level === pointsInfo.level ? 'bg-primary-50' : 'bg-gray-50'\"\n              >\n                <div class=\"flex items-center space-x-3\">\n                  <div class=\"w-10 h-10 rounded-lg flex items-center justify-center\"\n                    :class=\"level === pointsInfo.level ? 'bg-primary-100' : 'bg-white'\"\n                  >\n                    <TrophyIcon \n                      class=\"w-6 h-6\"\n                      :class=\"level === pointsInfo.level ? 'text-primary-500' : 'text-gray-400'\"\n                    />\n                  </div>\n                  <div>\n                    <div class=\"flex items-center\">\n                      <span class=\"text-lg font-semibold text-gray-900\">\n                        Lv.{{ level }} {{ getLevelTitle(level) }}\n                      </span>\n                      <span v-if=\"level === pointsInfo.level\"\n                        class=\"ml-2 px-2 py-0.5 text-xs font-medium text-primary-600 bg-primary-100 rounded-full\"\n                      >\n                        当前等级\n                      </span>\n                    </div>\n                    <div class=\"text-sm text-gray-500 mt-0.5\">{{ getLevelRange(level) }}</div>\n                  </div>\n                </div>\n                <div class=\"text-sm text-gray-500\">\n                  {{ level < 5 ? `距离下一级还需 ${getNextLevelPoints(level, pointsInfo.total_earned)} 积分` : '已达到最高等级' }}\n                </div>\n              </div>\n\n              <!-- 等级特权列表 -->\n              <div class=\"p-6\">\n                <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div v-for=\"(privilege, index) in getLevelPrivileges(level)\" \n                    :key=\"index\"\n                    class=\"flex items-start space-x-3 p-3 rounded-lg\"\n                    :class=\"level === pointsInfo.level ? 'bg-primary-50' : 'bg-gray-50'\"\n                  >\n                    <div class=\"flex-shrink-0\">\n                      <CheckCircleIcon \n                        class=\"w-5 h-5\"\n                        :class=\"level === pointsInfo.level ? 'text-primary-500' : 'text-gray-400'\"\n                      />\n                    </div>\n                    <div>\n                      <div class=\"text-sm font-medium text-gray-900\">{{ privilege.title }}</div>\n                      <div class=\"text-xs text-gray-500 mt-0.5\">{{ privilege.description }}</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- 订单记录 -->\n        <div v-if=\"currentTab === 'orders'\" class=\"space-y-4\">\n          <div v-if=\"orders.length === 0\" class=\"text-center py-8 text-gray-500\">\n            暂无订单记录\n          </div>\n          \n          <!-- 订单列表 -->\n          <div v-else class=\"space-y-4\">\n            <div v-for=\"order in orders\" :key=\"order.order_no\" \n              class=\"bg-white border rounded-lg overflow-hidden transition-all hover:border-gray-300\"\n            >\n              <!-- 订单基本信息 -->\n              <div class=\"px-4 py-3 flex items-center justify-between border-b border-gray-100\">\n                <div class=\"flex items-center space-x-4\">\n                  <div class=\"text-sm text-gray-500\">订单号：{{ order.order_no }}</div>\n                  <div :class=\"[\n                    'px-2 py-1 text-xs font-medium rounded-full',\n                    {\n                      'bg-yellow-100 text-yellow-800': order.status === 'pending',\n                      'bg-green-100 text-green-800': order.status === 'paid',\n                      'bg-gray-100 text-gray-800': order.status === 'cancelled',\n                      'bg-red-100 text-red-800': order.status === 'refunded'\n                    }\n                  ]\">\n                    {{ formatOrderStatus(order.status) }}\n                  </div>\n                </div>\n                <button \n                  class=\"text-sm text-gray-500 hover:text-gray-700\"\n                  @click=\"toggleOrderDetail(order.order_no)\"\n                >\n                  {{ expandedOrders.includes(order.order_no) ? '收起' : '展开' }}\n                  <ChevronDownIcon \n                    class=\"w-4 h-4 inline-block ml-1 transition-transform\"\n                    :class=\"{ 'rotate-180': expandedOrders.includes(order.order_no) }\"\n                  />\n                </button>\n              </div>\n              \n              <!-- 订单主要信息 -->\n              <div class=\"px-4 py-3 flex items-center justify-between bg-gray-50\">\n                <div class=\"flex items-center space-x-3\">\n                  <div class=\"w-10 h-10 rounded-lg bg-violet-100 flex items-center justify-center\">\n                    <SparklesIcon class=\"w-5 h-5 text-violet-600\" />\n                  </div>\n                  <div>\n                    <div class=\"font-medium\">{{ formatMembershipType(order) }}</div>\n                    <div class=\"text-sm text-gray-500\">{{ formatDate(order.created_at) }}</div>\n                  </div>\n                </div>\n                <div class=\"text-lg font-medium text-gray-900\">\n                  ¥{{ order.amount }}\n                </div>\n              </div>\n              \n              <!-- 展开的详细信息 -->\n              <div v-show=\"expandedOrders.includes(order.order_no)\"\n                class=\"px-4 py-3 space-y-3 bg-gray-50 border-t border-gray-100\"\n              >\n                <div class=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <div class=\"text-gray-500\">支付方式</div>\n                    <div class=\"mt-1\">{{ formatPaymentMethod(order.payment_method) }}</div>\n                  </div>\n                  <div>\n                    <div class=\"text-gray-500\">支付时间</div>\n                    <div class=\"mt-1\">{{ order.paid_at ? formatDate(order.paid_at) : '-' }}</div>\n                  </div>\n                  <div>\n                    <div class=\"text-gray-500\">订单创建时间</div>\n                    <div class=\"mt-1\">{{ formatDate(order.created_at) }}</div>\n                  </div>\n                  <div>\n                    <div class=\"text-gray-500\">订单更新时间</div>\n                    <div class=\"mt-1\">{{ formatDate(order.updated_at) }}</div>\n                  </div>\n                </div>\n                \n                <!-- 如果有备注信息 -->\n                <div v-if=\"order.remarks\" class=\"text-sm\">\n                  <div class=\"text-gray-500\">备注信息</div>\n                  <div class=\"mt-1 text-gray-700\">{{ order.remarks }}</div>\n                </div>\n                \n                <!-- 订单操作按钮 -->\n                <div class=\"flex justify-end space-x-3 pt-2\">\n                  <button v-if=\"order.status === 'pending'\"\n                    class=\"px-3 py-1 text-sm text-violet-600 hover:text-violet-700 border border-violet-200 rounded-md hover:bg-violet-50\"\n                    @click=\"handlePayment(order)\"\n                  >\n                    立即支付\n                  </button>\n                  <button v-if=\"['pending', 'paid'].includes(order.status)\"\n                    class=\"px-3 py-1 text-sm text-gray-600 hover:text-gray-700 border border-gray-200 rounded-md hover:bg-gray-50\"\n                    @click=\"showOrderDetail(order)\"\n                  >\n                    查看详情\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport { \n  CalendarDaysIcon, \n  StarIcon,\n  TrophyIcon,\n  CheckCircleIcon,\n  ChevronDownIcon,\n  SparklesIcon\n} from '@heroicons/vue/24/outline'\nimport { membership } from '@/api'\nimport { formatDate } from '@/utils/date'\n\n// 会员状态数据\nconst vipTypeText = ref('免费用户')\nconst vipExpireText = ref('开通会员享受更多权益')\nconst vipButtonText = ref('开通会员')\n\n// 积分相关数据\nconst pointsInfo = ref({\n  balance: 0,\n  level: 1,\n  sign_in_days: 0,\n  total_earned: 0\n})\n\nconst signInInfo = ref({\n  days: 0,\n  nextReward: null\n})\n\nconst canSignIn = ref(true)\nconst loading = ref(false)\nconst currentFilter = ref('all')\nconst currentTab = ref('points')\nconst pointsRecords = ref([])\nconst hasMore = ref(false)\nconst page = ref(1)\nconst expandedOrders = ref([])\n\n// 会员权益列表\nconst memberBenefits = [\n  {\n    key: 'unlimited',\n    name: '无限使用',\n    desc: '无限制使用所有功能',\n    icon: SparklesIcon\n  },\n  // ... 其他权益配置\n]\n\n// 积分筛选选项\nconst pointsFilters = [\n  { label: '全部', value: 'all' },\n  { label: '获得', value: 'earned' },\n  { label: '使用', value: 'used' }\n]\n\n// tabs配置\nconst tabs = [\n  { key: 'points', name: '积分规则' },\n  { key: 'privileges', name: '等级权益' },\n  { key: 'orders', name: '订单记录' }\n]\n\n// 积分规则\nconst pointRules = [\n  {\n    action: '每日签到',\n    points: '+1~10',\n    description: '连续签到可获得更多积分奖励',\n    icon: CalendarDaysIcon,\n    bgColor: 'bg-blue-50',\n    iconColor: 'text-blue-500',\n    borderColor: 'border-blue-100',\n    textColor: 'text-blue-600'\n  },\n  // ... 其他规则配置\n]\n\n// 计算属性\nconst filteredRecords = computed(() => {\n  if (currentFilter.value === 'all') return pointsRecords.value\n  return pointsRecords.value.filter(record => \n    currentFilter.value === 'earned' ? record.points > 0 : record.points < 0\n  )\n})\n\n// 方法\nconst handleVipButton = () => {\n  // 处理会员按钮点击\n}\n\nconst handleSignIn = async () => {\n  if (!canSignIn.value) return\n  \n  try {\n    const response = await membership.signIn()\n    if (response?.data?.code === 200) {\n      ElMessage.success('签到成功')\n      canSignIn.value = false\n      await fetchPointsInfo()\n    }\n  } catch (error) {\n    console.error('签到失败:', error)\n    ElMessage.error('签到失败，请稍后重试')\n  }\n}\n\nconst fetchPointsInfo = async () => {\n  try {\n    const response = await membership.getPointsInfo()\n    if (response?.data?.code === 200) {\n      pointsInfo.value = response.data.data\n    }\n  } catch (error) {\n    console.error('获取积分信息失败:', error)\n  }\n}\n\nconst fetchPointsRecords = async () => {\n  if (loading.value) return\n  \n  loading.value = true\n  try {\n    const response = await membership.getPointsRecords({ page: page.value })\n    if (response?.data?.code === 200) {\n      const { records, has_more } = response.data.data\n      if (page.value === 1) {\n        pointsRecords.value = records\n      } else {\n        pointsRecords.value.push(...records)\n      }\n      hasMore.value = has_more\n    }\n  } catch (error) {\n    console.error('获取积分记录失败:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\nconst loadMore = () => {\n  page.value++\n  fetchPointsRecords()\n}\n\nconst getLevelTitle = (level) => {\n  const titles = ['初级用户', '普通用户', '高级用户', '资深用户', '专家用户']\n  return titles[level - 1] || titles[0]\n}\n\nconst getLevelRange = (level) => {\n  const ranges = {\n    1: '0-100积分',\n    2: '101-500积分',\n    3: '501-2000积分',\n    4: '2001-10000积分',\n    5: '10000积分以上'\n  }\n  return ranges[level]\n}\n\nconst getLevelProgress = (level, balance) => {\n  const thresholds = [0, 100, 500, 2000, 10000]\n  const currentThreshold = thresholds[level - 1] || 0\n  const nextThreshold = thresholds[level] || thresholds[thresholds.length - 1]\n  return Math.min(((balance - currentThreshold) / (nextThreshold - currentThreshold)) * 100, 100)\n}\n\nconst getNextLevelPoints = (level, balance) => {\n  const thresholds = [0, 100, 500, 2000, 10000]\n  if (level >= thresholds.length) return 0\n  return Math.max(thresholds[level] - balance, 0)\n}\n\nconst toggleOrderDetail = (orderNo) => {\n  const index = expandedOrders.value.indexOf(orderNo)\n  if (index > -1) {\n    expandedOrders.value.splice(index, 1)\n  } else {\n    expandedOrders.value.push(orderNo)\n  }\n}\n\n// 在组件挂载时获取数据\nonMounted(async () => {\n  await Promise.all([\n    fetchPointsInfo(),\n    fetchPointsRecords()\n  ])\n})\n</script>\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}