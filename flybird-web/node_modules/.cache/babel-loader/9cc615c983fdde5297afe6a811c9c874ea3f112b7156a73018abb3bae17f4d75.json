{"ast":null,"code":"import _objectWithoutProperties from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"once\", \"immediate\"];\n// Types\n\nfunction mounted(el, binding) {\n  const modifiers = binding.modifiers || {};\n  const value = binding.value;\n  const {\n      once,\n      immediate\n    } = modifiers,\n    modifierKeys = _objectWithoutProperties(modifiers, _excluded);\n  const defaultValue = !Object.keys(modifierKeys).length;\n  const {\n    handler,\n    options\n  } = typeof value === 'object' ? value : {\n    handler: value,\n    options: {\n      attributes: modifierKeys?.attr ?? defaultValue,\n      characterData: modifierKeys?.char ?? defaultValue,\n      childList: modifierKeys?.child ?? defaultValue,\n      subtree: modifierKeys?.sub ?? defaultValue\n    }\n  };\n  const observer = new MutationObserver(function () {\n    let mutations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let observer = arguments.length > 1 ? arguments[1] : undefined;\n    handler?.(mutations, observer);\n    if (once) unmounted(el, binding);\n  });\n  if (immediate) handler?.([], observer);\n  el._mutate = Object(el._mutate);\n  el._mutate[binding.instance.$.uid] = {\n    observer\n  };\n  observer.observe(el, options);\n}\nfunction unmounted(el, binding) {\n  if (!el._mutate?.[binding.instance.$.uid]) return;\n  el._mutate[binding.instance.$.uid].observer.disconnect();\n  delete el._mutate[binding.instance.$.uid];\n}\nexport const Mutate = {\n  mounted,\n  unmounted\n};\nexport default Mutate;","map":{"version":3,"names":["mounted","el","binding","modifiers","value","once","immediate","modifierKeys","_objectWithoutProperties","_excluded","defaultValue","Object","keys","length","handler","options","attributes","attr","characterData","char","childList","child","subtree","sub","observer","MutationObserver","mutations","arguments","undefined","unmounted","_mutate","instance","$","uid","observe","disconnect","Mutate"],"sources":["../../../src/directives/mutate/index.ts"],"sourcesContent":["// Types\nimport type { DirectiveBinding } from 'vue'\nimport type { MutationOptions } from '@/composables/mutationObserver'\n\nexport interface MutationDirectiveBinding extends Omit<DirectiveBinding, 'modifiers' | 'value'> {\n  value: MutationCallback | { handler: MutationCallback, options?: MutationObserverInit }\n  modifiers: MutationOptions\n}\n\nfunction mounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  const modifiers = binding.modifiers || {}\n  const value = binding.value\n  const { once, immediate, ...modifierKeys } = modifiers\n  const defaultValue = !Object.keys(modifierKeys).length\n\n  const { handler, options } = typeof value === 'object'\n    ? value\n    : {\n      handler: value,\n      options: {\n        attributes: modifierKeys?.attr ?? defaultValue,\n        characterData: modifierKeys?.char ?? defaultValue,\n        childList: modifierKeys?.child ?? defaultValue,\n        subtree: modifierKeys?.sub ?? defaultValue,\n      },\n    }\n\n  const observer = new MutationObserver((\n    mutations: MutationRecord[] = [],\n    observer: MutationObserver\n  ) => {\n    handler?.(mutations, observer)\n\n    if (once) unmounted(el, binding)\n  })\n\n  if (immediate) handler?.([], observer)\n\n  el._mutate = Object(el._mutate)\n  el._mutate![binding.instance!.$.uid] = { observer }\n\n  observer.observe(el, options)\n}\n\nfunction unmounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  if (!el._mutate?.[binding.instance!.$.uid]) return\n\n  el._mutate[binding.instance!.$.uid]!.observer.disconnect()\n  delete el._mutate[binding.instance!.$.uid]\n}\n\nexport const Mutate = {\n  mounted,\n  unmounted,\n}\n\nexport default Mutate\n"],"mappings":";;AAAA;;AASA,SAASA,OAAOA,CAAEC,EAAe,EAAEC,OAAiC,EAAE;EACpE,MAAMC,SAAS,GAAGD,OAAO,CAACC,SAAS,IAAI,CAAC,CAAC;EACzC,MAAMC,KAAK,GAAGF,OAAO,CAACE,KAAK;EAC3B,MAAM;MAAEC,IAAI;MAAEC;IAA2B,CAAC,GAAGH,SAAS;IAA1BI,YAAA,GAAAC,wBAAA,CAAiBL,SAAS,EAAAM,SAAA;EACtD,MAAMC,YAAY,GAAG,CAACC,MAAM,CAACC,IAAI,CAACL,YAAY,CAAC,CAACM,MAAM;EAEtD,MAAM;IAAEC,OAAO;IAAEC;EAAQ,CAAC,GAAG,OAAOX,KAAK,KAAK,QAAQ,GAClDA,KAAK,GACL;IACAU,OAAO,EAAEV,KAAK;IACdW,OAAO,EAAE;MACPC,UAAU,EAAET,YAAY,EAAEU,IAAI,IAAIP,YAAY;MAC9CQ,aAAa,EAAEX,YAAY,EAAEY,IAAI,IAAIT,YAAY;MACjDU,SAAS,EAAEb,YAAY,EAAEc,KAAK,IAAIX,YAAY;MAC9CY,OAAO,EAAEf,YAAY,EAAEgB,GAAG,IAAIb;IAChC;EACF,CAAC;EAEH,MAAMc,QAAQ,GAAG,IAAIC,gBAAgB,CAAC,YAGjC;IAAA,IAFHC,SAA2B,GAAAC,SAAA,CAAAd,MAAA,QAAAc,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAG,EAAE;IAAA,IAChCH,QAA0B,GAAAG,SAAA,CAAAd,MAAA,OAAAc,SAAA,MAAAC,SAAA;IAE1Bd,OAAO,GAAGY,SAAS,EAAEF,QAAQ,CAAC;IAE9B,IAAInB,IAAI,EAAEwB,SAAS,CAAC5B,EAAE,EAAEC,OAAO,CAAC;EAClC,CAAC,CAAC;EAEF,IAAII,SAAS,EAAEQ,OAAO,GAAG,EAAE,EAAEU,QAAQ,CAAC;EAEtCvB,EAAE,CAAC6B,OAAO,GAAGnB,MAAM,CAACV,EAAE,CAAC6B,OAAO,CAAC;EAC/B7B,EAAE,CAAC6B,OAAO,CAAE5B,OAAO,CAAC6B,QAAQ,CAAEC,CAAC,CAACC,GAAG,CAAC,GAAG;IAAET;EAAS,CAAC;EAEnDA,QAAQ,CAACU,OAAO,CAACjC,EAAE,EAAEc,OAAO,CAAC;AAC/B;AAEA,SAASc,SAASA,CAAE5B,EAAe,EAAEC,OAAiC,EAAE;EACtE,IAAI,CAACD,EAAE,CAAC6B,OAAO,GAAG5B,OAAO,CAAC6B,QAAQ,CAAEC,CAAC,CAACC,GAAG,CAAC,EAAE;EAE5ChC,EAAE,CAAC6B,OAAO,CAAC5B,OAAO,CAAC6B,QAAQ,CAAEC,CAAC,CAACC,GAAG,CAAC,CAAET,QAAQ,CAACW,UAAU,CAAC,CAAC;EAC1D,OAAOlC,EAAE,CAAC6B,OAAO,CAAC5B,OAAO,CAAC6B,QAAQ,CAAEC,CAAC,CAACC,GAAG,CAAC;AAC5C;AAEA,OAAO,MAAMG,MAAM,GAAG;EACpBpC,OAAO;EACP6B;AACF,CAAC;AAED,eAAeO,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}