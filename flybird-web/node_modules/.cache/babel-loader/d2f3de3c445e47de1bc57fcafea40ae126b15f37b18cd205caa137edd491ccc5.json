{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, toDisplayString as _toDisplayString, createVNode as _createVNode, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, Transition as _Transition, withKeys as _withKeys } from \"vue\";\nconst _hoisted_1 = {\n  class: \"space-y-6 pb-24\"\n};\nconst _hoisted_2 = {\n  class: \"relative\"\n};\nconst _hoisted_3 = {\n  class: \"relative\"\n};\nconst _hoisted_4 = {\n  class: \"flex items-center\"\n};\nconst _hoisted_5 = {\n  class: \"ml-3 block truncate\"\n};\nconst _hoisted_6 = {\n  class: \"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2\"\n};\nconst _hoisted_7 = {\n  class: \"flex items-center\"\n};\nconst _hoisted_8 = {\n  class: \"flex items-center gap-4\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"relative w-48 h-32 rounded-lg overflow-hidden group\"\n};\nconst _hoisted_10 = [\"src\"];\nconst _hoisted_11 = {\n  class: \"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\"\n};\nconst _hoisted_12 = {\n  key: 1\n};\nconst _hoisted_13 = {\n  class: \"border rounded-lg border-gray-300\"\n};\nconst _hoisted_14 = {\n  class: \"flex flex-wrap gap-2\"\n};\nconst _hoisted_15 = {\n  class: \"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 lg:px-8 py-4 z-50\"\n};\nconst _hoisted_16 = {\n  class: \"max-w-4xl mx-auto flex items-center\"\n};\nconst _hoisted_17 = {\n  key: 0,\n  class: \"text-sm text-gray-500\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 标题 \"), _createElementVNode(\"div\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    class: \"block text-sm font-medium text-gray-700 mb-2\"\n  }, \"文章标题\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.articleForm.title = $event),\n    class: \"block w-full rounded-lg border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500\",\n    placeholder: \"请输入文章标题\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.articleForm.title]])]), _createCommentVNode(\" 分类 \"), _createElementVNode(\"div\", null, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    class: \"block text-sm font-medium text-gray-700 mb-2\"\n  }, \"文章分类\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_createCommentVNode(\" 分类选择 \"), _createVNode($setup[\"Listbox\"], {\n    modelValue: $setup.selectedCategory,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.selectedCategory = $event)\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createVNode($setup[\"ListboxButton\"], {\n      class: \"relative w-full cursor-pointer rounded-lg bg-white py-2.5 pl-3 pr-10 text-left border border-gray-300 focus:outline-none focus:ring-2 focus:ring-violet-500 sm:text-sm\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"span\", _hoisted_4, [(_openBlock(), _createBlock(_resolveDynamicComponent($setup.selectedCategory.icon), {\n        class: \"h-5 w-5 flex-shrink-0 text-gray-400\",\n        \"aria-hidden\": \"true\"\n      })), _createElementVNode(\"span\", _hoisted_5, _toDisplayString($setup.selectedCategory.name), 1 /* TEXT */)]), _createElementVNode(\"span\", _hoisted_6, [_createVNode($setup[\"ChevronUpDownIcon\"], {\n        class: \"h-5 w-5 text-gray-400\",\n        \"aria-hidden\": \"true\"\n      })])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_Transition, {\n      \"leave-active-class\": \"transition duration-100 ease-in\",\n      \"leave-from-class\": \"opacity-100\",\n      \"leave-to-class\": \"opacity-0\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"ListboxOptions\"], {\n        class: \"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm\"\n      }, {\n        default: _withCtx(() => [(_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.categories, category => {\n          return _createVNode($setup[\"ListboxOption\"], {\n            key: category.id,\n            value: category,\n            as: \"template\"\n          }, {\n            default: _withCtx(({\n              active,\n              selected\n            }) => [_createElementVNode(\"li\", {\n              class: _normalizeClass([active ? 'bg-violet-600 text-white' : 'text-gray-900', 'relative cursor-pointer select-none py-2 pl-3 pr-9'])\n            }, [_createElementVNode(\"div\", _hoisted_7, [(_openBlock(), _createBlock(_resolveDynamicComponent(category.icon), {\n              class: _normalizeClass([active ? 'text-white' : 'text-gray-400', 'h-5 w-5 flex-shrink-0']),\n              \"aria-hidden\": \"true\"\n            }, null, 8 /* PROPS */, [\"class\"])), _createElementVNode(\"span\", {\n              class: _normalizeClass([selected ? 'font-semibold' : 'font-normal', 'ml-3 block truncate'])\n            }, _toDisplayString(category.name), 3 /* TEXT, CLASS */)]), selected ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 0,\n              class: _normalizeClass([active ? 'text-white' : 'text-violet-600', 'absolute inset-y-0 right-0 flex items-center pr-4'])\n            }, [_createVNode($setup[\"CheckIcon\"], {\n              class: \"h-5 w-5\",\n              \"aria-hidden\": \"true\"\n            })], 2 /* CLASS */)) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */)]),\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"value\"]);\n        }), 64 /* STABLE_FRAGMENT */))]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])])]), _createCommentVNode(\" 封面图 \"), _createElementVNode(\"div\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    class: \"block text-sm font-medium text-gray-700 mb-2\"\n  }, \"文章封面\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_8, [$setup.articleForm.cover ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"img\", {\n    src: $setup.articleForm.cover,\n    class: \"w-full h-full object-cover\"\n  }, null, 8 /* PROPS */, _hoisted_10), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"button\", {\n    class: \"text-white text-sm\",\n    onClick: _cache[2] || (_cache[2] = $event => $setup.articleForm.cover = '')\n  }, \" 删除封面 \")])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_createElementVNode(\"button\", {\n    class: \"w-48 h-32 rounded-lg border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors flex flex-col items-center justify-center gap-2\",\n    onClick: $setup.uploadCover\n  }, [_createVNode($setup[\"PhotoIcon\"], {\n    class: \"w-6 h-6 text-gray-400\"\n  }), _cache[7] || (_cache[7] = _createElementVNode(\"span\", {\n    class: \"text-sm text-gray-500\"\n  }, \"点击上传封面\", -1 /* HOISTED */))]), _createElementVNode(\"input\", {\n    ref: \"coverInput\",\n    type: \"file\",\n    accept: \"image/*\",\n    class: \"hidden\",\n    onChange: $setup.handleCoverChange\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)]))])]), _createCommentVNode(\" 文章内容 \"), _createElementVNode(\"div\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    class: \"block text-sm font-medium text-gray-700 mb-2\"\n  }, \"文章内容\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_13, [_createVNode($setup[\"Toolbar\"], {\n    editor: $setup.editorRef,\n    defaultConfig: $setup.toolbarConfig,\n    mode: \"default\",\n    style: {\n      \"border-bottom\": \"1px solid #e5e7eb\"\n    }\n  }, null, 8 /* PROPS */, [\"editor\"]), _createVNode($setup[\"Editor\"], {\n    modelValue: $setup.articleForm.content,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.articleForm.content = $event),\n    defaultConfig: $setup.editorConfig,\n    mode: \"default\",\n    onOnCreated: $setup.handleCreated,\n    style: {\n      \"height\": \"500px\"\n    }\n  }, null, 8 /* PROPS */, [\"modelValue\"])])]), _createCommentVNode(\" 标签 \"), _createElementVNode(\"div\", null, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", {\n    class: \"block text-sm font-medium text-gray-700 mb-2\"\n  }, \"添加标签\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_14, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.articleForm.tags, tag => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: tag,\n      class: \"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm flex items-center group\"\n    }, [_createElementVNode(\"span\", null, _toDisplayString(tag), 1 /* TEXT */), _createVNode($setup[\"XMarkIcon\"], {\n      class: \"w-4 h-4 ml-1 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity\",\n      onClick: $event => $setup.removeTag(tag)\n    }, null, 8 /* PROPS */, [\"onClick\"])]);\n  }), 128 /* KEYED_FRAGMENT */)), $setup.articleForm.tags.length < 5 ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n    key: 0,\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.newTag = $event),\n    onKeydown: _withKeys($setup.addTag, [\"enter\"]),\n    class: \"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-violet-500\",\n    placeholder: \"按回车添加标签\"\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)), [[_vModelText, $setup.newTag]]) : _createCommentVNode(\"v-if\", true)]), _cache[11] || (_cache[11] = _createElementVNode(\"p\", {\n    class: \"mt-1 text-xs text-gray-500\"\n  }, \"最多添加 5 个标签\", -1 /* HOISTED */))]), _createCommentVNode(\" 发布按钮 \"), _createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, [_createCommentVNode(\" 草稿状态提示 \"), $setup.lastSavedTime ? (_openBlock(), _createElementBlock(\"span\", _hoisted_17, _toDisplayString($setup.lastSavedTime) + \" 已保存草稿 \", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[12] || (_cache[12] = _createElementVNode(\"div\", {\n    class: \"flex-1\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    class: \"px-6 h-10 border border-violet-600 text-violet-600 rounded-lg hover:bg-violet-50 transition-colors\",\n    onClick: $setup.saveDraft\n  }, \" 保存草稿 \"), _createElementVNode(\"button\", {\n    class: \"ml-4 px-6 h-10 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors\",\n    onClick: $setup.submitArticle\n  }, \" 发布文章 \")])])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","type","_cache","$event","$setup","articleForm","title","placeholder","_hoisted_2","_createVNode","modelValue","selectedCategory","default","_withCtx","_hoisted_3","_hoisted_4","_createBlock","_resolveDynamicComponent","icon","_hoisted_5","_toDisplayString","name","_hoisted_6","_","_Transition","_Fragment","_renderList","categories","category","id","value","as","active","selected","_normalizeClass","_hoisted_7","_hoisted_8","cover","_hoisted_9","src","_hoisted_10","_hoisted_11","onClick","_hoisted_12","uploadCover","ref","accept","onChange","handleCoverChange","_hoisted_13","editor","editorRef","defaultConfig","toolbarConfig","mode","style","content","editorConfig","onOnCreated","handleCreated","_hoisted_14","tags","tag","removeTag","length","newTag","onKeydown","_withKeys","addTag","_hoisted_15","_hoisted_16","lastSavedTime","_hoisted_17","saveDraft","submitArticle"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/community/components/ArticleForm.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6 pb-24\">\n    <!-- 标题 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章标题</label>\n      <input\n        type=\"text\"\n        v-model=\"articleForm.title\"\n        class=\"block w-full rounded-lg border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500\"\n        placeholder=\"请输入文章标题\"\n      >\n    </div>\n\n    <!-- 分类 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章分类</label>\n      <div class=\"relative\">\n        <!-- 分类选择 -->\n        <Listbox v-model=\"selectedCategory\">\n          <div class=\"relative\">\n            <ListboxButton\n              class=\"relative w-full cursor-pointer rounded-lg bg-white py-2.5 pl-3 pr-10 text-left border border-gray-300 focus:outline-none focus:ring-2 focus:ring-violet-500 sm:text-sm\"\n            >\n              <span class=\"flex items-center\">\n                <component \n                  :is=\"selectedCategory.icon\" \n                  class=\"h-5 w-5 flex-shrink-0 text-gray-400\"\n                  aria-hidden=\"true\"\n                />\n                <span class=\"ml-3 block truncate\">{{ selectedCategory.name }}</span>\n              </span>\n              <span class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2\">\n                <ChevronUpDownIcon class=\"h-5 w-5 text-gray-400\" aria-hidden=\"true\" />\n              </span>\n            </ListboxButton>\n\n            <Transition\n              leave-active-class=\"transition duration-100 ease-in\"\n              leave-from-class=\"opacity-100\"\n              leave-to-class=\"opacity-0\"\n            >\n              <ListboxOptions\n                class=\"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm\"\n              >\n                <ListboxOption\n                  v-for=\"category in categories\"\n                  :key=\"category.id\"\n                  :value=\"category\"\n                  v-slot=\"{ active, selected }\"\n                  as=\"template\"\n                >\n                  <li\n                    :class=\"[\n                      active ? 'bg-violet-600 text-white' : 'text-gray-900',\n                      'relative cursor-pointer select-none py-2 pl-3 pr-9'\n                    ]\"\n                  >\n                    <div class=\"flex items-center\">\n                      <component \n                        :is=\"category.icon\" \n                        :class=\"[\n                          active ? 'text-white' : 'text-gray-400',\n                          'h-5 w-5 flex-shrink-0'\n                        ]\"\n                        aria-hidden=\"true\"\n                      />\n                      <span\n                        :class=\"[\n                          selected ? 'font-semibold' : 'font-normal',\n                          'ml-3 block truncate'\n                        ]\"\n                      >\n                        {{ category.name }}\n                      </span>\n                    </div>\n\n                    <span\n                      v-if=\"selected\"\n                      :class=\"[\n                        active ? 'text-white' : 'text-violet-600',\n                        'absolute inset-y-0 right-0 flex items-center pr-4'\n                      ]\"\n                    >\n                      <CheckIcon class=\"h-5 w-5\" aria-hidden=\"true\" />\n                    </span>\n                  </li>\n                </ListboxOption>\n              </ListboxOptions>\n            </Transition>\n          </div>\n        </Listbox>\n      </div>\n    </div>\n\n    <!-- 封面图 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章封面</label>\n      <div class=\"flex items-center gap-4\">\n        <div \n          v-if=\"articleForm.cover\"\n          class=\"relative w-48 h-32 rounded-lg overflow-hidden group\"\n        >\n          <img \n            :src=\"articleForm.cover\" \n            class=\"w-full h-full object-cover\"\n          >\n          <div \n            class=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\"\n          >\n            <button \n              class=\"text-white text-sm\"\n              @click=\"articleForm.cover = ''\"\n            >\n              删除封面\n            </button>\n          </div>\n        </div>\n        <div v-else>\n          <button \n            class=\"w-48 h-32 rounded-lg border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors flex flex-col items-center justify-center gap-2\"\n            @click=\"uploadCover\"\n          >\n            <PhotoIcon class=\"w-6 h-6 text-gray-400\" />\n            <span class=\"text-sm text-gray-500\">点击上传封面</span>\n          </button>\n          <input\n            ref=\"coverInput\"\n            type=\"file\"\n            accept=\"image/*\"\n            class=\"hidden\"\n            @change=\"handleCoverChange\"\n          >\n        </div>\n      </div>\n    </div>\n\n    <!-- 文章内容 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章内容</label>\n      <div class=\"border rounded-lg border-gray-300\">\n        <Toolbar\n          :editor=\"editorRef\"\n          :defaultConfig=\"toolbarConfig\"\n          mode=\"default\"\n          style=\"border-bottom: 1px solid #e5e7eb\"\n        />\n        <Editor\n          v-model=\"articleForm.content\"\n          :defaultConfig=\"editorConfig\"\n          mode=\"default\"\n          @onCreated=\"handleCreated\"\n          style=\"height: 500px\"\n        />\n      </div>\n    </div>\n\n    <!-- 标签 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">添加标签</label>\n      <div class=\"flex flex-wrap gap-2\">\n        <div\n          v-for=\"tag in articleForm.tags\"\n          :key=\"tag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm flex items-center group\"\n        >\n          <span>{{ tag }}</span>\n          <XMarkIcon \n            class=\"w-4 h-4 ml-1 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity\"\n            @click=\"removeTag(tag)\"\n          />\n        </div>\n        <input\n          v-if=\"articleForm.tags.length < 5\"\n          type=\"text\"\n          v-model=\"newTag\"\n          @keydown.enter=\"addTag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-violet-500\"\n          placeholder=\"按回车添加标签\"\n        >\n      </div>\n      <p class=\"mt-1 text-xs text-gray-500\">最多添加 5 个标签</p>\n    </div>\n\n    <!-- 发布按钮 -->\n    <div class=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 lg:px-8 py-4 z-50\">\n      <div class=\"max-w-4xl mx-auto flex items-center\">\n        <!-- 草稿状态提示 -->\n        <span \n          v-if=\"lastSavedTime\" \n          class=\"text-sm text-gray-500\"\n        >\n          {{ lastSavedTime }} 已保存草稿\n        </span>\n        <div class=\"flex-1\"></div>\n        <button \n          class=\"px-6 h-10 border border-violet-600 text-violet-600 rounded-lg hover:bg-violet-50 transition-colors\"\n          @click=\"saveDraft\"\n        >\n          保存草稿\n        </button>\n        <button \n          class=\"ml-4 px-6 h-10 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors\"\n          @click=\"submitArticle\"\n        >\n          发布文章\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, shallowRef, onBeforeUnmount, watch, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\nimport { \n  PhotoIcon, \n  XMarkIcon, \n  ChevronUpDownIcon, \n  CheckIcon,\n  CodeBracketIcon,\n  ServerIcon,\n  DevicePhoneMobileIcon,\n  ChartBarIcon,\n  DatabaseIcon,\n  CpuChipIcon,\n  BeakerIcon\n} from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\nimport { Listbox, ListboxButton, ListboxOptions, ListboxOption } from '@headlessui/vue'\n\n// 引入编辑器样式\nimport '@wangeditor/editor/dist/css/style.css'\n\nconst router = useRouter()\n\n// 编辑器实例，必须用 shallowRef\nconst editorRef = shallowRef()\n\n// 编辑器配置\nconst toolbarConfig = {\n  excludeKeys: [\n    'group-video',\n    'insertTable',\n    'group-indent',\n    'headerSelect'\n  ]\n}\n\nconst editorConfig = {\n  placeholder: '请输入文章内容...',\n  MENU_CONF: {\n    uploadImage: {\n      server: '/api/upload/image',\n      fieldName: 'image',\n      maxFileSize: 10 * 1024 * 1024, // 10M\n      maxNumberOfFiles: 10,\n      allowedFileTypes: ['image/*'],\n      metaWithUrl: true,\n      customInsert(res, insertFn) {\n        // res 即服务端返回的数据\n        insertFn(res.url, res.alt, res.href)\n      },\n    },\n    codeSelectLang: {\n      codeLangs: [\n        { text: 'JavaScript', value: 'javascript' },\n        { text: 'TypeScript', value: 'typescript' },\n        { text: 'HTML', value: 'html' },\n        { text: 'CSS', value: 'css' },\n        { text: 'Vue', value: 'vue' },\n        { text: 'Python', value: 'python' },\n        { text: 'Java', value: 'java' },\n        { text: 'Go', value: 'go' },\n        { text: 'SQL', value: 'sql' },\n        { text: 'Shell', value: 'shell' }\n      ]\n    }\n  }\n}\n\n// 组件销毁时，也及时销毁编辑器\nonBeforeUnmount(() => {\n  const editor = editorRef.value\n  if (editor == null) return\n  editor.destroy()\n})\n\nconst handleCreated = (editor) => {\n  editorRef.value = editor\n}\n\n// 文章表单数据\nconst articleForm = ref({\n  title: '',\n  category: '',\n  cover: '',\n  content: '',\n  tags: []\n})\n\n// 标签相关\nconst newTag = ref('')\n\nconst addTag = () => {\n  const tag = newTag.value.trim()\n  if (tag && !articleForm.value.tags.includes(tag) && articleForm.value.tags.length < 5) {\n    articleForm.value.tags.push(tag)\n    newTag.value = ''\n  }\n}\n\nconst removeTag = (tag) => {\n  articleForm.value.tags = articleForm.value.tags.filter(t => t !== tag)\n}\n\n// 封面图上传\nconst coverInput = ref(null)\n\nconst uploadCover = () => {\n  coverInput.value.click()\n}\n\nconst handleCoverChange = (e) => {\n  const file = e.target.files[0]\n  if (!file) return\n\n  // TODO: 调用上传接口\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    articleForm.value.cover = e.target.result\n  }\n  reader.readAsDataURL(file)\n}\n\n// 草稿相关\nconst DRAFT_KEY = 'article_draft'\nconst lastSavedTime = ref('')\nconst autoSaveTimer = ref(null)\n\n// 格式化时间\nconst formatTime = (date) => {\n  const now = new Date()\n  const diff = now - date\n  \n  if (diff < 60000) { // 小于1分钟\n    return '刚刚'\n  } else if (diff < 3600000) { // 小于1小时\n    return `${Math.floor(diff / 60000)}分钟前`\n  } else if (diff < 86400000) { // 小于24小时\n    return `${Math.floor(diff / 3600000)}小时前`\n  } else {\n    return date.toLocaleString()\n  }\n}\n\n// 保存草稿\nconst saveDraft = () => {\n  const draft = {\n    ...articleForm.value,\n    savedAt: new Date().toISOString()\n  }\n  localStorage.setItem(DRAFT_KEY, JSON.stringify(draft))\n  lastSavedTime.value = formatTime(new Date())\n  showToast('草稿已保存', 'success')\n}\n\n// 加载草稿\nconst loadDraft = () => {\n  const draft = localStorage.getItem(DRAFT_KEY)\n  if (draft) {\n    const data = JSON.parse(draft)\n    articleForm.value = {\n      title: data.title || '',\n      category: data.category || '',\n      cover: data.cover || '',\n      content: data.content || '',\n      tags: data.tags || []\n    }\n    if (data.category) {\n      selectedCategory.value = categories.find(c => c.id === data.category) || categories[0]\n    }\n    lastSavedTime.value = formatTime(new Date(data.savedAt))\n  }\n}\n\n// 自动保存\nconst startAutoSave = () => {\n  autoSaveTimer.value = setInterval(() => {\n    if (articleForm.value.title || articleForm.value.content) {\n      saveDraft()\n    }\n  }, 60000) // 每分钟自动保存\n}\n\n// 清除草稿\nconst clearDraft = () => {\n  localStorage.removeItem(DRAFT_KEY)\n  lastSavedTime.value = ''\n}\n\n// 组件挂载时加载草稿并开启自动保存\nonMounted(() => {\n  loadDraft()\n  startAutoSave()\n})\n\n// 组件销毁时清除定时器\nonBeforeUnmount(() => {\n  if (autoSaveTimer.value) {\n    clearInterval(autoSaveTimer.value)\n  }\n})\n\n// 提交文章\nconst submitArticle = () => {\n  // 表单验证\n  if (!articleForm.value.title) {\n    showToast('请输入文章标题', 'warning')\n    return\n  }\n  if (!articleForm.value.category) {\n    showToast('请选择文章分类', 'warning')\n    return\n  }\n  if (!articleForm.value.content) {\n    showToast('请输入文章内容', 'warning')\n    return\n  }\n\n  // TODO: 调用接口提交文章\n  console.log('提交文章:', articleForm.value)\n  clearDraft() // 发布成功后清除草稿\n  showToast('发布成功', 'success')\n  router.push('/community/articles')\n}\n\n// 分类数据\nconst categories = [\n  { id: 'frontend', name: '前端开发', icon: CodeBracketIcon },\n  { id: 'backend', name: '后端开发', icon: ServerIcon },\n  { id: 'mobile', name: '移动开发', icon: DevicePhoneMobileIcon },\n  { id: 'algorithm', name: '算法', icon: ChartBarIcon },\n  { id: 'database', name: '数据库', icon: DatabaseIcon },\n  { id: 'devops', name: '运维', icon: CpuChipIcon },\n  { id: 'ai', name: '人工智能', icon: BeakerIcon }\n]\n\n// 选中的分类\nconst selectedCategory = ref(categories[0])\n\n// 监听分类变化，更新表单数据\nwatch(selectedCategory, (category) => {\n  articleForm.value.category = category.id\n})\n</script>\n\n<style>\n.w-e-bar {\n  padding: 0 8px !important;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}