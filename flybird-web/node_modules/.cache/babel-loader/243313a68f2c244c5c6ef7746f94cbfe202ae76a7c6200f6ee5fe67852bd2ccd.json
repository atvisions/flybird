{"ast":null,"code":"import { reactive } from 'vue';\nimport { useStore } from 'vuex';\nimport { user } from '@/api/user';\nimport { showToast } from '@/components/ToastMessage';\nexport function useNickname() {\n  const store = useStore();\n  const state = reactive({\n    value: '',\n    loading: false,\n    error: ''\n  });\n\n  // 昵称验证规则\n  const validateNickname = nickname => {\n    if (!nickname || !nickname.trim()) {\n      return '昵称不能为空';\n    }\n    // 长度检查：4-8个字符\n    if (nickname.length < 4 || nickname.length > 8) {\n      return '昵称长度需要在4-8个字符之间';\n    }\n\n    // 字符类型检查：只允许中文、数字、英文字母\n    if (!/^[\\u4e00-\\u9fa5a-zA-Z0-9]+$/.test(nickname)) {\n      return '昵称只能包含中文、数字、英文字母';\n    }\n    return '';\n  };\n  const handleUpdate = async () => {\n    // 验证昵称\n    const error = validateNickname(state.value);\n    if (error) {\n      state.error = error;\n      showToast(error, 'error');\n      return false;\n    }\n    state.loading = true;\n    state.error = '';\n    try {\n      await user.updateUsername({\n        username: state.value\n      });\n      await store.dispatch('fetchUserInfo');\n      showToast('昵称修改成功', 'success');\n      return true;\n    } catch (error) {\n      const errorMsg = error.response?.data?.message || '修改失败';\n      state.error = errorMsg;\n      showToast(errorMsg, 'error');\n      return false;\n    } finally {\n      state.loading = false;\n    }\n  };\n  return {\n    state,\n    handleUpdate,\n    validateNickname\n  };\n}","map":{"version":3,"names":["reactive","useStore","user","showToast","useNickname","store","state","value","loading","error","validateNickname","nickname","trim","length","test","handleUpdate","updateUsername","username","dispatch","errorMsg","response","data","message"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/composables/useNickname.js"],"sourcesContent":["import { reactive } from 'vue'\nimport { useStore } from 'vuex'\nimport { user } from '@/api/user'\nimport { showToast } from '@/components/ToastMessage'\n\nexport function useNickname() {\n  const store = useStore()\n  const state = reactive({\n    value: '',\n    loading: false,\n    error: ''\n  })\n\n  // 昵称验证规则\n  const validateNickname = (nickname) => {\n    if (!nickname || !nickname.trim()) {\n      return '昵称不能为空'\n    }\n    // 长度检查：4-8个字符\n    if (nickname.length < 4 || nickname.length > 8) {\n      return '昵称长度需要在4-8个字符之间'\n    }\n    \n    // 字符类型检查：只允许中文、数字、英文字母\n    if (!/^[\\u4e00-\\u9fa5a-zA-Z0-9]+$/.test(nickname)) {\n      return '昵称只能包含中文、数字、英文字母'\n    }\n    \n    return ''\n  }\n\n  const handleUpdate = async () => {\n    // 验证昵称\n    const error = validateNickname(state.value)\n    if (error) {\n      state.error = error\n      showToast(error, 'error')\n      return false\n    }\n\n    state.loading = true\n    state.error = ''\n    \n    try {\n      await user.updateUsername({ username: state.value })\n      await store.dispatch('fetchUserInfo')\n      showToast('昵称修改成功', 'success')\n      return true\n    } catch (error) {\n      const errorMsg = error.response?.data?.message || '修改失败'\n      state.error = errorMsg\n      showToast(errorMsg, 'error')\n      return false\n    } finally {\n      state.loading = false\n    }\n  }\n\n  return {\n    state,\n    handleUpdate,\n    validateNickname\n  }\n} "],"mappings":"AAAA,SAASA,QAAQ,QAAQ,KAAK;AAC9B,SAASC,QAAQ,QAAQ,MAAM;AAC/B,SAASC,IAAI,QAAQ,YAAY;AACjC,SAASC,SAAS,QAAQ,2BAA2B;AAErD,OAAO,SAASC,WAAWA,CAAA,EAAG;EAC5B,MAAMC,KAAK,GAAGJ,QAAQ,CAAC,CAAC;EACxB,MAAMK,KAAK,GAAGN,QAAQ,CAAC;IACrBO,KAAK,EAAE,EAAE;IACTC,OAAO,EAAE,KAAK;IACdC,KAAK,EAAE;EACT,CAAC,CAAC;;EAEF;EACA,MAAMC,gBAAgB,GAAIC,QAAQ,IAAK;IACrC,IAAI,CAACA,QAAQ,IAAI,CAACA,QAAQ,CAACC,IAAI,CAAC,CAAC,EAAE;MACjC,OAAO,QAAQ;IACjB;IACA;IACA,IAAID,QAAQ,CAACE,MAAM,GAAG,CAAC,IAAIF,QAAQ,CAACE,MAAM,GAAG,CAAC,EAAE;MAC9C,OAAO,iBAAiB;IAC1B;;IAEA;IACA,IAAI,CAAC,6BAA6B,CAACC,IAAI,CAACH,QAAQ,CAAC,EAAE;MACjD,OAAO,kBAAkB;IAC3B;IAEA,OAAO,EAAE;EACX,CAAC;EAED,MAAMI,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B;IACA,MAAMN,KAAK,GAAGC,gBAAgB,CAACJ,KAAK,CAACC,KAAK,CAAC;IAC3C,IAAIE,KAAK,EAAE;MACTH,KAAK,CAACG,KAAK,GAAGA,KAAK;MACnBN,SAAS,CAACM,KAAK,EAAE,OAAO,CAAC;MACzB,OAAO,KAAK;IACd;IAEAH,KAAK,CAACE,OAAO,GAAG,IAAI;IACpBF,KAAK,CAACG,KAAK,GAAG,EAAE;IAEhB,IAAI;MACF,MAAMP,IAAI,CAACc,cAAc,CAAC;QAAEC,QAAQ,EAAEX,KAAK,CAACC;MAAM,CAAC,CAAC;MACpD,MAAMF,KAAK,CAACa,QAAQ,CAAC,eAAe,CAAC;MACrCf,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC;MAC9B,OAAO,IAAI;IACb,CAAC,CAAC,OAAOM,KAAK,EAAE;MACd,MAAMU,QAAQ,GAAGV,KAAK,CAACW,QAAQ,EAAEC,IAAI,EAAEC,OAAO,IAAI,MAAM;MACxDhB,KAAK,CAACG,KAAK,GAAGU,QAAQ;MACtBhB,SAAS,CAACgB,QAAQ,EAAE,OAAO,CAAC;MAC5B,OAAO,KAAK;IACd,CAAC,SAAS;MACRb,KAAK,CAACE,OAAO,GAAG,KAAK;IACvB;EACF,CAAC;EAED,OAAO;IACLF,KAAK;IACLS,YAAY;IACZL;EACF,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}