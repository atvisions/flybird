{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, Fragment as _Fragment, normalizeClass as _normalizeClass, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  key: 2,\n  class: \"image-wrapper\"\n};\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  key: 0,\n  class: \"binding-indicator\"\n};\nconst _hoisted_4 = {\n  key: 3,\n  class: \"text-wrapper\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"binding-indicator\"\n};\nconst _hoisted_6 = {\n  class: \"field-label\"\n};\nconst _hoisted_7 = {\n  class: \"field-placeholder\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"design-element\", {\n      selected: $props.isSelected\n    }]),\n    style: _normalizeStyle($setup.elementStyle),\n    onMousedown: _withModifiers($setup.handleMouseDown, [\"stop\"])\n  }, [_createCommentVNode(\" 形状元素 \"), $props.element.type === 'shape' ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"shape\",\n    style: _normalizeStyle(_ctx.shapeStyle)\n  }, null, 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 图标元素 \"), $props.element.type === 'icon' ? (_openBlock(), _createBlock(_component_v_icon, {\n    key: 1,\n    icon: $props.element.icon,\n    style: _normalizeStyle(_ctx.iconStyle)\n  }, null, 8 /* PROPS */, [\"icon\", \"style\"])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 图片元素 \"), $props.element.type === 'image' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"img\", {\n    src: $props.element.content || $props.element.placeholder,\n    style: _normalizeStyle($setup.imageStyle),\n    draggable: \"false\"\n  }, null, 12 /* STYLE, PROPS */, _hoisted_2), $props.element.dataBinding ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \" 已绑定: \" + _toDisplayString($props.element.dataBinding.field), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 文本元素 \"), $props.element.type === 'text' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n    class: \"text\",\n    style: _normalizeStyle(_ctx.textStyle)\n  }, _toDisplayString($props.element.content || $props.element.placeholder), 5 /* TEXT, STYLE */), $props.element.dataBinding ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \" 已绑定: \" + _toDisplayString($props.element.dataBinding.field), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 数据字段元素 \"), $props.element.type === 'data-field' ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 4,\n    class: \"data-field\",\n    style: _normalizeStyle(_ctx.dataFieldStyle)\n  }, [_createElementVNode(\"div\", _hoisted_6, _toDisplayString($setup.getFieldLabel($props.element.dataField)), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_7, _toDisplayString($setup.getFieldPlaceholder($props.element.dataField)), 1 /* TEXT */)], 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 调整大小的手柄 \"), $props.isSelected ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 5\n  }, [_createElementVNode(\"div\", {\n    class: \"resize-handle tl\",\n    onMousedown: _cache[0] || (_cache[0] = _withModifiers($event => $setup.startResize('tl'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle tr\",\n    onMousedown: _cache[1] || (_cache[1] = _withModifiers($event => $setup.startResize('tr'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle bl\",\n    onMousedown: _cache[2] || (_cache[2] = _withModifiers($event => $setup.startResize('bl'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"resize-handle br\",\n    onMousedown: _cache[3] || (_cache[3] = _withModifiers($event => $setup.startResize('br'), [\"stop\"]))\n  }, null, 32 /* NEED_HYDRATION */), _createCommentVNode(\" 旋转手柄 \"), _createElementVNode(\"div\", {\n    class: \"rotate-handle\",\n    onMousedown: _withModifiers($setup.startRotate, [\"stop\"])\n  }, null, 32 /* NEED_HYDRATION */)], 64 /* STABLE_FRAGMENT */)) : _createCommentVNode(\"v-if\", true)], 38 /* CLASS, STYLE, NEED_HYDRATION */)), [[$setup[\"vDraggable\"], {\n    onDrag: $setup.handleDrag,\n    onDragEnd: $setup.handleDragEnd\n  }]]);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_normalizeClass","selected","$props","isSelected","style","_normalizeStyle","$setup","elementStyle","onMousedown","_withModifiers","handleMouseDown","_createCommentVNode","element","type","_ctx","shapeStyle","_createBlock","_component_v_icon","icon","iconStyle","_hoisted_1","_createElementVNode","src","content","placeholder","imageStyle","draggable","_hoisted_2","dataBinding","_hoisted_3","_toDisplayString","field","_hoisted_4","textStyle","_hoisted_5","dataFieldStyle","_hoisted_6","getFieldLabel","dataField","_hoisted_7","getFieldPlaceholder","_Fragment","_cache","$event","startResize","startRotate","handleDrag","handleDragEnd"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/DesignElement.vue"],"sourcesContent":["<template>\n  <div \n    class=\"design-element\"\n    :class=\"{ selected: isSelected }\"\n    :style=\"elementStyle\"\n    @mousedown.stop=\"handleMouseDown\"\n    v-draggable=\"{\n      onDrag: handleDrag,\n      onDragEnd: handleDragEnd\n    }\"\n  >\n    <!-- 形状元素 -->\n    <template v-if=\"element.type === 'shape'\">\n      <div class=\"shape\" :style=\"shapeStyle\"></div>\n    </template>\n\n    <!-- 图标元素 -->\n    <template v-if=\"element.type === 'icon'\">\n      <v-icon :icon=\"element.icon\" :style=\"iconStyle\"></v-icon>\n    </template>\n\n    <!-- 图片元素 -->\n    <template v-if=\"element.type === 'image'\">\n      <div class=\"image-wrapper\">\n        <img \n          :src=\"element.content || element.placeholder\" \n          :style=\"imageStyle\"\n          draggable=\"false\"\n        >\n        <div v-if=\"element.dataBinding\" class=\"binding-indicator\">\n          已绑定: {{ element.dataBinding.field }}\n        </div>\n      </div>\n    </template>\n\n    <!-- 文本元素 -->\n    <template v-if=\"element.type === 'text'\">\n      <div class=\"text-wrapper\">\n        <div class=\"text\" :style=\"textStyle\">\n          {{ element.content || element.placeholder }}\n        </div>\n        <div v-if=\"element.dataBinding\" class=\"binding-indicator\">\n          已绑定: {{ element.dataBinding.field }}\n        </div>\n      </div>\n    </template>\n\n    <!-- 数据字段元素 -->\n    <template v-if=\"element.type === 'data-field'\">\n      <div class=\"data-field\" :style=\"dataFieldStyle\">\n        <div class=\"field-label\">{{ getFieldLabel(element.dataField) }}</div>\n        <div class=\"field-placeholder\">\n          {{ getFieldPlaceholder(element.dataField) }}\n        </div>\n      </div>\n    </template>\n\n    <!-- 调整大小的手柄 -->\n    <template v-if=\"isSelected\">\n      <div class=\"resize-handle tl\" @mousedown.stop=\"startResize('tl')\"></div>\n      <div class=\"resize-handle tr\" @mousedown.stop=\"startResize('tr')\"></div>\n      <div class=\"resize-handle bl\" @mousedown.stop=\"startResize('bl')\"></div>\n      <div class=\"resize-handle br\" @mousedown.stop=\"startResize('br')\"></div>\n      <!-- 旋转手柄 -->\n      <div class=\"rotate-handle\" @mousedown.stop=\"startRotate\"></div>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed } from 'vue'\nimport { vDraggable } from '../../../directives/draggable'\n\nconst props = defineProps({\n  element: {\n    type: Object,\n    required: true\n  },\n  isSelected: {\n    type: Boolean,\n    default: false\n  },\n  scale: {\n    type: Number,\n    default: 1\n  }\n})\n\nconst emit = defineEmits(['select', 'update'])\n\n// 处理鼠标按下事件\nconst handleMouseDown = (e) => {\n  e.stopPropagation()\n  emit('select', props.element)\n}\n\n// 处理拖拽\nconst handleDrag = (event, { deltaX, deltaY }) => {\n  emit('update', {\n    ...props.element,\n    x: props.element.x + deltaX,\n    y: props.element.y + deltaY\n  })\n}\n\n// 处理拖拽结束\nconst handleDragEnd = () => {\n  // 可以在这里添加拖拽结束后的逻辑\n}\n\n// 元素基础样式\nconst elementStyle = computed(() => ({\n  transform: `translate(${props.element.x}px, ${props.element.y}px) rotate(${props.element.rotation || 0}deg)`,\n  width: `${props.element.width}px`,\n  height: `${props.element.height}px`,\n  ...props.element.styles\n}))\n\n// 图片样式\nconst imageStyle = computed(() => ({\n  width: '100%',\n  height: '100%',\n  objectFit: 'cover',\n  borderRadius: props.element.styles?.borderRadius\n}))\n\n// 获取字段标签\nconst getFieldLabel = (dataField) => {\n  const labels = {\n    profile: {\n      avatar: '头像',\n      name: '姓名',\n      email: '邮箱',\n      phone: '电话'\n    },\n    education: {\n      school: '学校',\n      major: '专业',\n      degree: '学位'\n    }\n    // ... 其他字段映射\n  }\n  return labels[dataField.type]?.[dataField.field] || dataField.field\n}\n\n// 获取字段占位符\nconst getFieldPlaceholder = (dataField) => {\n  const placeholders = {\n    profile: {\n      avatar: '[头像]',\n      name: '[姓名]',\n      email: '[邮箱]',\n      phone: '[电话]'\n    }\n    // ... 其他占位符\n  }\n  return placeholders[dataField.type]?.[dataField.field] || '[数据]'\n}\n\n// 拖拽配置\nconst dragOptions = {\n  onDrag: (event, { deltaX, deltaY }) => {\n    emit('update', {\n      ...props.element,\n      x: props.element.x + deltaX,\n      y: props.element.y + deltaY\n    })\n  }\n}\n\n// 处理缩放\nconst startResize = (handle) => {\n  const handleMouseMove = (e) => {\n    e.preventDefault()\n    const rect = e.currentTarget.getBoundingClientRect()\n    const scale = props.scale || 1\n    \n    // 计算鼠标位置相对于元素的偏移\n    const mouseX = (e.clientX - rect.left) / scale\n    const mouseY = (e.clientY - rect.top) / scale\n    \n    // 根据不同的调整手柄计算新的尺寸和位置\n    let newWidth = props.element.width\n    let newHeight = props.element.height\n    let newX = props.element.x\n    let newY = props.element.y\n    \n    switch (handle) {\n      case 'br':\n        newWidth = mouseX - props.element.x\n        newHeight = mouseY - props.element.y\n        break\n      case 'bl':\n        newWidth = props.element.width + (props.element.x - mouseX)\n        newHeight = mouseY - props.element.y\n        newX = mouseX\n        break\n      case 'tr':\n        newWidth = mouseX - props.element.x\n        newHeight = props.element.height + (props.element.y - mouseY)\n        newY = mouseY\n        break\n      case 'tl':\n        newWidth = props.element.width + (props.element.x - mouseX)\n        newHeight = props.element.height + (props.element.y - mouseY)\n        newX = mouseX\n        newY = mouseY\n        break\n    }\n    \n    // 确保尺寸不小于最小值\n    newWidth = Math.max(20, newWidth)\n    newHeight = Math.max(20, newHeight)\n    \n    // 发送更新事件\n    emit('update', {\n      ...props.element,\n      width: newWidth,\n      height: newHeight,\n      x: newX,\n      y: newY\n    })\n  }\n  \n  const handleMouseUp = () => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n}\n\n// 处理旋转\nconst startRotate = (e) => {\n  e.preventDefault()\n  const elementRect = e.currentTarget.getBoundingClientRect()\n  const elementCenterX = elementRect.left + elementRect.width / 2\n  const elementCenterY = elementRect.top + elementRect.height / 2\n  \n  const handleMouseMove = (e) => {\n    // 计算鼠标位置相对于元素中心的角度\n    const angle = Math.atan2(\n      e.clientY - elementCenterY,\n      e.clientX - elementCenterX\n    ) * (180 / Math.PI)\n    \n    // 发送更新事件\n    emit('update', {\n      ...props.element,\n      rotation: angle + 90 // 加90度使0度对应垂直向上\n    })\n  }\n  \n  const handleMouseUp = () => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n}\n</script>\n\n<style scoped>\n.design-element {\n  position: absolute;\n  cursor: move;\n}\n\n.design-element.selected {\n  outline: 2px solid #1867C0;\n}\n\n.resize-handle {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: #fff;\n  border: 1px solid #1867C0;\n  border-radius: 50%;\n}\n\n.resize-handle.tl { top: -4px; left: -4px; cursor: nw-resize; }\n.resize-handle.tr { top: -4px; right: -4px; cursor: ne-resize; }\n.resize-handle.bl { bottom: -4px; left: -4px; cursor: sw-resize; }\n.resize-handle.br { bottom: -4px; right: -4px; cursor: se-resize; }\n\n.rotate-handle {\n  position: absolute;\n  top: -20px;\n  left: 50%;\n  width: 8px;\n  height: 8px;\n  background: #1867C0;\n  border-radius: 50%;\n  transform: translateX(-50%);\n  cursor: grab;\n}\n\n.data-field {\n  padding: 8px;\n  border: 1px dashed #999;\n  border-radius: 4px;\n}\n\n.field-label {\n  font-size: 12px;\n  color: #666;\n  margin-bottom: 4px;\n}\n\n.field-placeholder {\n  color: #999;\n  font-style: italic;\n}\n\n.binding-indicator {\n  position: absolute;\n  top: -20px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: rgba(24, 103, 192, 0.9);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n  white-space: nowrap;\n}\n\n.image-wrapper, .text-wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}