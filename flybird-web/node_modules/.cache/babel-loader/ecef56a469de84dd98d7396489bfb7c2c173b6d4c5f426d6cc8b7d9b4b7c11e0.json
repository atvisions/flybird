{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { ref, watch } from 'vue';\nimport { Dialog, DialogPanel, DialogTitle, TransitionRoot, TransitionChild } from '@headlessui/vue';\nimport { XMarkIcon } from '@heroicons/vue/24/outline';\nexport default {\n  __name: 'EditCertificateDialog',\n  props: {\n    modelValue: Boolean,\n    initialData: {\n      type: Object,\n      default: () => ({})\n    },\n    loading: Boolean\n  },\n  emits: ['update:modelValue', 'submit'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n\n    // 表单数据\n    const form = ref({\n      id: null,\n      name: '',\n      issuing_authority: '',\n      issue_date: '',\n      expiry_date: '',\n      credential_id: '',\n      description: ''\n    });\n\n    // 错误状态\n    const errors = ref({\n      name: '',\n      issuing_authority: '',\n      issue_date: '',\n      expiry_date: '',\n      credential_id: '',\n      description: ''\n    });\n\n    // 监听初始数据变化\n    watch(() => props.initialData, newVal => {\n      if (newVal) {\n        form.value = {\n          id: newVal.id || null,\n          name: newVal.name || '',\n          issuing_authority: newVal.issuing_authority || '',\n          issue_date: newVal.issue_date || '',\n          expiry_date: newVal.expiry_date || '',\n          credential_id: newVal.credential_id || '',\n          description: newVal.description || ''\n        };\n      }\n    }, {\n      immediate: true,\n      deep: true\n    });\n    const handleClose = () => {\n      emit('update:modelValue', false);\n    };\n\n    // 验证表单\n    const validateForm = () => {\n      let isValid = true;\n      errors.value = {\n        name: '',\n        issuing_authority: '',\n        issue_date: '',\n        expiry_date: '',\n        credential_id: '',\n        description: ''\n      };\n\n      // 必填字段验证\n      if (!form.value.name?.trim()) {\n        errors.value.name = '请输入证书名称';\n        isValid = false;\n      }\n      if (!form.value.issuing_authority?.trim()) {\n        errors.value.issuing_authority = '请输入颁发机构';\n        isValid = false;\n      }\n      if (!form.value.issue_date) {\n        errors.value.issue_date = '请选择颁发日期';\n        isValid = false;\n      }\n\n      // 日期逻辑验证\n      if (form.value.issue_date && form.value.expiry_date) {\n        const issueDate = new Date(form.value.issue_date);\n        const expiryDate = new Date(form.value.expiry_date);\n        if (expiryDate < issueDate) {\n          errors.value.expiry_date = '到期日期不能早于颁发日期';\n          isValid = false;\n        }\n      }\n      return isValid;\n    };\n\n    // 提交处理\n    const handleSubmit = () => {\n      if (!validateForm()) {\n        return;\n      }\n      const formData = _objectSpread(_objectSpread({}, form.value), {}, {\n        name: form.value.name.trim(),\n        issuing_authority: form.value.issuing_authority.trim(),\n        description: form.value.description?.trim() || ''\n      });\n\n      // 如果是新建，不传 id\n      if (!formData.id) {\n        delete formData.id;\n      }\n      emit('submit', formData);\n    };\n    const __returned__ = {\n      props,\n      emit,\n      form,\n      errors,\n      handleClose,\n      validateForm,\n      handleSubmit,\n      ref,\n      watch,\n      get Dialog() {\n        return Dialog;\n      },\n      get DialogPanel() {\n        return DialogPanel;\n      },\n      get DialogTitle() {\n        return DialogTitle;\n      },\n      get TransitionRoot() {\n        return TransitionRoot;\n      },\n      get TransitionChild() {\n        return TransitionChild;\n      },\n      get XMarkIcon() {\n        return XMarkIcon;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","Dialog","DialogPanel","DialogTitle","TransitionRoot","TransitionChild","XMarkIcon","props","__props","emit","__emit","form","id","name","issuing_authority","issue_date","expiry_date","credential_id","description","errors","initialData","newVal","value","immediate","deep","handleClose","validateForm","isValid","trim","issueDate","Date","expiryDate","handleSubmit","formData","_objectSpread"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/user/MyProfile/dialogs/EditCertificateDialog.vue"],"sourcesContent":["<template>\n  <TransitionRoot appear :show=\"modelValue\" as=\"template\">\n    <Dialog as=\"div\" class=\"relative z-50\" @close=\"handleClose\">\n      <!-- 背景遮罩 -->\n      <TransitionChild\n        as=\"template\"\n        enter=\"duration-300 ease-out\"\n        enter-from=\"opacity-0\"\n        enter-to=\"opacity-100\"\n        leave=\"duration-200 ease-in\"\n        leave-from=\"opacity-100\"\n        leave-to=\"opacity-0\"\n      >\n        <div class=\"fixed inset-0 bg-black/25\" />\n      </TransitionChild>\n\n      <!-- 对话框 -->\n      <div class=\"fixed inset-0 overflow-y-auto\">\n        <div class=\"flex min-h-full items-center justify-center p-4 text-center\">\n          <TransitionChild\n            as=\"template\"\n            enter=\"duration-300 ease-out\"\n            enter-from=\"opacity-0 scale-95\"\n            enter-to=\"opacity-100 scale-100\"\n            leave=\"duration-200 ease-in\"\n            leave-from=\"opacity-100 scale-100\"\n            leave-to=\"opacity-0 scale-95\"\n          >\n            <DialogPanel class=\"w-full max-w-2xl transform overflow-hidden rounded-xl bg-white text-left align-middle shadow-xl transition-all\">\n              <!-- 头部 -->\n              <DialogTitle \n                as=\"div\" \n                class=\"flex items-center justify-between border-b border-gray-200 px-6 py-4\"\n              >\n                <h3 class=\"text-lg font-medium text-gray-900\">\n                  {{ initialData?.id ? '编辑证书奖项' : '添加证书奖项' }}\n                </h3>\n                <button\n                  @click=\"handleClose\"\n                  class=\"rounded-full p-1 hover:bg-gray-100 transition-colors\"\n                >\n                  <XMarkIcon class=\"w-5 h-5 text-gray-400\" />\n                </button>\n              </DialogTitle>\n\n              <!-- 表单内容 -->\n              <form @submit.prevent=\"handleSubmit\" class=\"p-6\">\n                <div class=\"space-y-6\">\n                  <!-- 证书名称 -->\n                  <div class=\"space-y-1\">\n                    <label class=\"block text-sm font-medium text-gray-700\">\n                      证书名称 <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      v-model=\"form.name\"\n                      required\n                      :class=\"[\n                        'w-full rounded-lg border py-2.5 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10',\n                        errors.name ? 'border-red-300 focus:border-red-500' : 'border-gray-300 focus:border-blue-500'\n                      ]\"\n                      placeholder=\"请输入证书名称\"\n                    />\n                    <p v-if=\"errors.name\" class=\"text-sm text-red-500 mt-1\">{{ errors.name }}</p>\n                  </div>\n\n                  <!-- 颁发机构 -->\n                  <div class=\"space-y-1\">\n                    <label class=\"block text-sm font-medium text-gray-700\">\n                      颁发机构 <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      v-model=\"form.issuing_authority\"\n                      required\n                      :class=\"[\n                        'w-full rounded-lg border py-2.5 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10',\n                        errors.issuing_authority ? 'border-red-300 focus:border-red-500' : 'border-gray-300 focus:border-blue-500'\n                      ]\"\n                      placeholder=\"请输入颁发机构\"\n                    />\n                    <p v-if=\"errors.issuing_authority\" class=\"text-sm text-red-500 mt-1\">{{ errors.issuing_authority }}</p>\n                  </div>\n\n                  <!-- 日期选择 -->\n                  <div class=\"grid grid-cols-2 gap-4\">\n                    <!-- 颁发日期 -->\n                    <div class=\"space-y-1\">\n                      <label class=\"block text-sm font-medium text-gray-700\">\n                        颁发日期 <span class=\"text-red-500\">*</span>\n                      </label>\n                      <input\n                        type=\"date\"\n                        v-model=\"form.issue_date\"\n                        required\n                        :class=\"[\n                          'w-full rounded-lg border py-2.5 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10',\n                          errors.issue_date ? 'border-red-300 focus:border-red-500' : 'border-gray-300 focus:border-blue-500'\n                        ]\"\n                      />\n                      <p v-if=\"errors.issue_date\" class=\"text-sm text-red-500 mt-1\">{{ errors.issue_date }}</p>\n                    </div>\n\n                    <!-- 到期日期 -->\n                    <div class=\"space-y-1\">\n                      <label class=\"block text-sm font-medium text-gray-700\">\n                        到期日期\n                      </label>\n                      <input\n                        type=\"date\"\n                        v-model=\"form.expiry_date\"\n                        :class=\"[\n                          'w-full rounded-lg border py-2.5 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10',\n                          errors.expiry_date ? 'border-red-300 focus:border-red-500' : 'border-gray-300 focus:border-blue-500'\n                        ]\"\n                      />\n                      <p v-if=\"errors.expiry_date\" class=\"text-sm text-red-500 mt-1\">{{ errors.expiry_date }}</p>\n                    </div>\n                  </div>\n\n                  <!-- 证书编号 -->\n                  <div class=\"space-y-1\">\n                    <label class=\"block text-sm font-medium text-gray-700\">\n                      证书编号\n                    </label>\n                    <input\n                      type=\"text\"\n                      v-model=\"form.credential_id\"\n                      :class=\"[\n                        'w-full rounded-lg border py-2.5 px-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10',\n                        errors.credential_id ? 'border-red-300 focus:border-red-500' : 'border-gray-300 focus:border-blue-500'\n                      ]\"\n                      placeholder=\"请输入证书编号（选填）\"\n                    />\n                    <p v-if=\"errors.credential_id\" class=\"text-sm text-red-500 mt-1\">{{ errors.credential_id }}</p>\n                  </div>\n\n                  <!-- 证书描述 -->\n                  <div class=\"space-y-1\">\n                    <label class=\"block text-sm font-medium text-gray-700\">\n                      证书描述\n                    </label>\n                    <el-input\n                      v-model=\"form.description\"\n                      type=\"textarea\"\n                      :rows=\"4\"\n                      placeholder=\"请描述证书的相关信息（选填）\"\n                      :class=\"[\n                        '!w-full',\n                        errors.description ? 'is-error' : ''\n                      ]\"\n                    />\n                    <p v-if=\"errors.description\" class=\"text-sm text-red-500 mt-1\">{{ errors.description }}</p>\n                  </div>\n\n                  <!-- 底部按钮 -->\n                  <div class=\"flex justify-end space-x-3 pt-6\">\n                    <button\n                      type=\"button\"\n                      @click=\"handleClose\"\n                      class=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500\"\n                    >\n                      取消\n                    </button>\n                    <button\n                      type=\"submit\"\n                      :disabled=\"loading\"\n                      class=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {{ loading ? '保存中...' : '确认' }}\n                    </button>\n                  </div>\n                </div>\n              </form>\n            </DialogPanel>\n          </TransitionChild>\n        </div>\n      </div>\n    </Dialog>\n  </TransitionRoot>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport {\n  Dialog,\n  DialogPanel,\n  DialogTitle,\n  TransitionRoot,\n  TransitionChild\n} from '@headlessui/vue'\nimport { XMarkIcon } from '@heroicons/vue/24/outline'\n\nconst props = defineProps({\n  modelValue: Boolean,\n  initialData: {\n    type: Object,\n    default: () => ({})\n  },\n  loading: Boolean\n})\n\nconst emit = defineEmits(['update:modelValue', 'submit'])\n\n// 表单数据\nconst form = ref({\n  id: null,\n  name: '',\n  issuing_authority: '',\n  issue_date: '',\n  expiry_date: '',\n  credential_id: '',\n  description: ''\n})\n\n// 错误状态\nconst errors = ref({\n  name: '',\n  issuing_authority: '',\n  issue_date: '',\n  expiry_date: '',\n  credential_id: '',\n  description: ''\n})\n\n// 监听初始数据变化\nwatch(() => props.initialData, (newVal) => {\n  if (newVal) {\n    form.value = {\n      id: newVal.id || null,\n      name: newVal.name || '',\n      issuing_authority: newVal.issuing_authority || '',\n      issue_date: newVal.issue_date || '',\n      expiry_date: newVal.expiry_date || '',\n      credential_id: newVal.credential_id || '',\n      description: newVal.description || ''\n    }\n  }\n}, { immediate: true, deep: true })\n\nconst handleClose = () => {\n  emit('update:modelValue', false)\n}\n\n// 验证表单\nconst validateForm = () => {\n  let isValid = true\n  errors.value = {\n    name: '',\n    issuing_authority: '',\n    issue_date: '',\n    expiry_date: '',\n    credential_id: '',\n    description: ''\n  }\n\n  // 必填字段验证\n  if (!form.value.name?.trim()) {\n    errors.value.name = '请输入证书名称'\n    isValid = false\n  }\n\n  if (!form.value.issuing_authority?.trim()) {\n    errors.value.issuing_authority = '请输入颁发机构'\n    isValid = false\n  }\n\n  if (!form.value.issue_date) {\n    errors.value.issue_date = '请选择颁发日期'\n    isValid = false\n  }\n\n  // 日期逻辑验证\n  if (form.value.issue_date && form.value.expiry_date) {\n    const issueDate = new Date(form.value.issue_date)\n    const expiryDate = new Date(form.value.expiry_date)\n    if (expiryDate < issueDate) {\n      errors.value.expiry_date = '到期日期不能早于颁发日期'\n      isValid = false\n    }\n  }\n\n  return isValid\n}\n\n// 提交处理\nconst handleSubmit = () => {\n  if (!validateForm()) {\n    return\n  }\n\n  const formData = {\n    ...form.value,\n    name: form.value.name.trim(),\n    issuing_authority: form.value.issuing_authority.trim(),\n    description: form.value.description?.trim() || ''\n  }\n\n  // 如果是新建，不传 id\n  if (!formData.id) {\n    delete formData.id\n  }\n\n  emit('submit', formData)\n}\n</script> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}