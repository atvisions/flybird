{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport { ref, computed, watch } from 'vue';\nimport draggable from 'vuedraggable';\nimport { useComponents } from '../composables/useComponents';\nexport default {\n  __name: 'SingleLayout',\n  props: {\n    config: {\n      type: Object,\n      required: true\n    }\n  },\n  emits: ['update:config'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const isDragOver = ref(false);\n    const components = ref(props.config.components || []);\n    const {\n      getComponentByType\n    } = useComponents();\n\n    // 计算布局样式\n    const layoutStyles = computed(() => {\n      const theme = props.config.styles?.colors || {};\n      const spacing = props.config.styles?.spacing || {};\n      return _objectSpread({\n        backgroundColor: theme.background || '#f5f7fa',\n        borderColor: theme.secondary || '#e4e7ed',\n        padding: spacing.unit || '16px',\n        gap: spacing.unit || '16px',\n        borderRadius: '8px',\n        '--primary-color': theme.primary || '#2c3e50',\n        '--accent-color': theme.accent || '#3498db',\n        '--text-color': theme.primary || '#2c3e50'\n      }, props.config.styles);\n    });\n\n    // 监听配置变化\n    watch(() => props.config, newConfig => {\n      components.value = newConfig.components || [];\n    }, {\n      deep: true\n    });\n\n    // 处理拖拽进入\n    const handleDragEnter = event => {\n      event.preventDefault();\n      isDragOver.value = true;\n    };\n\n    // 处理拖拽离开\n    const handleDragLeave = event => {\n      event.preventDefault();\n      isDragOver.value = false;\n    };\n\n    // 处理拖拽悬停\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n\n    // 处理组件放置\n    const handleDrop = event => {\n      event.preventDefault();\n      isDragOver.value = false;\n      const componentData = event.dataTransfer.getData('application/json');\n      if (componentData) {\n        try {\n          const component = JSON.parse(componentData);\n          if (component.type !== 'layout') {\n            addComponent(component);\n          }\n        } catch (error) {\n          console.error('解析组件数据失败:', error);\n        }\n      }\n    };\n\n    // 添加组件\n    const addComponent = component => {\n      const newComponent = {\n        id: Date.now(),\n        type: component.type,\n        name: component.name,\n        config: component.config || {}\n      };\n      components.value.push(newComponent);\n      updateConfig();\n    };\n\n    // 移除组件\n    const removeComponent = component => {\n      const index = components.value.findIndex(c => c.id === component.id);\n      if (index > -1) {\n        components.value.splice(index, 1);\n        updateConfig();\n      }\n    };\n\n    // 更新组件配置\n    const updateComponentConfig = (componentId, config) => {\n      const component = components.value.find(c => c.id === componentId);\n      if (component) {\n        component.config = config;\n        updateConfig();\n      }\n    };\n\n    // 处理组件变化\n    const handleComponentChange = event => {\n      updateConfig();\n    };\n\n    // 更新配置\n    const updateConfig = () => {\n      emit('update:config', _objectSpread(_objectSpread({}, props.config), {}, {\n        components: components.value\n      }));\n    };\n    const __returned__ = {\n      props,\n      emit,\n      isDragOver,\n      components,\n      getComponentByType,\n      layoutStyles,\n      handleDragEnter,\n      handleDragLeave,\n      handleDragOver,\n      handleDrop,\n      addComponent,\n      removeComponent,\n      updateComponentConfig,\n      handleComponentChange,\n      updateConfig,\n      ref,\n      computed,\n      watch,\n      get draggable() {\n        return draggable;\n      },\n      get useComponents() {\n        return useComponents;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","watch","draggable","useComponents","props","__props","emit","__emit","isDragOver","components","config","getComponentByType","layoutStyles","theme","styles","colors","spacing","_objectSpread","backgroundColor","background","borderColor","secondary","padding","unit","gap","borderRadius","primary","accent","newConfig","value","deep","handleDragEnter","event","preventDefault","handleDragLeave","handleDragOver","handleDrop","componentData","dataTransfer","getData","component","JSON","parse","type","addComponent","error","console","newComponent","id","Date","now","name","push","updateConfig","removeComponent","index","findIndex","c","splice","updateComponentConfig","componentId","find","handleComponentChange"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/layouts/SingleLayout.vue"],"sourcesContent":["<template>\n  <div class=\"single-layout\">\n    <div class=\"layout-column\"\n      :class=\"{ 'drag-over': isDragOver }\"\n      :style=\"layoutStyles\"\n      @dragenter=\"handleDragEnter\"\n      @dragleave=\"handleDragLeave\"\n      @dragover=\"handleDragOver\"\n      @drop=\"handleDrop\">\n      \n      <draggable\n        v-model=\"components\"\n        :group=\"{ name: 'components', pull: true, put: true }\"\n        item-key=\"id\"\n        class=\"component-list\"\n        :class=\"{ 'empty': !components.length }\"\n        @change=\"handleComponentChange\"\n      >\n        <template #item=\"{ element }\">\n          <div class=\"component-item\">\n            <div class=\"component-header\">\n              <span class=\"component-name\">{{ element.name }}</span>\n              <div class=\"component-actions\">\n                <v-btn\n                  icon=\"mdi-delete\"\n                  size=\"small\"\n                  color=\"error\"\n                  variant=\"text\"\n                  @click=\"removeComponent(element)\"\n                ></v-btn>\n              </div>\n            </div>\n            <component\n              :is=\"getComponentByType(element.type)\"\n              :config=\"element.config\"\n              @update:config=\"config => updateComponentConfig(element.id, config)\"\n            ></component>\n          </div>\n        </template>\n\n        <template #header>\n          <div v-if=\"!components.length\" class=\"column-placeholder\">\n            <v-icon size=\"32\" color=\"rgba(0,0,0,0.2)\">mdi-plus</v-icon>\n            <div class=\"text-body-2 text-medium-emphasis mt-2\">拖拽组件到此处</div>\n          </div>\n        </template>\n      </draggable>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport draggable from 'vuedraggable'\nimport { useComponents } from '../composables/useComponents'\n\nconst props = defineProps({\n  config: {\n    type: Object,\n    required: true\n  }\n})\n\nconst emit = defineEmits(['update:config'])\n\nconst isDragOver = ref(false)\nconst components = ref(props.config.components || [])\n\nconst { getComponentByType } = useComponents()\n\n// 计算布局样式\nconst layoutStyles = computed(() => {\n  const theme = props.config.styles?.colors || {}\n  const spacing = props.config.styles?.spacing || {}\n  \n  return {\n    backgroundColor: theme.background || '#f5f7fa',\n    borderColor: theme.secondary || '#e4e7ed',\n    padding: spacing.unit || '16px',\n    gap: spacing.unit || '16px',\n    borderRadius: '8px',\n    '--primary-color': theme.primary || '#2c3e50',\n    '--accent-color': theme.accent || '#3498db',\n    '--text-color': theme.primary || '#2c3e50',\n    ...props.config.styles\n  }\n})\n\n// 监听配置变化\nwatch(() => props.config, (newConfig) => {\n  components.value = newConfig.components || []\n}, { deep: true })\n\n// 处理拖拽进入\nconst handleDragEnter = (event) => {\n  event.preventDefault()\n  isDragOver.value = true\n}\n\n// 处理拖拽离开\nconst handleDragLeave = (event) => {\n  event.preventDefault()\n  isDragOver.value = false\n}\n\n// 处理拖拽悬停\nconst handleDragOver = (event) => {\n  event.preventDefault()\n}\n\n// 处理组件放置\nconst handleDrop = (event) => {\n  event.preventDefault()\n  isDragOver.value = false\n  \n  const componentData = event.dataTransfer.getData('application/json')\n  if (componentData) {\n    try {\n      const component = JSON.parse(componentData)\n      if (component.type !== 'layout') {\n        addComponent(component)\n      }\n    } catch (error) {\n      console.error('解析组件数据失败:', error)\n    }\n  }\n}\n\n// 添加组件\nconst addComponent = (component) => {\n  const newComponent = {\n    id: Date.now(),\n    type: component.type,\n    name: component.name,\n    config: component.config || {}\n  }\n  components.value.push(newComponent)\n  updateConfig()\n}\n\n// 移除组件\nconst removeComponent = (component) => {\n  const index = components.value.findIndex(c => c.id === component.id)\n  if (index > -1) {\n    components.value.splice(index, 1)\n    updateConfig()\n  }\n}\n\n// 更新组件配置\nconst updateComponentConfig = (componentId, config) => {\n  const component = components.value.find(c => c.id === componentId)\n  if (component) {\n    component.config = config\n    updateConfig()\n  }\n}\n\n// 处理组件变化\nconst handleComponentChange = (event) => {\n  updateConfig()\n}\n\n// 更新配置\nconst updateConfig = () => {\n  emit('update:config', {\n    ...props.config,\n    components: components.value\n  })\n}\n</script>\n\n<style scoped>\n.single-layout {\n  position: absolute;\n  inset: 0;\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n}\n\n.layout-column {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  border: 2px dashed;\n  transition: all 0.3s;\n  gap: 12px;\n}\n\n.layout-column.drag-over {\n  background-color: #ecf5ff !important;\n  border-color: #409eff !important;\n}\n\n.component-list {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  min-height: 120px;\n}\n\n.component-list.empty {\n  height: 100%;\n}\n\n.column-placeholder {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 120px;\n  background-color: #ffffff;\n  border-radius: 6px;\n  color: rgba(0, 0, 0, 0.4);\n  transition: all 0.3s;\n}\n\n.component-item {\n  background-color: #ffffff;\n  border: 1px solid #e4e7ed;\n  border-radius: 6px;\n  overflow: hidden;\n  transition: all 0.3s;\n}\n\n.component-item:hover {\n  border-color: #409eff;\n  box-shadow: 0 2px 12px rgba(64, 158, 255, 0.1);\n}\n\n.component-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background-color: #f5f7fa;\n  border-bottom: 1px solid #e4e7ed;\n}\n\n.component-name {\n  font-size: 14px;\n  color: #606266;\n}\n\n.component-actions {\n  display: flex;\n  gap: 4px;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}