{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nexport default {\n  __name: 'UserHome',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    // No changes to imports or setup section\n\n    // 处理背景图上传\n    const handleBackgroundUpload = async () => {\n      // 创建文件输入框\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = 'image/*';\n\n      // 监听文件选择\n      input.onchange = async e => {\n        const file = e.target.files[0];\n        if (!file) return;\n\n        // 验证文件\n        if (!file.type.startsWith('image/')) {\n          showToast('请选择图片文件', 'error');\n          return;\n        }\n        const maxSize = 5 * 1024 * 1024; // 5MB\n        if (file.size > maxSize) {\n          showToast('图片大小不能超过5MB', 'error');\n          return;\n        }\n        try {\n          loading.value = true;\n          const response = await user.uploadBackground(file);\n          if (response.data?.code === 200) {\n            showToast('背景图上传成功', 'success');\n            // 更新 store 中的用户信息\n            store.commit('SET_USER_INFO', _objectSpread(_objectSpread({}, store.state.userInfo), {}, {\n              data: _objectSpread(_objectSpread({}, store.state.userInfo.data), {}, {\n                background_image: response.data.data.background_image\n              })\n            }));\n          } else {\n            throw new Error(response.data?.message || '上传失败');\n          }\n        } catch (error) {\n          console.error('背景图上传失败:', error);\n          showToast(error.message || '背景图上传失败，请稍后重试', 'error');\n        } finally {\n          loading.value = false;\n          input.value = ''; // 清空文件选择器\n        }\n      };\n\n      // 触发文件选择\n      input.click();\n    };\n\n    // No changes to rest of the script section\n\n    const __returned__ = {\n      handleBackgroundUpload\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["handleBackgroundUpload","input","document","createElement","type","accept","onchange","e","file","target","files","startsWith","showToast","maxSize","size","loading","value","response","user","uploadBackground","data","code","store","commit","_objectSpread","state","userInfo","background_image","Error","message","error","console","click"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/user/MyProfile/components/UserHome.vue"],"sourcesContent":["<template>\n  <!-- No changes to template section -->\n</template>\n\n<script setup>\n// No changes to imports or setup section\n\n// 处理背景图上传\nconst handleBackgroundUpload = async () => {\n  // 创建文件输入框\n  const input = document.createElement('input')\n  input.type = 'file'\n  input.accept = 'image/*'\n  \n  // 监听文件选择\n  input.onchange = async (e) => {\n    const file = e.target.files[0]\n    if (!file) return\n    \n    // 验证文件\n    if (!file.type.startsWith('image/')) {\n      showToast('请选择图片文件', 'error')\n      return\n    }\n    \n    const maxSize = 5 * 1024 * 1024 // 5MB\n    if (file.size > maxSize) {\n      showToast('图片大小不能超过5MB', 'error')\n      return\n    }\n    \n    try {\n      loading.value = true\n      const response = await user.uploadBackground(file)\n      if (response.data?.code === 200) {\n        showToast('背景图上传成功', 'success')\n        // 更新 store 中的用户信息\n        store.commit('SET_USER_INFO', {\n          ...store.state.userInfo,\n          data: {\n            ...store.state.userInfo.data,\n            background_image: response.data.data.background_image\n          }\n        })\n      } else {\n        throw new Error(response.data?.message || '上传失败')\n      }\n    } catch (error) {\n      console.error('背景图上传失败:', error)\n      showToast(error.message || '背景图上传失败，请稍后重试', 'error')\n    } finally {\n      loading.value = false\n      input.value = ''  // 清空文件选择器\n    }\n  }\n  \n  // 触发文件选择\n  input.click()\n}\n\n// No changes to rest of the script section\n</script>\n\n<style scoped>\n/* No changes to style section */\n</style> "],"mappings":";;;;;;;;IAKA;;IAEA;IACA,MAAMA,sBAAsB,GAAG,MAAAA,CAAA,KAAY;MACzC;MACA,MAAMC,KAAK,GAAGC,QAAQ,CAACC,aAAa,CAAC,OAAO;MAC5CF,KAAK,CAACG,IAAI,GAAG,MAAK;MAClBH,KAAK,CAACI,MAAM,GAAG,SAAQ;;MAEvB;MACAJ,KAAK,CAACK,QAAQ,GAAG,MAAOC,CAAC,IAAK;QAC5B,MAAMC,IAAI,GAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC;QAC7B,IAAI,CAACF,IAAI,EAAE;;QAEX;QACA,IAAI,CAACA,IAAI,CAACJ,IAAI,CAACO,UAAU,CAAC,QAAQ,CAAC,EAAE;UACnCC,SAAS,CAAC,SAAS,EAAE,OAAO;UAC5B;QACF;QAEA,MAAMC,OAAO,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,EAAC;QAChC,IAAIL,IAAI,CAACM,IAAI,GAAGD,OAAO,EAAE;UACvBD,SAAS,CAAC,aAAa,EAAE,OAAO;UAChC;QACF;QAEA,IAAI;UACFG,OAAO,CAACC,KAAK,GAAG,IAAG;UACnB,MAAMC,QAAQ,GAAG,MAAMC,IAAI,CAACC,gBAAgB,CAACX,IAAI;UACjD,IAAIS,QAAQ,CAACG,IAAI,EAAEC,IAAI,KAAK,GAAG,EAAE;YAC/BT,SAAS,CAAC,SAAS,EAAE,SAAS;YAC9B;YACAU,KAAK,CAACC,MAAM,CAAC,eAAe,EAAAC,aAAA,CAAAA,aAAA,KACvBF,KAAK,CAACG,KAAK,CAACC,QAAQ;cACvBN,IAAI,EAAAI,aAAA,CAAAA,aAAA,KACCF,KAAK,CAACG,KAAK,CAACC,QAAQ,CAACN,IAAI;gBAC5BO,gBAAgB,EAAEV,QAAQ,CAACG,IAAI,CAACA,IAAI,CAACO;cAAe;YACtD,EACD;UACH,CAAC,MAAM;YACL,MAAM,IAAIC,KAAK,CAACX,QAAQ,CAACG,IAAI,EAAES,OAAO,IAAI,MAAM;UAClD;QACF,CAAC,CAAC,OAAOC,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK;UAC/BlB,SAAS,CAACkB,KAAK,CAACD,OAAO,IAAI,eAAe,EAAE,OAAO;QACrD,CAAC,SAAS;UACRd,OAAO,CAACC,KAAK,GAAG,KAAI;UACpBf,KAAK,CAACe,KAAK,GAAG,EAAE,EAAE;QACpB;MACF;;MAEA;MACAf,KAAK,CAAC+B,KAAK,CAAC;IACd;;IAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}