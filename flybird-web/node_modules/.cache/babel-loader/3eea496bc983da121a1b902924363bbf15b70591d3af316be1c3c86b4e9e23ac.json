{"ast":null,"code":"import request from '@/utils/request';\n\n// 获取模板分类列表\nexport function getCategories() {\n  return request({\n    url: '/api/v1/resume/template-categories/',\n    method: 'get'\n  });\n}\n\n// 保存模板\nexport function saveTemplate(data) {\n  const formData = new FormData();\n\n  // 添加基本字段\n  formData.append('name', data.name);\n  formData.append('category', data.category);\n  formData.append('description', data.description);\n  formData.append('is_vip', data.is_vip);\n\n  // 添加缩略图\n  if (data.thumbnail) {\n    formData.append('thumbnail', data.thumbnail);\n  }\n\n  // 添加画布内容数据\n  if (data.components) {\n    formData.append('content', JSON.stringify({\n      elements: data.components\n    }));\n  }\n\n  // 打印请求数据\n  console.log('请求数据:', {\n    name: data.name,\n    category: data.category,\n    description: data.description,\n    is_vip: data.is_vip,\n    thumbnail: data.thumbnail,\n    content: JSON.parse(formData.get('content') || '{}')\n  });\n  return request({\n    url: '/api/v1/resume/templates/',\n    method: 'post',\n    data: formData,\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  }).catch(error => {\n    if (error.response?.data) {\n      const errors = error.response.data;\n      const errorMessages = [];\n\n      // 处理字段错误\n      for (const field in errors) {\n        if (Array.isArray(errors[field])) {\n          errorMessages.push(`${field}: ${errors[field].join(', ')}`);\n        }\n      }\n      console.error('服务器响应错误:', errors);\n      throw new Error(errorMessages.join('\\n') || '保存失败，请检查表单数据');\n    }\n    throw error;\n  });\n}\n\n// 获取模板列表\nexport function getTemplates(params) {\n  return request({\n    url: '/api/v1/resume/templates/',\n    method: 'get',\n    params\n  });\n}\n\n// 获取模板详情\nexport function getTemplateDetail(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'get'\n  });\n}\n\n// 更新模板\nexport function updateTemplate(id, data) {\n  const formData = new FormData();\n\n  // 添加基本字段\n  if (data.name) formData.append('name', data.name);\n  if (data.category) formData.append('category', data.category);\n  if (data.description) formData.append('description', data.description);\n  if (typeof data.is_vip === 'boolean') formData.append('is_vip', data.is_vip);\n\n  // 添加缩略图\n  if (data.thumbnail && data.thumbnail.length > 0) {\n    formData.append('thumbnail', data.thumbnail[0]);\n  }\n\n  // 添加布局数据\n  if (data.layout) {\n    formData.append('layout', JSON.stringify(data.layout));\n  }\n\n  // 添加组件数据\n  if (data.components) {\n    formData.append('components', JSON.stringify(data.components));\n  }\n\n  // 添加主题数据\n  if (data.theme) {\n    formData.append('theme', JSON.stringify(data.theme));\n  }\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'patch',\n    data: formData,\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n}\n\n// 删除模板\nexport function deleteTemplate(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'delete'\n  });\n}\n\n// 提交模板审核\nexport function submitForReview(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/submit_for_review/`,\n    method: 'post'\n  });\n}","map":{"version":3,"names":["request","getCategories","url","method","saveTemplate","data","formData","FormData","append","name","category","description","is_vip","thumbnail","components","JSON","stringify","elements","console","log","content","parse","get","headers","catch","error","response","errors","errorMessages","field","Array","isArray","push","join","Error","getTemplates","params","getTemplateDetail","id","updateTemplate","length","layout","theme","deleteTemplate","submitForReview"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/api/template.js"],"sourcesContent":["import request from '@/utils/request'\n\n// 获取模板分类列表\nexport function getCategories() {\n  return request({\n    url: '/api/v1/resume/template-categories/',\n    method: 'get'\n  })\n}\n\n// 保存模板\nexport function saveTemplate(data) {\n  const formData = new FormData()\n  \n  // 添加基本字段\n  formData.append('name', data.name)\n  formData.append('category', data.category)\n  formData.append('description', data.description)\n  formData.append('is_vip', data.is_vip)\n  \n  // 添加缩略图\n  if (data.thumbnail) {\n    formData.append('thumbnail', data.thumbnail)\n  }\n  \n  // 添加画布内容数据\n  if (data.components) {\n    formData.append('content', JSON.stringify({\n      elements: data.components\n    }))\n  }\n\n  // 打印请求数据\n  console.log('请求数据:', {\n    name: data.name,\n    category: data.category,\n    description: data.description,\n    is_vip: data.is_vip,\n    thumbnail: data.thumbnail,\n    content: JSON.parse(formData.get('content') || '{}')\n  })\n\n  return request({\n    url: '/api/v1/resume/templates/',\n    method: 'post',\n    data: formData,\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  }).catch(error => {\n    if (error.response?.data) {\n      const errors = error.response.data\n      const errorMessages = []\n      \n      // 处理字段错误\n      for (const field in errors) {\n        if (Array.isArray(errors[field])) {\n          errorMessages.push(`${field}: ${errors[field].join(', ')}`)\n        }\n      }\n      \n      console.error('服务器响应错误:', errors)\n      throw new Error(errorMessages.join('\\n') || '保存失败，请检查表单数据')\n    }\n    throw error\n  })\n}\n\n// 获取模板列表\nexport function getTemplates(params) {\n  return request({\n    url: '/api/v1/resume/templates/',\n    method: 'get',\n    params\n  })\n}\n\n// 获取模板详情\nexport function getTemplateDetail(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'get'\n  })\n}\n\n// 更新模板\nexport function updateTemplate(id, data) {\n  const formData = new FormData()\n  \n  // 添加基本字段\n  if (data.name) formData.append('name', data.name)\n  if (data.category) formData.append('category', data.category)\n  if (data.description) formData.append('description', data.description)\n  if (typeof data.is_vip === 'boolean') formData.append('is_vip', data.is_vip)\n  \n  // 添加缩略图\n  if (data.thumbnail && data.thumbnail.length > 0) {\n    formData.append('thumbnail', data.thumbnail[0])\n  }\n  \n  // 添加布局数据\n  if (data.layout) {\n    formData.append('layout', JSON.stringify(data.layout))\n  }\n  \n  // 添加组件数据\n  if (data.components) {\n    formData.append('components', JSON.stringify(data.components))\n  }\n  \n  // 添加主题数据\n  if (data.theme) {\n    formData.append('theme', JSON.stringify(data.theme))\n  }\n\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'patch',\n    data: formData,\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  })\n}\n\n// 删除模板\nexport function deleteTemplate(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/`,\n    method: 'delete'\n  })\n}\n\n// 提交模板审核\nexport function submitForReview(id) {\n  return request({\n    url: `/api/v1/resume/templates/${id}/submit_for_review/`,\n    method: 'post'\n  })\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}