{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createBlock as _createBlock, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = [\"onMousedown\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_img = _resolveComponent(\"v-img\");\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"design-element\", {\n      'is-selected': $props.isSelected\n    }]),\n    style: _normalizeStyle($setup.elementStyle),\n    onClick: _cache[0] || (_cache[0] = _withModifiers($event => _ctx.$emit('select', $props.element), [\"stop\"]))\n  }, [_createCommentVNode(\" 图片元素 \"), $props.element.type === 'image' ? (_openBlock(), _createBlock(_component_v_img, {\n    key: 0,\n    src: $props.element.content,\n    width: $props.element.width,\n    height: $props.element.height,\n    style: _normalizeStyle($props.element.styles),\n    cover: \"\"\n  }, null, 8 /* PROPS */, [\"src\", \"width\", \"height\", \"style\"])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 选中时显示的控制点 \"), $props.isSelected ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" 旋转控制点 \"), _createElementVNode(\"div\", {\n    class: \"rotate-handle\",\n    onMousedown: $setup.startRotate\n  }, null, 32 /* NEED_HYDRATION */), _createCommentVNode(\" 缩放控制点 \"), (_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.resizeHandles, (handle, index) => {\n    return _createElementVNode(\"div\", {\n      key: index,\n      class: _normalizeClass([\"resize-handle\", handle.class]),\n      onMousedown: $event => $setup.startResize($event, handle.cursor)\n    }, null, 42 /* CLASS, PROPS, NEED_HYDRATION */, _hoisted_1);\n  }), 64 /* STABLE_FRAGMENT */))], 64 /* STABLE_FRAGMENT */)) : _createCommentVNode(\"v-if\", true)], 6 /* CLASS, STYLE */);\n}","map":{"version":3,"names":["_createElementBlock","class","_normalizeClass","$props","isSelected","style","_normalizeStyle","$setup","elementStyle","onClick","_cache","_withModifiers","$event","_ctx","$emit","element","_createCommentVNode","type","_createBlock","_component_v_img","key","src","content","width","height","styles","cover","_Fragment","_createElementVNode","onMousedown","startRotate","_renderList","resizeHandles","handle","index","startResize","cursor","_hoisted_1"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/components/DesignElement.vue"],"sourcesContent":["<template>\n  <div\n    class=\"design-element\"\n    :class=\"{ 'is-selected': isSelected }\"\n    :style=\"elementStyle\"\n    @click.stop=\"$emit('select', element)\"\n  >\n    <!-- 图片元素 -->\n    <v-img\n      v-if=\"element.type === 'image'\"\n      :src=\"element.content\"\n      :width=\"element.width\"\n      :height=\"element.height\"\n      :style=\"element.styles\"\n      cover\n    />\n\n    <!-- 选中时显示的控制点 -->\n    <template v-if=\"isSelected\">\n      <!-- 旋转控制点 -->\n      <div class=\"rotate-handle\" @mousedown=\"startRotate\"></div>\n      \n      <!-- 缩放控制点 -->\n      <div \n        v-for=\"(handle, index) in resizeHandles\" \n        :key=\"index\"\n        class=\"resize-handle\"\n        :class=\"handle.class\"\n        @mousedown=\"startResize($event, handle.cursor)\"\n      ></div>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed, ref } from 'vue'\n\nconst props = defineProps({\n  element: {\n    type: Object,\n    required: true\n  },\n  isSelected: {\n    type: Boolean,\n    default: false\n  },\n  scale: {\n    type: Number,\n    default: 1\n  }\n})\n\nconst emit = defineEmits(['select', 'update'])\n\n// 元素样式\nconst elementStyle = computed(() => ({\n  transform: `translate(${props.element.x}px, ${props.element.y}px) rotate(${props.element.rotation}deg)`,\n  position: 'absolute',\n  cursor: props.isSelected ? 'move' : 'pointer',\n  userSelect: 'none'\n}))\n\n// 缩放控制点配置\nconst resizeHandles = [\n  { class: 'nw', cursor: 'nw-resize' },\n  { class: 'n', cursor: 'n-resize' },\n  { class: 'ne', cursor: 'ne-resize' },\n  { class: 'w', cursor: 'w-resize' },\n  { class: 'e', cursor: 'e-resize' },\n  { class: 'sw', cursor: 'sw-resize' },\n  { class: 's', cursor: 's-resize' },\n  { class: 'se', cursor: 'se-resize' }\n]\n\n// 拖拽相关状态\nlet startX = 0\nlet startY = 0\nlet startWidth = 0\nlet startHeight = 0\nlet startRotation = 0\nlet isDragging = false\nlet isResizing = false\nlet isRotating = false\nlet currentHandle = null\n\n// 开始移动\nconst startDrag = (e) => {\n  if (!props.isSelected || isResizing || isRotating) return\n  \n  isDragging = true\n  startX = e.clientX - props.element.x\n  startY = e.clientY - props.element.y\n  \n  document.addEventListener('mousemove', handleDrag)\n  document.addEventListener('mouseup', stopDrag)\n}\n\n// 处理移动\nconst handleDrag = (e) => {\n  if (!isDragging) return\n  \n  const newX = e.clientX - startX\n  const newY = e.clientY - startY\n  \n  emit('update', {\n    ...props.element,\n    x: newX,\n    y: newY\n  })\n}\n\n// 停止移动\nconst stopDrag = () => {\n  isDragging = false\n  document.removeEventListener('mousemove', handleDrag)\n  document.removeEventListener('mouseup', stopDrag)\n}\n\n// 开始缩放\nconst startResize = (e, cursor) => {\n  e.stopPropagation()\n  isResizing = true\n  currentHandle = cursor\n  \n  startX = e.clientX\n  startY = e.clientY\n  startWidth = props.element.width\n  startHeight = props.element.height\n  \n  document.addEventListener('mousemove', handleResize)\n  document.addEventListener('mouseup', stopResize)\n}\n\n// 处理缩放\nconst handleResize = (e) => {\n  if (!isResizing) return\n  \n  const dx = (e.clientX - startX) / props.scale\n  const dy = (e.clientY - startY) / props.scale\n  \n  let newWidth = startWidth\n  let newHeight = startHeight\n  \n  switch (currentHandle) {\n    case 'e-resize':\n      newWidth = startWidth + dx\n      break\n    case 'w-resize':\n      newWidth = startWidth - dx\n      break\n    case 's-resize':\n      newHeight = startHeight + dy\n      break\n    case 'n-resize':\n      newHeight = startHeight - dy\n      break\n    case 'se-resize':\n      newWidth = startWidth + dx\n      newHeight = startHeight + dy\n      break\n    case 'sw-resize':\n      newWidth = startWidth - dx\n      newHeight = startHeight + dy\n      break\n    case 'ne-resize':\n      newWidth = startWidth + dx\n      newHeight = startHeight - dy\n      break\n    case 'nw-resize':\n      newWidth = startWidth - dx\n      newHeight = startHeight - dy\n      break\n  }\n  \n  // 确保尺寸不小于最小值\n  newWidth = Math.max(20, newWidth)\n  newHeight = Math.max(20, newHeight)\n  \n  emit('update', {\n    ...props.element,\n    width: newWidth,\n    height: newHeight\n  })\n}\n\n// 停止缩放\nconst stopResize = () => {\n  isResizing = false\n  currentHandle = null\n  document.removeEventListener('mousemove', handleResize)\n  document.removeEventListener('mouseup', stopResize)\n}\n\n// 开始旋转\nconst startRotate = (e) => {\n  e.stopPropagation()\n  isRotating = true\n  \n  const rect = e.target.parentElement.getBoundingClientRect()\n  const centerX = rect.left + rect.width / 2\n  const centerY = rect.top + rect.height / 2\n  startRotation = Math.atan2(e.clientY - centerY, e.clientX - centerX)\n  \n  document.addEventListener('mousemove', handleRotate)\n  document.addEventListener('mouseup', stopRotate)\n}\n\n// 处理旋转\nconst handleRotate = (e) => {\n  if (!isRotating) return\n  \n  const rect = e.target.parentElement.getBoundingClientRect()\n  const centerX = rect.left + rect.width / 2\n  const centerY = rect.top + rect.height / 2\n  \n  const angle = Math.atan2(e.clientY - centerY, e.clientX - centerX)\n  let rotation = (angle - startRotation) * (180 / Math.PI)\n  \n  // 将旋转角度限制在0-360度之间\n  rotation = (rotation + 360) % 360\n  \n  emit('update', {\n    ...props.element,\n    rotation\n  })\n}\n\n// 停止旋转\nconst stopRotate = () => {\n  isRotating = false\n  document.removeEventListener('mousemove', handleRotate)\n  document.removeEventListener('mouseup', stopRotate)\n}\n\n// 添加事件监听\nonMounted(() => {\n  const element = document.querySelector('.design-element')\n  element.addEventListener('mousedown', startDrag)\n})\n\nonUnmounted(() => {\n  const element = document.querySelector('.design-element')\n  element.removeEventListener('mousedown', startDrag)\n})\n</script>\n\n<style scoped>\n.design-element {\n  position: absolute;\n  touch-action: none;\n}\n\n.is-selected {\n  outline: 1px solid #409eff;\n}\n\n.resize-handle {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: #fff;\n  border: 1px solid #409eff;\n  border-radius: 50%;\n}\n\n.rotate-handle {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: #fff;\n  border: 1px solid #409eff;\n  border-radius: 50%;\n  top: -20px;\n  left: 50%;\n  transform: translateX(-50%);\n  cursor: pointer;\n}\n\n/* 缩放控制点位置 */\n.nw { top: -4px; left: -4px; cursor: nw-resize; }\n.n { top: -4px; left: 50%; transform: translateX(-50%); cursor: n-resize; }\n.ne { top: -4px; right: -4px; cursor: ne-resize; }\n.w { top: 50%; left: -4px; transform: translateY(-50%); cursor: w-resize; }\n.e { top: 50%; right: -4px; transform: translateY(-50%); cursor: e-resize; }\n.sw { bottom: -4px; left: -4px; cursor: sw-resize; }\n.s { bottom: -4px; left: 50%; transform: translateX(-50%); cursor: s-resize; }\n.se { bottom: -4px; right: -4px; cursor: se-resize; }\n</style> "],"mappings":";mBAAA;;;uBACEA,mBAAA,CA8BM;IA7BJC,KAAK,EAFTC,eAAA,EAEU,gBAAgB;MAAA,eACGC,MAAA,CAAAC;IAAU;IAClCC,KAAK,EAJVC,eAAA,CAIYC,MAAA,CAAAC,YAAY;IACnBC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MALVC,cAAA,CAAAC,MAAA,IAKiBC,IAAA,CAAAC,KAAK,WAAWX,MAAA,CAAAY,OAAO;MAEpCC,mBAAA,UAAa,EAELb,MAAA,CAAAY,OAAO,CAACE,IAAI,gB,cADpBC,YAAA,CAOEC,gBAAA;IAfNC,GAAA;IAUOC,GAAG,EAAElB,MAAA,CAAAY,OAAO,CAACO,OAAO;IACpBC,KAAK,EAAEpB,MAAA,CAAAY,OAAO,CAACQ,KAAK;IACpBC,MAAM,EAAErB,MAAA,CAAAY,OAAO,CAACS,MAAM;IACtBnB,KAAK,EAbZC,eAAA,CAacH,MAAA,CAAAY,OAAO,CAACU,MAAM;IACtBC,KAAK,EAAL;kEAdNV,mBAAA,gBAiBIA,mBAAA,eAAkB,EACFb,MAAA,CAAAC,UAAU,I,cAA1BJ,mBAAA,CAYW2B,SAAA;IA9BfP,GAAA;EAAA,IAmBMJ,mBAAA,WAAc,EACdY,mBAAA,CAA0D;IAArD3B,KAAK,EAAC,eAAe;IAAE4B,WAAS,EAAEtB,MAAA,CAAAuB;qCAEvCd,mBAAA,WAAc,G,cACdhB,mBAAA,CAMO2B,SAAA,QA7BbI,WAAA,CAwBkCxB,MAAA,CAAAyB,aAAa,EAxB/C,CAwBgBC,MAAM,EAAEC,KAAK;WADvBN,mBAAA,CAMO;MAJJR,GAAG,EAAEc,KAAK;MACXjC,KAAK,EA1BbC,eAAA,EA0Bc,eAAe,EACb+B,MAAM,CAAChC,KAAK;MACnB4B,WAAS,EAAAjB,MAAA,IAAEL,MAAA,CAAA4B,WAAW,CAACvB,MAAM,EAAEqB,MAAM,CAACG,MAAM;oDA5BrDC,UAAA;gEAAArB,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}