{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport { ref, shallowRef, onBeforeUnmount } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/vue/24/outline';\nimport { showToast } from '@/components/ToastMessage';\n\n// 引入编辑器样式\nimport '@wangeditor/editor/dist/css/style.css';\nexport default {\n  __name: 'ArticleForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n\n    // 编辑器实例，必须用 shallowRef\n    const editorRef = shallowRef();\n\n    // 编辑器配置\n    const toolbarConfig = {\n      excludeKeys: ['group-video', 'insertTable', 'group-indent', 'headerSelect']\n    };\n    const editorConfig = {\n      placeholder: '请输入文章内容...',\n      MENU_CONF: {\n        uploadImage: {\n          server: '/api/upload/image',\n          fieldName: 'image',\n          maxFileSize: 10 * 1024 * 1024,\n          // 10M\n          maxNumberOfFiles: 10,\n          allowedFileTypes: ['image/*'],\n          metaWithUrl: true,\n          customInsert(res, insertFn) {\n            // res 即服务端返回的数据\n            insertFn(res.url, res.alt, res.href);\n          }\n        },\n        codeSelectLang: {\n          codeLangs: [{\n            text: 'JavaScript',\n            value: 'javascript'\n          }, {\n            text: 'TypeScript',\n            value: 'typescript'\n          }, {\n            text: 'HTML',\n            value: 'html'\n          }, {\n            text: 'CSS',\n            value: 'css'\n          }, {\n            text: 'Vue',\n            value: 'vue'\n          }, {\n            text: 'Python',\n            value: 'python'\n          }, {\n            text: 'Java',\n            value: 'java'\n          }, {\n            text: 'Go',\n            value: 'go'\n          }, {\n            text: 'SQL',\n            value: 'sql'\n          }, {\n            text: 'Shell',\n            value: 'shell'\n          }]\n        }\n      }\n    };\n\n    // 组件销毁时，也及时销毁编辑器\n    onBeforeUnmount(() => {\n      const editor = editorRef.value;\n      if (editor == null) return;\n      editor.destroy();\n    });\n    const handleCreated = editor => {\n      editorRef.value = editor;\n    };\n\n    // 文章表单数据\n    const articleForm = ref({\n      title: '',\n      category: '',\n      cover: '',\n      content: '',\n      tags: []\n    });\n\n    // 标签相关\n    const newTag = ref('');\n    const addTag = () => {\n      const tag = newTag.value.trim();\n      if (tag && !articleForm.value.tags.includes(tag) && articleForm.value.tags.length < 5) {\n        articleForm.value.tags.push(tag);\n        newTag.value = '';\n      }\n    };\n    const removeTag = tag => {\n      articleForm.value.tags = articleForm.value.tags.filter(t => t !== tag);\n    };\n\n    // 封面图上传\n    const coverInput = ref(null);\n    const uploadCover = () => {\n      coverInput.value.click();\n    };\n    const handleCoverChange = e => {\n      const file = e.target.files[0];\n      if (!file) return;\n\n      // TODO: 调用上传接口\n      const reader = new FileReader();\n      reader.onload = e => {\n        articleForm.value.cover = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    };\n\n    // 提交文章\n    const submitArticle = () => {\n      // 表单验证\n      if (!articleForm.value.title) {\n        showToast('请输入文章标题', 'warning');\n        return;\n      }\n      if (!articleForm.value.category) {\n        showToast('请选择文章分类', 'warning');\n        return;\n      }\n      if (!articleForm.value.content) {\n        showToast('请输入文章内容', 'warning');\n        return;\n      }\n\n      // TODO: 调用接口提交文章\n      console.log('提交文章:', articleForm.value);\n      showToast('发布成功', 'success');\n      router.push('/community/articles');\n    };\n    const __returned__ = {\n      router,\n      editorRef,\n      toolbarConfig,\n      editorConfig,\n      handleCreated,\n      articleForm,\n      newTag,\n      addTag,\n      removeTag,\n      coverInput,\n      uploadCover,\n      handleCoverChange,\n      submitArticle,\n      ref,\n      shallowRef,\n      onBeforeUnmount,\n      get useRouter() {\n        return useRouter;\n      },\n      get Editor() {\n        return Editor;\n      },\n      get Toolbar() {\n        return Toolbar;\n      },\n      get PhotoIcon() {\n        return PhotoIcon;\n      },\n      get XMarkIcon() {\n        return XMarkIcon;\n      },\n      get showToast() {\n        return showToast;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","shallowRef","onBeforeUnmount","useRouter","Editor","Toolbar","PhotoIcon","XMarkIcon","showToast","router","editorRef","toolbarConfig","excludeKeys","editorConfig","placeholder","MENU_CONF","uploadImage","server","fieldName","maxFileSize","maxNumberOfFiles","allowedFileTypes","metaWithUrl","customInsert","res","insertFn","url","alt","href","codeSelectLang","codeLangs","text","value","editor","destroy","handleCreated","articleForm","title","category","cover","content","tags","newTag","addTag","tag","trim","includes","length","push","removeTag","filter","t","coverInput","uploadCover","click","handleCoverChange","e","file","target","files","reader","FileReader","onload","result","readAsDataURL","submitArticle","console","log"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/community/components/ArticleForm.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <!-- 标题 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章标题</label>\n      <input\n        type=\"text\"\n        v-model=\"articleForm.title\"\n        class=\"block w-full rounded-lg border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500\"\n        placeholder=\"请输入文章标题\"\n      >\n    </div>\n\n    <!-- 分类 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章分类</label>\n      <select\n        v-model=\"articleForm.category\"\n        class=\"block w-full rounded-lg border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500\"\n      >\n        <option value=\"\">请选择分类</option>\n        <option value=\"frontend\">前端开发</option>\n        <option value=\"backend\">后端开发</option>\n        <option value=\"mobile\">移动开发</option>\n        <option value=\"algorithm\">算法</option>\n        <option value=\"database\">数据库</option>\n        <option value=\"devops\">运维</option>\n        <option value=\"ai\">人工智能</option>\n      </select>\n    </div>\n\n    <!-- 封面图 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章封面</label>\n      <div class=\"flex items-center gap-4\">\n        <div \n          v-if=\"articleForm.cover\"\n          class=\"relative w-48 h-32 rounded-lg overflow-hidden group\"\n        >\n          <img \n            :src=\"articleForm.cover\" \n            class=\"w-full h-full object-cover\"\n          >\n          <div \n            class=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\"\n          >\n            <button \n              class=\"text-white text-sm\"\n              @click=\"articleForm.cover = ''\"\n            >\n              删除封面\n            </button>\n          </div>\n        </div>\n        <div v-else>\n          <button \n            class=\"w-48 h-32 rounded-lg border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors flex flex-col items-center justify-center gap-2\"\n            @click=\"uploadCover\"\n          >\n            <PhotoIcon class=\"w-6 h-6 text-gray-400\" />\n            <span class=\"text-sm text-gray-500\">点击上传封面</span>\n          </button>\n          <input\n            ref=\"coverInput\"\n            type=\"file\"\n            accept=\"image/*\"\n            class=\"hidden\"\n            @change=\"handleCoverChange\"\n          >\n        </div>\n      </div>\n    </div>\n\n    <!-- 文章内容 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">文章内容</label>\n      <div class=\"border rounded-lg border-gray-300\">\n        <Toolbar\n          :editor=\"editorRef\"\n          :defaultConfig=\"toolbarConfig\"\n          mode=\"default\"\n          style=\"border-bottom: 1px solid #e5e7eb\"\n        />\n        <Editor\n          v-model=\"articleForm.content\"\n          :defaultConfig=\"editorConfig\"\n          mode=\"default\"\n          @onCreated=\"handleCreated\"\n          style=\"height: 500px\"\n        />\n      </div>\n    </div>\n\n    <!-- 标签 -->\n    <div>\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">添加标签</label>\n      <div class=\"flex flex-wrap gap-2\">\n        <div\n          v-for=\"tag in articleForm.tags\"\n          :key=\"tag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm flex items-center group\"\n        >\n          <span>{{ tag }}</span>\n          <XMarkIcon \n            class=\"w-4 h-4 ml-1 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity\"\n            @click=\"removeTag(tag)\"\n          />\n        </div>\n        <input\n          v-if=\"articleForm.tags.length < 5\"\n          type=\"text\"\n          v-model=\"newTag\"\n          @keydown.enter=\"addTag\"\n          class=\"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-violet-500\"\n          placeholder=\"按回车添加标签\"\n        >\n      </div>\n      <p class=\"mt-1 text-xs text-gray-500\">最多添加 5 个标签</p>\n    </div>\n\n    <!-- 发布按钮 -->\n    <div class=\"flex justify-end gap-4\">\n      <button \n        class=\"px-6 h-10 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors\"\n        @click=\"$router.back()\"\n      >\n        取消\n      </button>\n      <button \n        class=\"px-6 h-10 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors\"\n        @click=\"submitArticle\"\n      >\n        发布文章\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, shallowRef, onBeforeUnmount } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\nimport { PhotoIcon, XMarkIcon } from '@heroicons/vue/24/outline'\nimport { showToast } from '@/components/ToastMessage'\n\n// 引入编辑器样式\nimport '@wangeditor/editor/dist/css/style.css'\n\nconst router = useRouter()\n\n// 编辑器实例，必须用 shallowRef\nconst editorRef = shallowRef()\n\n// 编辑器配置\nconst toolbarConfig = {\n  excludeKeys: [\n    'group-video',\n    'insertTable',\n    'group-indent',\n    'headerSelect'\n  ]\n}\n\nconst editorConfig = {\n  placeholder: '请输入文章内容...',\n  MENU_CONF: {\n    uploadImage: {\n      server: '/api/upload/image',\n      fieldName: 'image',\n      maxFileSize: 10 * 1024 * 1024, // 10M\n      maxNumberOfFiles: 10,\n      allowedFileTypes: ['image/*'],\n      metaWithUrl: true,\n      customInsert(res, insertFn) {\n        // res 即服务端返回的数据\n        insertFn(res.url, res.alt, res.href)\n      },\n    },\n    codeSelectLang: {\n      codeLangs: [\n        { text: 'JavaScript', value: 'javascript' },\n        { text: 'TypeScript', value: 'typescript' },\n        { text: 'HTML', value: 'html' },\n        { text: 'CSS', value: 'css' },\n        { text: 'Vue', value: 'vue' },\n        { text: 'Python', value: 'python' },\n        { text: 'Java', value: 'java' },\n        { text: 'Go', value: 'go' },\n        { text: 'SQL', value: 'sql' },\n        { text: 'Shell', value: 'shell' }\n      ]\n    }\n  }\n}\n\n// 组件销毁时，也及时销毁编辑器\nonBeforeUnmount(() => {\n  const editor = editorRef.value\n  if (editor == null) return\n  editor.destroy()\n})\n\nconst handleCreated = (editor) => {\n  editorRef.value = editor\n}\n\n// 文章表单数据\nconst articleForm = ref({\n  title: '',\n  category: '',\n  cover: '',\n  content: '',\n  tags: []\n})\n\n// 标签相关\nconst newTag = ref('')\n\nconst addTag = () => {\n  const tag = newTag.value.trim()\n  if (tag && !articleForm.value.tags.includes(tag) && articleForm.value.tags.length < 5) {\n    articleForm.value.tags.push(tag)\n    newTag.value = ''\n  }\n}\n\nconst removeTag = (tag) => {\n  articleForm.value.tags = articleForm.value.tags.filter(t => t !== tag)\n}\n\n// 封面图上传\nconst coverInput = ref(null)\n\nconst uploadCover = () => {\n  coverInput.value.click()\n}\n\nconst handleCoverChange = (e) => {\n  const file = e.target.files[0]\n  if (!file) return\n\n  // TODO: 调用上传接口\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    articleForm.value.cover = e.target.result\n  }\n  reader.readAsDataURL(file)\n}\n\n// 提交文章\nconst submitArticle = () => {\n  // 表单验证\n  if (!articleForm.value.title) {\n    showToast('请输入文章标题', 'warning')\n    return\n  }\n  if (!articleForm.value.category) {\n    showToast('请选择文章分类', 'warning')\n    return\n  }\n  if (!articleForm.value.content) {\n    showToast('请输入文章内容', 'warning')\n    return\n  }\n\n  // TODO: 调用接口提交文章\n  console.log('提交文章:', articleForm.value)\n  showToast('发布成功', 'success')\n  router.push('/community/articles')\n}\n</script>\n\n<style>\n.w-e-bar {\n  padding: 0 8px !important;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}