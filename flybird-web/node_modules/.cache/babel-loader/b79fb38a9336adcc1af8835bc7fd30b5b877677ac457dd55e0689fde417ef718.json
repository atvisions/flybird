{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue';\nimport { useRouter, useRoute } from 'vue-router';\nimport { useAuthStore } from '@/stores/auth';\nimport { useAccountStore } from '@/stores/account';\nimport defaultAvatar from '@/assets/images/default-avatar.png';\nimport navigation from '@/config/navigation.json';\nimport { eventBus } from '@/utils/eventBus';\nimport { showToast } from '@/components/ToastMessage';\nimport request from '@/utils/request';\nimport { membership } from '@/api/membership';\n\n// 导入所需的图标\nimport { DocumentTextIcon, DocumentIcon, UserIcon, Cog6ToothIcon, ArrowRightOnRectangleIcon, BellIcon, HeartIcon, ShieldCheckIcon, UserCircleIcon, WrenchScrewdriverIcon, MagnifyingGlassIcon, PhotoIcon, UserGroupIcon, XMarkIcon, Squares2X2Icon, SparklesIcon, StarIcon, ChevronRightIcon } from '@heroicons/vue/24/outline';\n\n// 添加图标映射函数\n\nexport default {\n  __name: 'HeadView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const getIcon = menuKey => {\n      const iconMap = {\n        'home': Squares2X2Icon,\n        'profile': UserIcon,\n        'resumes': DocumentIcon,\n        'favorites': HeartIcon,\n        'notifications': BellIcon,\n        'settings': Cog6ToothIcon,\n        'security': ShieldCheckIcon,\n        'account': WrenchScrewdriverIcon,\n        'logout': ArrowRightOnRectangleIcon,\n        'crown': SparklesIcon\n      };\n      return iconMap[menuKey] || UserIcon; // 默认返回 UserIcon\n    };\n\n    // 状态管理\n    const router = useRouter();\n    const route = useRoute();\n    const authStore = useAuthStore();\n    const accountStore = useAccountStore();\n    const mobileMenuOpen = ref(false);\n    const userMenuOpen = ref(false);\n    const showMessageMenu = ref(false);\n    const resourceMenuOpen = ref(false);\n    const mobileSubmenuOpen = ref({});\n    const userBasicInfo = ref(null);\n\n    // 模拟消息数据\n    const messages = ref([{\n      id: 1,\n      content: '您的简历被查看了',\n      time: '10分钟前',\n      isRead: false,\n      type: 'system'\n    }, {\n      id: 2,\n      content: '有新的职位推荐',\n      time: '1小时前',\n      isRead: true,\n      type: 'system'\n    }, {\n      id: 3,\n      content: '张三给你发送了一条私信',\n      time: '2小时前',\n      isRead: false,\n      type: 'private'\n    }]);\n\n    // 切换消息菜单\n    const toggleMessageMenu = () => {\n      showMessageMenu.value = !showMessageMenu.value;\n      if (showMessageMenu.value) {\n        userMenuOpen.value = false;\n      }\n    };\n\n    // 查看全部消息\n    const viewAllMessages = () => {\n      showMessageMenu.value = false; // 关闭消息菜单\n      router.push('/user?tab=messages');\n    };\n\n    // 监听 accountStore 中的用户信息变化\n    watch([() => accountStore.userInfo, () => authStore.isLoggedIn], newUserInfo => {\n      if (newUserInfo && authStore.isLoggedIn) {\n        userBasicInfo.value = _objectSpread({}, newUserInfo);\n      } else {\n        userBasicInfo.value = null;\n      }\n    }, {\n      immediate: true,\n      deep: true\n    });\n\n    // 响应式计算\n    const isMobile = computed(() => {\n      return window.innerWidth < 1024;\n    });\n\n    // 统一的菜单关闭处理\n    const closeMenus = e => {\n      if (!e.target.closest('.resource-menu')) {\n        resourceMenuOpen.value = false;\n      }\n      if (!e.target.closest('.user-menu')) {\n        userMenuOpen.value = false;\n      }\n      if (!e.target.closest('.message-menu') && !e.target.closest('.message-button')) {\n        showMessageMenu.value = false;\n      }\n    };\n\n    // 移动端菜单开关\n    const toggleMenu = () => {\n      mobileMenuOpen.value = !mobileMenuOpen.value;\n      if (mobileMenuOpen.value) {\n        userMenuOpen.value = false;\n        resourceMenuOpen.value = false;\n        mobileSubmenuOpen.value = {};\n      }\n    };\n\n    // 判断当前路由是否匹配\n    const isCurrentRoute = href => {\n      // 对于模板相关的路由，使用 startsWith 判断\n      if (href === '/templates') {\n        return route.path.startsWith('/templates');\n      }\n      // 对于社区相关的路由，使用 startsWith 判断\n      if (href === '/community') {\n        return route.path.startsWith('/community');\n      }\n      // 对于作品集相关的路由，使用 startsWith 判断\n      if (href === '/portfolio') {\n        return route.path.startsWith('/portfolio');\n      }\n      // 其他路由保持完全匹配\n      return route.path === href;\n    };\n\n    // 直接从 store 获取状态\n    const isAuthenticated = computed(() => {\n      // 同时检查登录状态和用户信息\n      return authStore.isLoggedIn && accountStore.userInfo !== null;\n    });\n    const username = computed(() => {\n      if (!isAuthenticated.value) return '';\n      return accountStore.username;\n    });\n    const avatarUrl = computed(() => {\n      if (!isAuthenticated.value) return defaultAvatar;\n      const avatar = accountStore.avatar;\n      if (!avatar || avatar === 'null' || avatar === 'undefined') {\n        return defaultAvatar;\n      }\n      // 检查 avatar 是否是完整的 URL 或 base64 数据\n      if (avatar.startsWith('http') || avatar.startsWith('data:image')) {\n        return avatar;\n      }\n      // 如果是相对路径，则拼接基础 URL\n      return avatar.startsWith('/') ? `${process.env.VUE_APP_API_BASE_URL}${avatar}` : `${process.env.VUE_APP_API_BASE_URL}/${avatar}`;\n    });\n\n    // 判断是否在消息页面\n    const isMessageRoute = computed(() => {\n      return route.path.includes('/user') && route.query.tab === 'messages';\n    });\n\n    // 测试用：模拟未读消息数量\n    const unreadMessagesCount = ref(5);\n\n    // 获取未读消息数量\n    const fetchUnreadMessagesCount = async () => {\n      try {\n        // TODO: 调用 API 获取未读消息数量\n        // const response = await api.getUnreadMessagesCount()\n        // unreadMessagesCount.value = response.data.count\n        unreadMessagesCount.value = 5; // 临时测试数据\n      } catch (error) {\n        console.error('获取未读消息数量失败:', error);\n      }\n    };\n\n    // 在用户登录状态变化时获取未读消息数量\n    watch(() => authStore.isLoggedIn, newValue => {\n      if (newValue) {\n        fetchUnreadMessagesCount();\n      } else {\n        unreadMessagesCount.value = 0;\n      }\n    }, {\n      immediate: true\n    });\n\n    // 生命周期钩子\n    onMounted(async () => {\n      document.addEventListener('click', closeMenus);\n      window.addEventListener('resize', () => {\n        if (!isMobile.value) {\n          mobileMenuOpen.value = false;\n        }\n      });\n\n      // 检查登录状态\n      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';\n      const token = localStorage.getItem('token');\n      if (isLoggedIn && token) {\n        authStore.isLoggedIn = true;\n        request.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      }\n      if (authStore.isLoggedIn) {\n        try {\n          await Promise.all([accountStore.fetchUserInfo(), fetchPointsInfo()]);\n          console.log('Fetched User Info:', accountStore.userInfo);\n        } catch (error) {\n          console.error('Failed to fetch user info:', error);\n        }\n      }\n      eventBus.on('avatar-updated', handleAvatarUpdate);\n\n      // 监听支付成功事件\n      window.addEventListener('payment-success', refreshUserInfo);\n    });\n\n    // 保持原有的事件清理\n    onUnmounted(() => {\n      eventBus.off('avatar-updated', handleAvatarUpdate);\n      // 移除支付成功事件监听\n      window.removeEventListener('payment-success', refreshUserInfo);\n    });\n\n    // 简化头像更新处理方法\n    const handleAvatarUpdate = newAvatar => {\n      if (accountStore.userInfo) {\n        accountStore.userInfo = _objectSpread(_objectSpread({}, accountStore.userInfo), {}, {\n          avatar: newAvatar\n        });\n      }\n    };\n\n    // 修改会员状态相关的计算属性\n    const isVip = computed(() => {\n      return accountStore.userInfo?.is_vip || false;\n    });\n\n    // 会员类型文本\n    const vipTypeText = computed(() => {\n      const userInfo = accountStore.userInfo;\n      if (!userInfo) return '普通用户';\n      return userInfo.vip_status || '普通用户';\n    });\n\n    // 剩余天数文本\n    const remainingDays = computed(() => {\n      const userInfo = accountStore.userInfo;\n      if (!userInfo?.is_vip || userInfo.vip_type === 'lifetime') return '';\n      if (userInfo.vip_expire_time) {\n        const expireDate = new Date(userInfo.vip_expire_time);\n        const now = new Date();\n        const diffDays = Math.floor((expireDate - now) / (1000 * 60 * 60 * 24));\n        if (diffDays > 0) {\n          return `剩余 ${diffDays} 天`;\n        }\n      }\n      return '';\n    });\n\n    // 会员按钮文本\n    const vipButtonText = computed(() => {\n      const userInfo = accountStore.userInfo;\n      if (!userInfo?.is_vip) return '升级会员';\n      if (userInfo.vip_type === 'lifetime') return '会员中心';\n      if (userInfo.vip_expire_time) {\n        const expireDate = new Date(userInfo.vip_expire_time);\n        const now = new Date();\n        const diffDays = Math.ceil((expireDate - now) / (1000 * 60 * 60 * 24));\n        return diffDays <= 30 ? '续费会员' : '会员中心';\n      }\n      return '会员中心';\n    });\n\n    // 会员状态相关的计算属性\n    const isExpiringSoon = computed(() => {\n      const userInfo = accountStore.userInfo;\n      if (!userInfo?.is_vip || userInfo.vip_type === 'lifetime') return false;\n      if (userInfo.vip_expire_time) {\n        const expireDate = new Date(userInfo.vip_expire_time);\n        const now = new Date();\n        const diffDays = Math.ceil((expireDate - now) / (1000 * 60 * 60 * 24));\n        return diffDays <= 30;\n      }\n      return false;\n    });\n\n    // 处理会员按钮点击\n    const handleVipButton = () => {\n      const userInfo = accountStore.userInfo;\n      if (!userInfo?.is_vip) {\n        router.push('/pro');\n      } else if (isExpiringSoon.value) {\n        router.push('/pro/renew');\n      } else {\n        router.push('/user?tab=membership');\n      }\n      showDropdown.value = false;\n      userMenuOpen.value = false;\n    };\n\n    // 用户菜单选项\n    const userMenuItems = computed(() => {\n      return [{\n        key: 'home',\n        label: '用户中心',\n        icon: 'home',\n        action: () => {\n          router.push('/user?tab=home');\n          showDropdown.value = false;\n          userMenuOpen.value = false;\n        }\n      }, {\n        key: 'profile',\n        label: '我的档案',\n        icon: 'profile',\n        action: () => {\n          router.push('/user?tab=profile');\n          showDropdown.value = false;\n          userMenuOpen.value = false;\n        }\n      }, {\n        key: 'resumes',\n        label: '我的简历',\n        icon: 'resumes',\n        action: () => {\n          router.push('/user?tab=resumes');\n          showDropdown.value = false;\n          userMenuOpen.value = false;\n        }\n      }, {\n        key: 'settings',\n        label: '账号设置',\n        icon: 'settings',\n        action: () => {\n          router.push('/user?tab=settings');\n          showDropdown.value = false;\n          userMenuOpen.value = false;\n        }\n      }, {\n        key: 'membership',\n        label: '会员中心',\n        icon: 'crown',\n        action: () => {\n          router.push('/user?tab=membership');\n          showDropdown.value = false;\n          userMenuOpen.value = false;\n        }\n      }, {\n        key: 'logout',\n        label: '退出登录',\n        icon: 'logout',\n        action: handleLogout\n      }];\n    });\n\n    // 处理退出登录\n    const handleLogout = async () => {\n      try {\n        userMenuOpen.value = false;\n        await authStore.logout();\n        // 清除其他状态\n        userBasicInfo.value = null;\n        unreadMessagesCount.value = 0;\n        messages.value = [];\n        mobileMenuOpen.value = false;\n        showMessageMenu.value = false;\n        resourceMenuOpen.value = false;\n        mobileSubmenuOpen.value = {};\n        showToast('退出成功', 'success');\n        const currentPath = router.currentRoute.value.fullPath;\n        router.push(`/login?redirect=${encodeURIComponent(currentPath)}`);\n      } catch (error) {\n        console.error('退出失败:', error);\n        showToast('退出失败，请重试', 'error');\n      }\n    };\n\n    // 搜索相关状态\n    const searchQuery = ref('');\n    const showSearchModal = ref(false);\n    const searchInput = ref(null);\n\n    // 监听 ESC 键关闭搜索弹窗\n    onMounted(() => {\n      document.addEventListener('keydown', e => {\n        if (e.key === 'Escape') {\n          showSearchModal.value = false;\n        }\n      });\n    });\n\n    // 修改搜索处理函数\n    const handleSearch = () => {\n      if (!searchQuery.value.trim()) return;\n      router.push({\n        path: '/search',\n        query: {\n          q: searchQuery.value\n        }\n      });\n      showSearchModal.value = false;\n    };\n    const handleSearchByType = type => {\n      if (!searchQuery.value.trim()) return;\n      router.push({\n        path: type.path,\n        query: {\n          q: searchQuery.value\n        }\n      });\n      showSearchModal.value = false;\n    };\n\n    // 搜索类型配置\n    const searchTypes = [{\n      label: '文章',\n      type: 'articles',\n      icon: DocumentTextIcon,\n      path: '/search/articles'\n    }, {\n      label: '作品集',\n      type: 'portfolio',\n      icon: PhotoIcon,\n      path: '/search/portfolio'\n    }, {\n      label: '用户',\n      type: 'users',\n      icon: UserGroupIcon,\n      path: '/search/users'\n    }];\n\n    // 监听点击事件，关闭搜索建议\n    onMounted(() => {\n      document.addEventListener('click', e => {\n        if (!e.target.closest('.search-container')) {\n          showSearchModal.value = false;\n        }\n      });\n    });\n    const refreshUserInfo = async () => {\n      try {\n        await accountStore.fetchUserInfo();\n        console.log('Refreshed User Info:', accountStore.userInfo);\n      } catch (error) {\n        console.error('Failed to refresh user info:', error);\n      }\n    };\n\n    // 积分信息\n    const pointsInfo = ref({\n      balance: 0,\n      level: 1,\n      sign_in_days: 0,\n      total_earned: 0\n    });\n\n    // 获取积分信息\n    const fetchPointsInfo = async () => {\n      try {\n        const response = await membership.getPointsInfo();\n        if (response?.data?.code === 200) {\n          pointsInfo.value = response.data.data;\n        }\n      } catch (error) {\n        console.error('获取积分信息失败:', error);\n      }\n    };\n    const showDropdown = ref(false);\n    const dropdownRef = ref(null);\n\n    // 切换下拉菜单\n    const toggleDropdown = () => {\n      showDropdown.value = !showDropdown.value;\n    };\n\n    // 处理点击事件\n    const handleClickOutside = event => {\n      if (dropdownRef.value && !dropdownRef.value.contains(event.target)) {\n        showDropdown.value = false;\n      }\n    };\n    onMounted(() => {\n      // 添加全局点击事件监听\n      document.addEventListener('click', handleClickOutside);\n    });\n    onUnmounted(() => {\n      // 移除全局点击事件监听\n      document.removeEventListener('click', handleClickOutside);\n    });\n\n    // 在组件挂载时获取数据\n    onMounted(async () => {\n      await fetchPointsInfo();\n    });\n    const __returned__ = {\n      getIcon,\n      router,\n      route,\n      authStore,\n      accountStore,\n      mobileMenuOpen,\n      userMenuOpen,\n      showMessageMenu,\n      resourceMenuOpen,\n      mobileSubmenuOpen,\n      userBasicInfo,\n      messages,\n      toggleMessageMenu,\n      viewAllMessages,\n      isMobile,\n      closeMenus,\n      toggleMenu,\n      isCurrentRoute,\n      isAuthenticated,\n      username,\n      avatarUrl,\n      isMessageRoute,\n      unreadMessagesCount,\n      fetchUnreadMessagesCount,\n      handleAvatarUpdate,\n      isVip,\n      vipTypeText,\n      remainingDays,\n      vipButtonText,\n      isExpiringSoon,\n      handleVipButton,\n      userMenuItems,\n      handleLogout,\n      searchQuery,\n      showSearchModal,\n      searchInput,\n      handleSearch,\n      handleSearchByType,\n      searchTypes,\n      refreshUserInfo,\n      pointsInfo,\n      fetchPointsInfo,\n      showDropdown,\n      dropdownRef,\n      toggleDropdown,\n      handleClickOutside,\n      ref,\n      computed,\n      onMounted,\n      onUnmounted,\n      watch,\n      get useRouter() {\n        return useRouter;\n      },\n      get useRoute() {\n        return useRoute;\n      },\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get useAccountStore() {\n        return useAccountStore;\n      },\n      get defaultAvatar() {\n        return defaultAvatar;\n      },\n      get navigation() {\n        return navigation;\n      },\n      get eventBus() {\n        return eventBus;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get request() {\n        return request;\n      },\n      get membership() {\n        return membership;\n      },\n      get DocumentTextIcon() {\n        return DocumentTextIcon;\n      },\n      get DocumentIcon() {\n        return DocumentIcon;\n      },\n      get UserIcon() {\n        return UserIcon;\n      },\n      get Cog6ToothIcon() {\n        return Cog6ToothIcon;\n      },\n      get ArrowRightOnRectangleIcon() {\n        return ArrowRightOnRectangleIcon;\n      },\n      get BellIcon() {\n        return BellIcon;\n      },\n      get HeartIcon() {\n        return HeartIcon;\n      },\n      get ShieldCheckIcon() {\n        return ShieldCheckIcon;\n      },\n      get UserCircleIcon() {\n        return UserCircleIcon;\n      },\n      get WrenchScrewdriverIcon() {\n        return WrenchScrewdriverIcon;\n      },\n      get MagnifyingGlassIcon() {\n        return MagnifyingGlassIcon;\n      },\n      get PhotoIcon() {\n        return PhotoIcon;\n      },\n      get UserGroupIcon() {\n        return UserGroupIcon;\n      },\n      get XMarkIcon() {\n        return XMarkIcon;\n      },\n      get Squares2X2Icon() {\n        return Squares2X2Icon;\n      },\n      get SparklesIcon() {\n        return SparklesIcon;\n      },\n      get StarIcon() {\n        return StarIcon;\n      },\n      get ChevronRightIcon() {\n        return ChevronRightIcon;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","watch","useRouter","useRoute","useAuthStore","useAccountStore","defaultAvatar","navigation","eventBus","showToast","request","membership","DocumentTextIcon","DocumentIcon","UserIcon","Cog6ToothIcon","ArrowRightOnRectangleIcon","BellIcon","HeartIcon","ShieldCheckIcon","UserCircleIcon","WrenchScrewdriverIcon","MagnifyingGlassIcon","PhotoIcon","UserGroupIcon","XMarkIcon","Squares2X2Icon","SparklesIcon","StarIcon","ChevronRightIcon","getIcon","menuKey","iconMap","router","route","authStore","accountStore","mobileMenuOpen","userMenuOpen","showMessageMenu","resourceMenuOpen","mobileSubmenuOpen","userBasicInfo","messages","id","content","time","isRead","type","toggleMessageMenu","value","viewAllMessages","push","userInfo","isLoggedIn","newUserInfo","_objectSpread","immediate","deep","isMobile","window","innerWidth","closeMenus","e","target","closest","toggleMenu","isCurrentRoute","href","path","startsWith","isAuthenticated","username","avatarUrl","avatar","process","env","VUE_APP_API_BASE_URL","isMessageRoute","includes","query","tab","unreadMessagesCount","fetchUnreadMessagesCount","error","console","newValue","document","addEventListener","localStorage","getItem","token","defaults","headers","common","Promise","all","fetchUserInfo","fetchPointsInfo","log","on","handleAvatarUpdate","refreshUserInfo","off","removeEventListener","newAvatar","isVip","is_vip","vipTypeText","vip_status","remainingDays","vip_type","vip_expire_time","expireDate","Date","now","diffDays","Math","floor","vipButtonText","ceil","isExpiringSoon","handleVipButton","showDropdown","userMenuItems","key","label","icon","action","handleLogout","logout","currentPath","currentRoute","fullPath","encodeURIComponent","searchQuery","showSearchModal","searchInput","handleSearch","trim","q","handleSearchByType","searchTypes","pointsInfo","balance","level","sign_in_days","total_earned","response","getPointsInfo","data","code","dropdownRef","toggleDropdown","handleClickOutside","event","contains"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/components/HeadView.vue"],"sourcesContent":["<template>\n  <header class=\"fixed w-full top-0 z-50 bg-white shadow\">\n    <!-- 主导航栏 -->\n    <nav class=\"mx-auto flex max-w-7xl items-center p-4 lg:px-8\" aria-label=\"Global\">\n      <!-- Logo 区域 -->\n      <div class=\"flex-shrink-0 flex items-center mr-8\">\n        <router-link to=\"/\" class=\"flex items-center space-x-2\">\n          <img src=\"@/assets/images/logo.png\" alt=\"\" class=\"w-8 h-8\">\n          <span class=\"text-gray-500 text-xl whitespace-nowrap\">飞鸟简历</span>\n        </router-link>\n      </div>\n\n      <!-- 桌面端导航菜单 -->\n      <div class=\"hidden lg:flex lg:gap-x-8\">\n        <template v-for=\"item in navigation.main\" :key=\"item.name\">\n          <!-- 普通菜单项 -->\n          <router-link v-if=\"!item.children\" :to=\"item.href\" :class=\"[\n            'text-base leading-6 py-2 border-b-2',\n            isCurrentRoute(item.href)\n              ? 'text-gray-900 font-medium border-gray-900'\n              : 'text-gray-500 hover:text-gray-900 border-transparent hover:border-gray-300'\n          ]\">\n            {{ item.name }}\n          </router-link>       \n        </template>\n\n        <router-link to=\"/pro\"\n          :class=\"[\n            'text-base leading-6 flex items-center py-2 border-b-2',\n            isCurrentRoute('/pro')\n              ? 'text-yellow-600 border-yellow-600'\n              : 'text-yellow-600 hover:text-yellow-500 border-transparent hover:border-yellow-500'\n          ]\">\n          <svg class=\"w-5 h-5 mr-1\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n            <path d=\"M5 16L3 5L8.5 10L12 4L15.5 10L21 5L19 16H5Z\" stroke-width=\"2\" stroke-linecap=\"round\"\n              stroke-linejoin=\"round\" />\n          </svg>\n          会员\n        </router-link>\n      </div>\n\n      <!-- 搜索框 -->\n      <div class=\"hidden lg:flex items-center justify-center ml-4\">\n        <!-- 搜索图标按钮 -->\n        <button \n          @click.stop=\"showSearchModal = true\"\n          class=\"p-2 text-gray-500 hover:text-gray-900 rounded-full hover:bg-gray-100\"\n        >\n          <MagnifyingGlassIcon class=\"w-5 h-5\" />\n        </button>\n      </div>\n\n      <!-- 右侧用户区域 -->\n      <div class=\"flex items-center ml-auto\">\n        <template v-if=\"!isAuthenticated\">\n          <!-- 未登录状态 -->\n          <div class=\"hidden lg:block\">\n            <router-link \n              :to=\"`/login?redirect=${encodeURIComponent($route.fullPath)}`\" \n              class=\"text-base leading-6 text-gray-900 hover:text-indigo-600\"\n            >\n              登录\n            </router-link>\n            <router-link \n              to=\"/register\"\n              class=\"ml-4 text-base leading-6 text-white bg-primary-500 px-3 py-2 rounded-md hover:bg-primary-500\"\n            >\n              注册\n            </router-link>\n          </div>\n        </template>\n\n        <!-- 已登录状态 -->\n        <template v-else>\n          <!-- 消息图标 -->\n          <button \n            @click.stop=\"toggleMessageMenu\"\n            class=\"hidden md:block p-2 mr-2 text-gray-500 hover:text-indigo-600 relative\"\n            :class=\"{ 'text-indigo-600': isMessageRoute }\"\n          >\n            <BellIcon \n              class=\"w-5 h-5\" \n              :class=\"{ 'text-indigo-600': isMessageRoute }\"\n            />\n            <!-- 未读消息数量 -->\n            <span \n              v-if=\"unreadMessagesCount > 0\"\n              class=\"absolute -top-1 -right-1 min-w-[16px] h-4 bg-red-500 rounded-full text-[10px] font-medium text-white flex items-center justify-center px-1\"\n            >\n              {{ unreadMessagesCount > 99 ? '99+' : unreadMessagesCount }}\n            </span>\n          </button>\n\n          <!-- 消息下拉菜单 -->\n          <div v-if=\"showMessageMenu\" \n            class=\"fixed lg:absolute top-[72px] bg-white shadow-lg z-[100] w-80 rounded-lg\"\n            :style=\"{\n              [isMobile ? '' : 'right']: isMobile ? '' : 'calc((100vw - 1280px) / 2 + 120px)',\n            }\"\n          >\n            <!-- 消息菜单头部 -->\n            <div class=\"px-4 py-3 border-b border-gray-100\">\n              <div class=\"flex items-center justify-between\">\n                <h3 class=\"text-base font-medium text-gray-900\">消息通知</h3>\n                <button class=\"text-sm text-gray-500 hover:text-gray-700\">全部标记已读</button>\n              </div>\n            </div>\n            \n            <!-- 消息列表 -->\n            <div class=\"max-h-[400px] overflow-y-auto\">\n              <div v-if=\"messages.length === 0\" class=\"py-8 text-center text-gray-500\">\n                暂无消息\n              </div>\n              <div v-else class=\"divide-y divide-gray-100 py-1\">\n                <div v-for=\"message in messages\" :key=\"message.id\" \n                  class=\"px-4 py-3 hover:bg-gray-50 cursor-pointer\"\n                >\n                  <div class=\"flex items-start space-x-3\">\n                    <div class=\"flex-shrink-0\">\n                      <div class=\"w-2 h-2 mt-2 rounded-full\" \n                        :class=\"message.isRead ? 'bg-gray-300' : 'bg-blue-500'\"\n                      ></div>\n                    </div>\n                    <div class=\"flex-1 min-w-0\">\n                      <div class=\"flex items-center justify-between mb-1\">\n                        <span \n                          class=\"text-xs px-1.5 py-0.5 rounded\"\n                          :class=\"{\n                            'bg-blue-100 text-blue-700': message.type === 'system',\n                            'bg-green-100 text-green-700': message.type === 'private'\n                          }\"\n                        >\n                          {{ message.type === 'system' ? '系统通知' : '私信' }}\n                        </span>\n                        <span class=\"text-xs text-gray-500\">{{ message.time }}</span>\n                      </div>\n                      <p class=\"text-sm text-gray-900\">{{ message.content }}</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <!-- 消息菜单底部 -->\n            <div class=\"px-4 py-3 border-t border-gray-100 text-center\">\n              <button \n                class=\"text-sm text-indigo-600 hover:text-indigo-700\"\n                @click=\"viewAllMessages\"\n              >\n                查看全部消息\n              </button>\n            </div>\n          </div>\n\n          <div class=\"relative\" ref=\"dropdownRef\">\n            <div \n              class=\"flex items-center cursor-pointer\" \n              @click=\"toggleDropdown\"\n            >\n              <img \n                :src=\"avatarUrl\"\n                @error=\"(e) => {\n                  console.error('Avatar load failed:', e)\n                  e.target.src = defaultAvatar\n                }\"\n                class=\"h-8 w-8 rounded-full\"\n                alt=\"用户头像\"\n              />\n              <span class=\"hidden lg:inline\">\n                {{ username }}\n              </span>\n              <svg class=\"h-5 w-5\" :class=\"{ 'rotate-180': showDropdown }\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fill-rule=\"evenodd\"\n                  d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\n                  clip-rule=\"evenodd\" />\n              </svg>\n            </div>\n\n            <!-- 下拉菜单 -->\n            <div v-if=\"showDropdown\" \n              :class=\"[\n                'fixed lg:absolute',\n                'right-0 top-[60px]',\n                'w-full lg:w-80',\n                'bg-white shadow-lg',\n                'py-1',\n                'border-t lg:border lg:border-gray-100',\n                'z-50',\n                isMobile ? 'inset-x-0' : '',\n                isMobile ? 'h-[calc(100vh-60px)]' : '',\n                isMobile ? 'overflow-y-auto' : ''\n              ]\"\n              @click.stop\n            >\n              <!-- 用户信息头部 -->\n              <div class=\"px-4 lg:px-6 py-5 border-b border-gray-100\">\n                <div class=\"flex items-center space-x-3\">\n                  <img \n                    :src=\"avatarUrl\"\n                    :key=\"avatarUrl\"\n                    class=\"h-12 lg:h-14 w-12 lg:w-14 rounded-full\"\n                    alt=\"用户头像\" \n                    @error=\"handleImageError\" \n                  />\n                  <div class=\"flex-1\">\n                    <div class=\"flex items-center justify-between\">\n                      <div>\n                        <div class=\"text-base lg:text-lg font-medium text-gray-900\">{{ username }}</div>\n                        <div class=\"text-sm flex flex-col\" :class=\"{\n                          'text-[#1A56DB]': isVip\n                        }\">\n                          <span>{{ vipTypeText }}</span>\n                          <span v-if=\"remainingDays\" class=\"mt-0.5 text-xs\">{{ remainingDays }}</span>\n                        </div>\n                      </div>\n                      <button\n                        @click=\"handleVipButton\"\n                        class=\"px-2.5 lg:px-3 py-1.5 text-xs lg:text-sm bg-gradient-to-r from-[#1A56DB] to-blue-500 text-white rounded-full hover:opacity-90 transition-opacity flex items-center whitespace-nowrap\"\n                      >\n                        <SparklesIcon class=\"w-3.5 h-3.5 mr-1\" />\n                        {{ vipButtonText }}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n                <!-- 积分信息 -->\n                <div class=\"mt-4 flex items-center justify-between px-1\">\n                  <div class=\"flex items-center space-x-2\">\n                    <StarIcon class=\"w-4 h-4 text-[#1A56DB]\" />\n                    <span class=\"text-sm text-gray-600\">我的积分</span>\n                  </div>\n                  <div class=\"flex items-center space-x-3\">\n                    <span class=\"text-lg font-medium text-[#1A56DB]\">{{ pointsInfo.balance || 0 }}</span>\n                    <button \n                      @click=\"() => {\n                        router.push('/user?tab=membership')\n                        showDropdown.value = false\n                        userMenuOpen.value = false\n                      }\"\n                      class=\"text-xs text-gray-500 hover:text-gray-700 flex items-center\"\n                    >\n                      <span>查看详情</span>\n                      <ChevronRightIcon class=\"w-4 h-4 ml-0.5\" />\n                    </button>\n                  </div>\n                </div>\n              </div>\n\n              <!-- 菜单项 -->\n              <div class=\"py-2.5\">\n                <button v-for=\"item in userMenuItems\" :key=\"item.key\"\n                  class=\"block w-full px-4 lg:px-6 py-3 lg:py-3.5 text-sm lg:text-base text-gray-700 hover:bg-blue-50 text-left transition-colors duration-200\"\n                  @click=\"item.action\">\n                  <div class=\"flex items-center space-x-3\">\n                    <component \n                      :is=\"getIcon(item.icon)\" \n                      class=\"flex-shrink-0 h-4 lg:h-5 w-4 lg:w-5 text-[#1A56DB]/60\" \n                    />\n                    <span>{{ item.label }}</span>\n                  </div>\n                </button>\n              </div>\n\n            </div>\n          </div>\n        </template>\n\n        <!-- 移动端菜单按钮 -->\n        <button type=\"button\" @click=\"toggleMenu\"\n          class=\"lg:hidden inline-flex items-center justify-center rounded-md ml-2 p-2 text-gray-700\">\n          <span class=\"sr-only\">打开菜单</span>\n          <svg class=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5\" />\n          </svg>\n        </button>\n      </div>\n    </nav>\n\n    <!-- 用户下拉菜单 -->\n    <div v-if=\"userMenuOpen\" :class=\"[\n      'fixed lg:absolute',\n      'top-[60px]',\n      'bg-white shadow-lg z-[100]',\n      'inset-x-0 lg:inset-x-auto',\n      'w-full lg:w-80 lg:rounded-lg'\n    ]\" :style=\"{\n      [isMobile ? '' : 'right']: isMobile ? '' : '0',\n    }\">\n      <!-- 用户信息头部 -->\n      <div class=\"px-6 py-5 border-b border-gray-100\">\n        <div class=\"flex items-center space-x-3\">\n          <img \n            :src=\"avatarUrl\"\n            :key=\"avatarUrl\"\n            class=\"h-14 w-14 rounded-full\"\n            alt=\"用户头像\" \n            @error=\"handleImageError\" \n          />\n          <div class=\"flex-1\">\n            <div class=\"flex items-center justify-between\">\n              <div>\n                <div class=\"text-lg font-medium text-gray-900\">{{ username }}</div>\n                <div class=\"text-sm flex flex-col\" :class=\"{\n                  'text-[#1A56DB]': isVip\n                }\">\n                  <span>{{ vipTypeText }}</span>\n                  <span v-if=\"remainingDays\" class=\"mt-0.5 text-xs\">{{ remainingDays }}</span>\n                </div>\n              </div>\n              <button\n                @click=\"handleVipButton\"\n                class=\"px-3 py-1.5 text-sm bg-gradient-to-r from-[#1A56DB] to-blue-500 text-white rounded-full hover:opacity-90 transition-opacity flex items-center whitespace-nowrap\"\n              >\n                <SparklesIcon class=\"w-3.5 h-3.5 mr-1\" />\n                {{ vipButtonText }}\n              </button>\n            </div>\n          </div>\n        </div>\n        <!-- 积分信息 -->\n        <div class=\"mt-4 flex items-center justify-between px-1\">\n          <div class=\"flex items-center space-x-2\">\n            <StarIcon class=\"w-4 h-4 text-[#1A56DB]\" />\n            <span class=\"text-sm text-gray-600\">我的积分</span>\n          </div>\n          <div class=\"flex items-center space-x-3\">\n            <span class=\"text-lg font-medium text-[#1A56DB]\">{{ pointsInfo.balance || 0 }}</span>\n            <button \n              @click=\"() => {\n                router.push('/user?tab=membership')\n                showDropdown.value = false\n                userMenuOpen.value = false\n              }\"\n              class=\"text-xs text-gray-500 hover:text-gray-700 flex items-center\"\n            >\n              <span>查看详情</span>\n              <ChevronRightIcon class=\"w-4 h-4 ml-0.5\" />\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- 菜单项 -->\n      <div class=\"py-2.5\">\n        <button v-for=\"item in userMenuItems\" :key=\"item.key\"\n          class=\"block w-full px-6 py-3.5 text-base text-gray-700 hover:bg-blue-50 text-left transition-colors duration-200\"\n          @click=\"item.action\">\n          <div class=\"flex items-center space-x-3\">\n            <component \n              :is=\"getIcon(item.icon)\" \n              class=\"flex-shrink-0 h-5 w-5 text-[#1A56DB]/60\" \n            />\n            <span>{{ item.label }}</span>\n          </div>\n        </button>\n      </div>\n\n    </div>\n\n    <!-- 移动端菜单抽屉 -->\n    <div v-if=\"mobileMenuOpen\" class=\"fixed inset-0 z-50\" @click=\"toggleMenu\">\n      <div class=\"fixed inset-0 bg-black/25\"></div>\n\n      <div class=\"fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-white sm:max-w-sm\" @click.stop>\n        <!-- 移动端菜单头部 -->\n        <div class=\"flex items-center justify-between p-4\">\n          <router-link to=\"/\" class=\"flex items-center space-x-2\" @click=\"toggleMenu\">\n            <img src=\"@/assets/images/logo.png\" alt=\"\" class=\"w-8 h-8\">\n            <span class=\"text-gray-500 text-xl whitespace-nowrap\">飞鸟简历</span>\n          </router-link>\n          <!-- 关闭按钮 -->\n          <button type=\"button\" @click=\"toggleMenu\" class=\"p-2 text-gray-700\">\n            <span class=\"sr-only\">关闭菜单</span>\n            <svg class=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        <!-- 移动端菜单内容 -->\n        <div class=\"border-t border-gray-200\">\n          <!-- 导航菜单 -->\n          <div>\n            <template v-for=\"item in navigation.main\" :key=\"item.name\">\n              <!-- 普通菜单项 -->\n              <router-link v-if=\"!item.children\" :to=\"item.href\"\n                class=\"block px-4 py-3 text-base text-gray-900 border-b border-gray-100\"\n                :class=\"isCurrentRoute(item.href) ? 'text-indigo-600' : ''\" @click=\"toggleMenu\">\n                {{ item.name }}\n              </router-link>\n\n              <!-- 带子菜单的项 -->\n              <div v-else class=\"border-b border-gray-100\">\n                <button class=\"flex items-center justify-between w-full px-4 py-3 text-base text-gray-900\"\n                  @click=\"toggleMobileSubmenu(item.name)\">\n                  <span>{{ item.name }}</span>\n                  <svg class=\"w-5 h-5 transition-transform duration-200\"\n                    :class=\"{ 'rotate-180': mobileSubmenuOpen[item.name] }\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <path fill-rule=\"evenodd\"\n                      d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\n                      clip-rule=\"evenodd\" />\n                  </svg>\n                </button>\n\n                <div v-show=\"mobileSubmenuOpen[item.name]\" class=\"bg-gray-50\">\n                  <template v-for=\"category in item.children\" :key=\"category.name\">\n                    <div class=\"px-4 py-2\">\n                      <div class=\"font-medium text-gray-900\">{{ category.name }}</div>\n                      <div class=\"mt-1 space-y-1\">\n                        <router-link v-for=\"subItem in category.children\" :key=\"subItem.name\" :to=\"subItem.href\"\n                          class=\"block py-1 pl-3 text-sm text-gray-600 hover:text-indigo-600\" @click=\"toggleMenu\">\n                          {{ subItem.name }}\n                        </router-link>\n                      </div>\n                    </div>\n                  </template>\n                </div>\n              </div>\n            </template>\n          </div>\n\n          <!-- 未登录状态下显示登录注册按钮 -->\n          <div v-if=\"!isAuthenticated\" class=\"p-4 space-y-3\">\n            <router-link to=\"/login?redirect=${encodeURIComponent($route.fullPath)}`\"\n              class=\"block w-full text-center px-4 py-2 text-[14px] text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50\"\n              @click=\"toggleMenu\">\n              登录\n            </router-link>\n            <router-link to=\"/register?redirect=${encodeURIComponent($route.fullPath)}`\"\n              class=\"block w-full text-center px-4 py-2 text-[14px] text-white bg-indigo-600 rounded-md hover:bg-indigo-500\"\n              @click=\"toggleMenu\">\n              注册\n            </router-link>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 搜索弹窗 -->\n    <Transition\n      enter-active-class=\"transition duration-200 ease-out\"\n      enter-from-class=\"opacity-0 scale-95\"\n      enter-to-class=\"opacity-100 scale-100\"\n      leave-active-class=\"transition duration-150 ease-in\"\n      leave-from-class=\"opacity-100 scale-100\"\n      leave-to-class=\"opacity-0 scale-95\"\n    >\n      <div v-if=\"showSearchModal\" class=\"fixed inset-0 z-[100]\">\n        <!-- 黑色遮罩 -->\n        <div \n          class=\"fixed inset-0 bg-black/50 transition-opacity\" \n          @click=\"showSearchModal = false\"\n        />\n        \n        <!-- 关闭按钮 -->\n        <button \n          @click=\"showSearchModal = false\"\n          class=\"fixed top-4 right-4 p-2 rounded-full bg-black/20 hover:bg-black/30 transition-colors z-[110]\"\n        >\n          <XMarkIcon class=\"w-6 h-6 text-white\" />\n        </button>\n\n        <!-- 搜索框容器 -->\n        <div class=\"relative min-h-screen flex items-start justify-center p-4 sm:p-6\" @click.stop>\n          <div class=\"w-full max-w-2xl mt-20\">\n            <!-- 搜索框 -->\n            <div class=\"bg-white rounded-xl shadow-2xl overflow-hidden\">\n              <div class=\"relative\">\n                <div class=\"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none\">\n                  <MagnifyingGlassIcon class=\"h-5 w-5 text-gray-400\" />\n                </div>\n                <input\n                  ref=\"searchInput\"\n                  type=\"text\"\n                  v-model=\"searchQuery\"\n                  @keyup.enter=\"handleSearch\"\n                  @keyup.esc=\"showSearchModal = false\"\n                  placeholder=\"搜索文章、作品集、用户\"\n                  class=\"block w-full pl-12 pr-4 py-4 text-lg bg-transparent border-0 focus:ring-0 placeholder-gray-500\"\n                  autofocus\n                />\n              </div>\n              \n              <!-- 搜索建议 -->\n              <div v-if=\"searchQuery\" class=\"border-t border-gray-100\">\n                <div class=\"p-4\">\n                  <div class=\"text-xs font-medium text-gray-500 mb-3\">搜索建议</div>\n                  <div class=\"space-y-2\">\n                    <button\n                      v-for=\"(type, index) in searchTypes\"\n                      :key=\"index\"\n                      @click=\"handleSearchByType(type)\"\n                      class=\"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 rounded-lg flex items-center transition-colors\"\n                    >\n                      <component :is=\"type.icon\" class=\"w-5 h-5 mr-3 text-gray-400\" />\n                      在{{ type.label }}中搜索\"{{ searchQuery }}\"\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </header>\n</template>\n<script setup>\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useAuthStore } from '@/stores/auth'\nimport { useAccountStore } from '@/stores/account'\nimport defaultAvatar from '@/assets/images/default-avatar.png'\nimport navigation from '@/config/navigation.json'\nimport { eventBus } from '@/utils/eventBus'\nimport { showToast } from '@/components/ToastMessage'\nimport request from '@/utils/request'\nimport { membership } from '@/api/membership'\n\n// 导入所需的图标\nimport {\n  DocumentTextIcon,\n  DocumentIcon,\n  UserIcon,\n  Cog6ToothIcon,\n  ArrowRightOnRectangleIcon,\n  BellIcon,\n  HeartIcon,\n  ShieldCheckIcon,\n  UserCircleIcon,\n  WrenchScrewdriverIcon,\n  MagnifyingGlassIcon,\n  PhotoIcon,\n  UserGroupIcon,\n  XMarkIcon,\n  Squares2X2Icon,\n  SparklesIcon,\n  StarIcon,\n  ChevronRightIcon\n} from '@heroicons/vue/24/outline'\n\n\n// 添加图标映射函数\nconst getIcon = (menuKey) => {\n  const iconMap = {  \n    'home': Squares2X2Icon,\n    'profile': UserIcon,\n    'resumes': DocumentIcon,\n    'favorites': HeartIcon,\n    'notifications': BellIcon,\n    'settings': Cog6ToothIcon,\n    'security': ShieldCheckIcon,\n    'account': WrenchScrewdriverIcon,\n    'logout': ArrowRightOnRectangleIcon,\n    'crown': SparklesIcon,\n  }\n  return iconMap[menuKey] || UserIcon // 默认返回 UserIcon\n}\n\n// 状态管理\nconst router = useRouter()\nconst route = useRoute()\nconst authStore = useAuthStore()\nconst accountStore = useAccountStore()\nconst mobileMenuOpen = ref(false)\nconst userMenuOpen = ref(false)\nconst showMessageMenu = ref(false)\nconst resourceMenuOpen = ref(false)\nconst mobileSubmenuOpen = ref({})\nconst userBasicInfo = ref(null)\n\n// 模拟消息数据\nconst messages = ref([\n  {\n    id: 1,\n    content: '您的简历被查看了',\n    time: '10分钟前',\n    isRead: false,\n    type: 'system'\n  },\n  {\n    id: 2,\n    content: '有新的职位推荐',\n    time: '1小时前',\n    isRead: true,\n    type: 'system'\n  },\n  {\n    id: 3,\n    content: '张三给你发送了一条私信',\n    time: '2小时前',\n    isRead: false,\n    type: 'private'\n  }\n])\n\n// 切换消息菜单\nconst toggleMessageMenu = () => {\n  showMessageMenu.value = !showMessageMenu.value\n  if (showMessageMenu.value) {\n    userMenuOpen.value = false\n  }\n}\n\n// 查看全部消息\nconst viewAllMessages = () => {\n  showMessageMenu.value = false  // 关闭消息菜单\n  router.push('/user?tab=messages')\n}\n\n// 监听 accountStore 中的用户信息变化\nwatch(\n  [() => accountStore.userInfo, () => authStore.isLoggedIn],\n  (newUserInfo) => {\n    if (newUserInfo && authStore.isLoggedIn) {\n      userBasicInfo.value = {\n        ...newUserInfo\n      }\n    } else {\n      userBasicInfo.value = null\n    }\n  },\n  { immediate: true, deep: true }\n)\n\n// 响应式计算\nconst isMobile = computed(() => {\n  return window.innerWidth < 1024\n})\n\n// 统一的菜单关闭处理\nconst closeMenus = (e) => {\n  if (!e.target.closest('.resource-menu')) {\n    resourceMenuOpen.value = false\n  }\n  if (!e.target.closest('.user-menu')) {\n    userMenuOpen.value = false\n  }\n  if (!e.target.closest('.message-menu') && !e.target.closest('.message-button')) {\n    showMessageMenu.value = false\n  }\n}\n\n// 移动端菜单开关\nconst toggleMenu = () => {\n  mobileMenuOpen.value = !mobileMenuOpen.value\n  if (mobileMenuOpen.value) {\n    userMenuOpen.value = false\n    resourceMenuOpen.value = false\n    mobileSubmenuOpen.value = {}\n  }\n}\n\n// 判断当前路由是否匹配\nconst isCurrentRoute = (href) => {\n  // 对于模板相关的路由，使用 startsWith 判断\n  if (href === '/templates') {\n    return route.path.startsWith('/templates')\n  }\n  // 对于社区相关的路由，使用 startsWith 判断\n  if (href === '/community') {\n    return route.path.startsWith('/community')\n  }\n  // 对于作品集相关的路由，使用 startsWith 判断\n  if (href === '/portfolio') {\n    return route.path.startsWith('/portfolio')\n  }\n  // 其他路由保持完全匹配\n  return route.path === href\n}\n\n// 直接从 store 获取状态\nconst isAuthenticated = computed(() => {\n  // 同时检查登录状态和用户信息\n  return authStore.isLoggedIn && accountStore.userInfo !== null\n})\n\nconst username = computed(() => {\n  if (!isAuthenticated.value) return ''\n  return accountStore.username\n})\n\nconst avatarUrl = computed(() => {\n  if (!isAuthenticated.value) return defaultAvatar\n  const avatar = accountStore.avatar\n  if (!avatar || avatar === 'null' || avatar === 'undefined') {\n    return defaultAvatar\n  }\n  // 检查 avatar 是否是完整的 URL 或 base64 数据\n  if (avatar.startsWith('http') || avatar.startsWith('data:image')) {\n    return avatar\n  }\n  // 如果是相对路径，则拼接基础 URL\n  return avatar.startsWith('/') \n    ? `${process.env.VUE_APP_API_BASE_URL}${avatar}`\n    : `${process.env.VUE_APP_API_BASE_URL}/${avatar}`\n})\n\n// 判断是否在消息页面\nconst isMessageRoute = computed(() => {\n  return route.path.includes('/user') && route.query.tab === 'messages'\n})\n\n// 测试用：模拟未读消息数量\nconst unreadMessagesCount = ref(5)\n\n// 获取未读消息数量\nconst fetchUnreadMessagesCount = async () => {\n  try {\n    // TODO: 调用 API 获取未读消息数量\n    // const response = await api.getUnreadMessagesCount()\n    // unreadMessagesCount.value = response.data.count\n    unreadMessagesCount.value = 5 // 临时测试数据\n  } catch (error) {\n    console.error('获取未读消息数量失败:', error)\n  }\n}\n\n// 在用户登录状态变化时获取未读消息数量\nwatch(() => authStore.isLoggedIn, (newValue) => {\n  if (newValue) {\n    fetchUnreadMessagesCount()\n  } else {\n    unreadMessagesCount.value = 0\n  }\n}, { immediate: true })\n\n// 生命周期钩子\nonMounted(async () => {\n  document.addEventListener('click', closeMenus)\n  window.addEventListener('resize', () => {\n    if (!isMobile.value) {\n      mobileMenuOpen.value = false\n    }\n  })\n  \n  // 检查登录状态\n  const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true'\n  const token = localStorage.getItem('token')\n  \n  if (isLoggedIn && token) {\n    authStore.isLoggedIn = true\n    request.defaults.headers.common['Authorization'] = `Bearer ${token}`\n  }\n  \n  if (authStore.isLoggedIn) {\n    try {\n      await Promise.all([\n        accountStore.fetchUserInfo(),\n        fetchPointsInfo()\n      ])\n      console.log('Fetched User Info:', accountStore.userInfo)\n    } catch (error) {\n      console.error('Failed to fetch user info:', error)\n    }\n  }\n  \n  eventBus.on('avatar-updated', handleAvatarUpdate)\n  \n  // 监听支付成功事件\n  window.addEventListener('payment-success', refreshUserInfo)\n})\n\n// 保持原有的事件清理\nonUnmounted(() => {\n  eventBus.off('avatar-updated', handleAvatarUpdate)\n  // 移除支付成功事件监听\n  window.removeEventListener('payment-success', refreshUserInfo)\n})\n\n// 简化头像更新处理方法\nconst handleAvatarUpdate = (newAvatar) => {\n  if (accountStore.userInfo) {\n    accountStore.userInfo = {\n      ...accountStore.userInfo,\n      avatar: newAvatar\n    }\n  }\n}\n\n// 修改会员状态相关的计算属性\nconst isVip = computed(() => {\n  return accountStore.userInfo?.is_vip || false\n})\n\n// 会员类型文本\nconst vipTypeText = computed(() => {\n  const userInfo = accountStore.userInfo\n  if (!userInfo) return '普通用户'\n  return userInfo.vip_status || '普通用户'\n})\n\n// 剩余天数文本\nconst remainingDays = computed(() => {\n  const userInfo = accountStore.userInfo\n  if (!userInfo?.is_vip || userInfo.vip_type === 'lifetime') return ''\n  \n  if (userInfo.vip_expire_time) {\n    const expireDate = new Date(userInfo.vip_expire_time)\n    const now = new Date()\n    const diffDays = Math.floor((expireDate - now) / (1000 * 60 * 60 * 24))\n    if (diffDays > 0) {\n      return `剩余 ${diffDays} 天`\n    }\n  }\n  return ''\n})\n\n// 会员按钮文本\nconst vipButtonText = computed(() => {\n  const userInfo = accountStore.userInfo\n  if (!userInfo?.is_vip) return '升级会员'\n  \n  if (userInfo.vip_type === 'lifetime') return '会员中心'\n  \n  if (userInfo.vip_expire_time) {\n    const expireDate = new Date(userInfo.vip_expire_time)\n    const now = new Date()\n    const diffDays = Math.ceil((expireDate - now) / (1000 * 60 * 60 * 24))\n    return diffDays <= 30 ? '续费会员' : '会员中心'\n  }\n  \n  return '会员中心'\n})\n\n// 会员状态相关的计算属性\nconst isExpiringSoon = computed(() => {\n  const userInfo = accountStore.userInfo\n  if (!userInfo?.is_vip || userInfo.vip_type === 'lifetime') return false\n  \n  if (userInfo.vip_expire_time) {\n    const expireDate = new Date(userInfo.vip_expire_time)\n    const now = new Date()\n    const diffDays = Math.ceil((expireDate - now) / (1000 * 60 * 60 * 24))\n    return diffDays <= 30\n  }\n  return false\n})\n\n// 处理会员按钮点击\nconst handleVipButton = () => {\n  const userInfo = accountStore.userInfo\n  if (!userInfo?.is_vip) {\n    router.push('/pro')\n  } else if (isExpiringSoon.value) {\n    router.push('/pro/renew')\n  } else {\n    router.push('/user?tab=membership')\n  }\n  showDropdown.value = false\n  userMenuOpen.value = false\n}\n\n// 用户菜单选项\nconst userMenuItems = computed(() => {\n  return [\n    {\n      key: 'home',\n      label: '用户中心',\n      icon: 'home',\n      action: () => {\n        router.push('/user?tab=home')\n        showDropdown.value = false\n        userMenuOpen.value = false\n      }\n    },\n    {\n      key: 'profile',\n      label: '我的档案',\n      icon: 'profile',\n      action: () => {\n        router.push('/user?tab=profile')\n        showDropdown.value = false\n        userMenuOpen.value = false\n      }\n    },\n    {\n      key: 'resumes',\n      label: '我的简历',\n      icon: 'resumes',\n      action: () => {\n        router.push('/user?tab=resumes')\n        showDropdown.value = false\n        userMenuOpen.value = false\n      }\n    },\n    {\n      key: 'settings',\n      label: '账号设置',\n      icon: 'settings',\n      action: () => {\n        router.push('/user?tab=settings')\n        showDropdown.value = false\n        userMenuOpen.value = false\n      }\n    },\n    {\n      key: 'membership',\n      label: '会员中心',\n      icon: 'crown',\n      action: () => {\n        router.push('/user?tab=membership')\n        showDropdown.value = false\n        userMenuOpen.value = false\n      }\n    },\n    {\n      key: 'logout',\n      label: '退出登录',\n      icon: 'logout',\n      action: handleLogout\n    }\n  ]\n})\n\n// 处理退出登录\nconst handleLogout = async () => {\n  try {\n    userMenuOpen.value = false\n    await authStore.logout()\n    // 清除其他状态\n    userBasicInfo.value = null\n    unreadMessagesCount.value = 0\n    messages.value = []\n    mobileMenuOpen.value = false\n    showMessageMenu.value = false\n    resourceMenuOpen.value = false\n    mobileSubmenuOpen.value = {}\n    \n    showToast('退出成功', 'success')\n    \n    const currentPath = router.currentRoute.value.fullPath\n    router.push(`/login?redirect=${encodeURIComponent(currentPath)}`)\n  } catch (error) {\n    console.error('退出失败:', error)\n    showToast('退出失败，请重试', 'error')\n  }\n}\n\n// 搜索相关状态\nconst searchQuery = ref('')\nconst showSearchModal = ref(false)\nconst searchInput = ref(null)\n\n// 监听 ESC 键关闭搜索弹窗\nonMounted(() => {\n  document.addEventListener('keydown', (e) => {\n    if (e.key === 'Escape') {\n      showSearchModal.value = false\n    }\n  })\n})\n\n// 修改搜索处理函数\nconst handleSearch = () => {\n  if (!searchQuery.value.trim()) return\n  router.push({\n    path: '/search',\n    query: { q: searchQuery.value }\n  })\n  showSearchModal.value = false\n}\n\nconst handleSearchByType = (type) => {\n  if (!searchQuery.value.trim()) return\n  router.push({\n    path: type.path,\n    query: { q: searchQuery.value }\n  })\n  showSearchModal.value = false\n}\n\n// 搜索类型配置\nconst searchTypes = [\n  { \n    label: '文章', \n    type: 'articles',\n    icon: DocumentTextIcon,\n    path: '/search/articles'\n  },\n  { \n    label: '作品集', \n    type: 'portfolio',\n    icon: PhotoIcon,\n    path: '/search/portfolio'\n  },\n  { \n    label: '用户', \n    type: 'users',\n    icon: UserGroupIcon,\n    path: '/search/users'\n  }\n]\n\n// 监听点击事件，关闭搜索建议\nonMounted(() => {\n  document.addEventListener('click', (e) => {\n    if (!e.target.closest('.search-container')) {\n      showSearchModal.value = false\n    }\n  })\n})\n\nconst refreshUserInfo = async () => {\n  try {\n    await accountStore.fetchUserInfo()\n    console.log('Refreshed User Info:', accountStore.userInfo)\n  } catch (error) {\n    console.error('Failed to refresh user info:', error)\n  }\n}\n\n// 积分信息\nconst pointsInfo = ref({\n  balance: 0,\n  level: 1,\n  sign_in_days: 0,\n  total_earned: 0\n})\n\n// 获取积分信息\nconst fetchPointsInfo = async () => {\n  try {\n    const response = await membership.getPointsInfo()\n    if (response?.data?.code === 200) {\n      pointsInfo.value = response.data.data\n    }\n  } catch (error) {\n    console.error('获取积分信息失败:', error)\n  }\n}\n\nconst showDropdown = ref(false)\nconst dropdownRef = ref(null)\n\n// 切换下拉菜单\nconst toggleDropdown = () => {\n  showDropdown.value = !showDropdown.value\n}\n\n// 处理点击事件\nconst handleClickOutside = (event) => {\n  if (dropdownRef.value && !dropdownRef.value.contains(event.target)) {\n    showDropdown.value = false\n  }\n}\n\nonMounted(() => {\n  // 添加全局点击事件监听\n  document.addEventListener('click', handleClickOutside)\n})\n\nonUnmounted(() => {\n  // 移除全局点击事件监听\n  document.removeEventListener('click', handleClickOutside)\n})\n\n// 在组件挂载时获取数据\nonMounted(async () => {\n  await fetchPointsInfo()\n})\n\n</script>\n<style scoped>\n/* 添加过渡动画 */\n.aspect-h-9 {\n  position: relative;\n  padding-bottom: 56.25%;\n}\n\n.aspect-h-9 img {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  transition: opacity 0.3s ease;\n}\n\n/* 添加菜单hover效果 */\n.hover\\:bg-gray-100:hover {\n  background-color: rgba(243, 244, 246, 1);\n}\n\n/* 确保下拉菜单定位正确 */\n.resource-menu {\n  position: static;\n}\n\n@media (min-width: 1024px) {\n  .resource-menu {\n    position: relative;\n  }\n}\n\n/* 添加过渡动画 */\n.transition-transform {\n  transition-property: transform;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 200ms;\n}\n\n/* 移动端菜单动画 */\n.mobile-menu-enter-active,\n.mobile-menu-leave-active {\n  transition: transform 0.3s ease-in-out;\n}\n\n.mobile-menu-enter-from,\n.mobile-menu-leave-to {\n  transform: translateX(100%);\n}\n\n/* 下拉菜单动画 */\n.dropdown-enter-active,\n.dropdown-leave-active {\n  transition: opacity 0.2s, transform 0.2s;\n}\n\n.dropdown-enter-from,\n.dropdown-leave-to {\n  opacity: 0;\n  transform: translateY(-10px);\n}\n/* 确保下拉菜单始终最上层 */\n:deep(.el-dropdown-menu) {\n  z-index: 3000 !important;\n}\n\n/* 调整资源菜单定位 */\n.resource-menu {\n  position: static;\n}\n\n@media (min-width: 1024px) {\n  .resource-menu {\n    position: relative;\n  }\n}\n\n/* 消息图标动画 */\n@keyframes pulse {\n  0% { transform: scale(1); }\n  50% { transform: scale(1.1); }\n  100% { transform: scale(1); }\n}\n\n.animate-pulse {\n  animation: pulse 2s infinite;\n}\n\n/* 消息数量的动画效果 */\n@keyframes scaleIn {\n  from {\n    transform: scale(0);\n  }\n  to {\n    transform: scale(1);\n  }\n}\n\n.absolute {\n  animation: scaleIn 0.2s ease-out;\n}\n\n/* 添加积分数字动画 */\n@keyframes countUp {\n  from {\n    transform: translateY(10px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n.text-amber-500 {\n  animation: countUp 0.3s ease-out;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}