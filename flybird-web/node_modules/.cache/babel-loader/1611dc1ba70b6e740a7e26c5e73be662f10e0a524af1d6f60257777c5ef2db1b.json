{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport { ref, computed, watch } from 'vue';\nimport { useComponents } from '../composables/useComponents';\nexport default {\n  __name: 'DoubleLayout',\n  props: {\n    config: {\n      type: Object,\n      required: true\n    }\n  },\n  emits: ['update:config'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const leftComponents = ref(props.config.leftComponents || []);\n    const rightComponents = ref(props.config.rightComponents || []);\n    const isDragOverLeft = ref(false);\n    const isDragOverRight = ref(false);\n    const {\n      getComponentByType\n    } = useComponents();\n\n    // 计算布局样式\n    const layoutStyles = computed(() => _objectSpread({\n      backgroundColor: props.config.styles?.backgroundColor || '#f5f7fa',\n      borderColor: props.config.styles?.borderColor || '#e4e7ed',\n      padding: props.config.styles?.padding || '16px',\n      borderRadius: props.config.styles?.borderRadius || '8px'\n    }, props.config.styles));\n\n    // 监听配置变化\n    watch(() => props.config, newConfig => {\n      leftComponents.value = newConfig.leftComponents || [];\n      rightComponents.value = newConfig.rightComponents || [];\n    }, {\n      deep: true\n    });\n\n    // 处理拖拽进入\n    const handleDragEnter = (event, column) => {\n      event.preventDefault();\n      if (column === 'left') {\n        isDragOverLeft.value = true;\n      } else {\n        isDragOverRight.value = true;\n      }\n    };\n\n    // 处理拖拽离开\n    const handleDragLeave = (event, column) => {\n      event.preventDefault();\n      if (column === 'left') {\n        isDragOverLeft.value = false;\n      } else {\n        isDragOverRight.value = false;\n      }\n    };\n\n    // 处理拖拽悬停\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n\n    // 处理组件放置\n    const handleDrop = (event, column) => {\n      event.preventDefault();\n      if (column === 'left') {\n        isDragOverLeft.value = false;\n      } else {\n        isDragOverRight.value = false;\n      }\n      const componentData = event.dataTransfer.getData('application/json');\n      if (componentData) {\n        try {\n          const component = JSON.parse(componentData);\n          if (component.type !== 'layout') {\n            addComponent(component, column);\n          }\n        } catch (error) {\n          console.error('解析组件数据失败:', error);\n        }\n      }\n    };\n\n    // 添加组件\n    const addComponent = (component, column) => {\n      const newComponent = {\n        id: Date.now(),\n        type: component.type,\n        name: component.name,\n        config: component.config || {}\n      };\n      if (column === 'left') {\n        leftComponents.value.push(newComponent);\n      } else {\n        rightComponents.value.push(newComponent);\n      }\n      updateConfig();\n    };\n\n    // 移除组件\n    const removeComponent = (component, column) => {\n      const components = column === 'left' ? leftComponents : rightComponents;\n      const index = components.value.findIndex(c => c.id === component.id);\n      if (index > -1) {\n        components.value.splice(index, 1);\n        updateConfig();\n      }\n    };\n\n    // 更新组件配置\n    const updateComponentConfig = (componentId, config, column) => {\n      const components = column === 'left' ? leftComponents : rightComponents;\n      const component = components.value.find(c => c.id === componentId);\n      if (component) {\n        component.config = config;\n        updateConfig();\n      }\n    };\n\n    // 更新配置\n    const updateConfig = () => {\n      emit('update:config', _objectSpread(_objectSpread({}, props.config), {}, {\n        leftComponents: leftComponents.value,\n        rightComponents: rightComponents.value\n      }));\n    };\n    const __returned__ = {\n      props,\n      emit,\n      leftComponents,\n      rightComponents,\n      isDragOverLeft,\n      isDragOverRight,\n      getComponentByType,\n      layoutStyles,\n      handleDragEnter,\n      handleDragLeave,\n      handleDragOver,\n      handleDrop,\n      addComponent,\n      removeComponent,\n      updateComponentConfig,\n      updateConfig,\n      ref,\n      computed,\n      watch,\n      get useComponents() {\n        return useComponents;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","watch","useComponents","props","__props","emit","__emit","leftComponents","config","rightComponents","isDragOverLeft","isDragOverRight","getComponentByType","layoutStyles","_objectSpread","backgroundColor","styles","borderColor","padding","borderRadius","newConfig","value","deep","handleDragEnter","event","column","preventDefault","handleDragLeave","handleDragOver","handleDrop","componentData","dataTransfer","getData","component","JSON","parse","type","addComponent","error","console","newComponent","id","Date","now","name","push","updateConfig","removeComponent","components","index","findIndex","c","splice","updateComponentConfig","componentId","find"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/layouts/DoubleLayout.vue"],"sourcesContent":["<template>\n  <div class=\"double-layout\">\n    <div class=\"layout-columns\" :style=\"layoutStyles\">\n      <!-- 左列 -->\n      <div class=\"layout-column\"\n        :class=\"{ 'drag-over': isDragOverLeft }\"\n        @dragenter=\"handleDragEnter($event, 'left')\"\n        @dragleave=\"handleDragLeave($event, 'left')\"\n        @dragover=\"handleDragOver\"\n        @drop=\"e => handleDrop(e, 'left')\">\n        <div v-if=\"!leftComponents.length\" class=\"column-placeholder\">\n          <v-icon size=\"32\" color=\"rgba(0,0,0,0.2)\">mdi-plus</v-icon>\n          <div class=\"text-body-2 text-medium-emphasis mt-2\">拖拽组件到此处</div>\n        </div>\n        <template v-else>\n          <div v-for=\"component in leftComponents\" \n            :key=\"component.id\"\n            class=\"component-item\">\n            <div class=\"component-header\">\n              <span class=\"component-name\">{{ component.name }}</span>\n              <div class=\"component-actions\">\n                <v-btn\n                  icon=\"mdi-delete\"\n                  size=\"small\"\n                  color=\"error\"\n                  variant=\"text\"\n                  @click=\"removeComponent(component, 'left')\"\n                ></v-btn>\n              </div>\n            </div>\n            <component\n              :is=\"getComponentByType(component.type)\"\n              :config=\"component.config\"\n              @update:config=\"config => updateComponentConfig(component.id, config, 'left')\"\n            ></component>\n          </div>\n        </template>\n      </div>\n\n      <!-- 右列 -->\n      <div class=\"layout-column\"\n        :class=\"{ 'drag-over': isDragOverRight }\"\n        @dragenter=\"handleDragEnter($event, 'right')\"\n        @dragleave=\"handleDragLeave($event, 'right')\"\n        @dragover=\"handleDragOver\"\n        @drop=\"e => handleDrop(e, 'right')\">\n        <div v-if=\"!rightComponents.length\" class=\"column-placeholder\">\n          <v-icon size=\"32\" color=\"rgba(0,0,0,0.2)\">mdi-plus</v-icon>\n          <div class=\"text-body-2 text-medium-emphasis mt-2\">拖拽组件到此处</div>\n        </div>\n        <template v-else>\n          <div v-for=\"component in rightComponents\" \n            :key=\"component.id\"\n            class=\"component-item\">\n            <div class=\"component-header\">\n              <span class=\"component-name\">{{ component.name }}</span>\n              <div class=\"component-actions\">\n                <v-btn\n                  icon=\"mdi-delete\"\n                  size=\"small\"\n                  color=\"error\"\n                  variant=\"text\"\n                  @click=\"removeComponent(component, 'right')\"\n                ></v-btn>\n              </div>\n            </div>\n            <component\n              :is=\"getComponentByType(component.type)\"\n              :config=\"component.config\"\n              @update:config=\"config => updateComponentConfig(component.id, config, 'right')\"\n            ></component>\n          </div>\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { useComponents } from '../composables/useComponents'\n\nconst props = defineProps({\n  config: {\n    type: Object,\n    required: true\n  }\n})\n\nconst emit = defineEmits(['update:config'])\n\nconst leftComponents = ref(props.config.leftComponents || [])\nconst rightComponents = ref(props.config.rightComponents || [])\nconst isDragOverLeft = ref(false)\nconst isDragOverRight = ref(false)\n\nconst { getComponentByType } = useComponents()\n\n// 计算布局样式\nconst layoutStyles = computed(() => ({\n  backgroundColor: props.config.styles?.backgroundColor || '#f5f7fa',\n  borderColor: props.config.styles?.borderColor || '#e4e7ed',\n  padding: props.config.styles?.padding || '16px',\n  borderRadius: props.config.styles?.borderRadius || '8px',\n  ...props.config.styles\n}))\n\n// 监听配置变化\nwatch(() => props.config, (newConfig) => {\n  leftComponents.value = newConfig.leftComponents || []\n  rightComponents.value = newConfig.rightComponents || []\n}, { deep: true })\n\n// 处理拖拽进入\nconst handleDragEnter = (event, column) => {\n  event.preventDefault()\n  if (column === 'left') {\n    isDragOverLeft.value = true\n  } else {\n    isDragOverRight.value = true\n  }\n}\n\n// 处理拖拽离开\nconst handleDragLeave = (event, column) => {\n  event.preventDefault()\n  if (column === 'left') {\n    isDragOverLeft.value = false\n  } else {\n    isDragOverRight.value = false\n  }\n}\n\n// 处理拖拽悬停\nconst handleDragOver = (event) => {\n  event.preventDefault()\n}\n\n// 处理组件放置\nconst handleDrop = (event, column) => {\n  event.preventDefault()\n  if (column === 'left') {\n    isDragOverLeft.value = false\n  } else {\n    isDragOverRight.value = false\n  }\n  \n  const componentData = event.dataTransfer.getData('application/json')\n  if (componentData) {\n    try {\n      const component = JSON.parse(componentData)\n      if (component.type !== 'layout') {\n        addComponent(component, column)\n      }\n    } catch (error) {\n      console.error('解析组件数据失败:', error)\n    }\n  }\n}\n\n// 添加组件\nconst addComponent = (component, column) => {\n  const newComponent = {\n    id: Date.now(),\n    type: component.type,\n    name: component.name,\n    config: component.config || {}\n  }\n  if (column === 'left') {\n    leftComponents.value.push(newComponent)\n  } else {\n    rightComponents.value.push(newComponent)\n  }\n  updateConfig()\n}\n\n// 移除组件\nconst removeComponent = (component, column) => {\n  const components = column === 'left' ? leftComponents : rightComponents\n  const index = components.value.findIndex(c => c.id === component.id)\n  if (index > -1) {\n    components.value.splice(index, 1)\n    updateConfig()\n  }\n}\n\n// 更新组件配置\nconst updateComponentConfig = (componentId, config, column) => {\n  const components = column === 'left' ? leftComponents : rightComponents\n  const component = components.value.find(c => c.id === componentId)\n  if (component) {\n    component.config = config\n    updateConfig()\n  }\n}\n\n// 更新配置\nconst updateConfig = () => {\n  emit('update:config', {\n    ...props.config,\n    leftComponents: leftComponents.value,\n    rightComponents: rightComponents.value\n  })\n}\n</script>\n\n<style scoped>\n.double-layout {\n  position: absolute;\n  inset: 0;\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n}\n\n.layout-columns {\n  display: flex;\n  gap: 20px;\n  height: 100%;\n  border: 2px dashed;\n  transition: all 0.3s;\n}\n\n.layout-column {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  padding: 16px;\n  transition: all 0.3s;\n}\n\n.layout-column.drag-over {\n  background-color: #ecf5ff !important;\n  border-color: #409eff !important;\n}\n\n.column-placeholder {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 120px;\n  background-color: #ffffff;\n  border-radius: 6px;\n  color: rgba(0, 0, 0, 0.4);\n  transition: all 0.3s;\n}\n\n.component-item {\n  background-color: #ffffff;\n  border: 1px solid #e4e7ed;\n  border-radius: 6px;\n  overflow: hidden;\n  transition: all 0.3s;\n}\n\n.component-item:hover {\n  border-color: #409eff;\n  box-shadow: 0 2px 12px rgba(64, 158, 255, 0.1);\n}\n\n.component-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background-color: #f5f7fa;\n  border-bottom: 1px solid #e4e7ed;\n}\n\n.component-name {\n  font-size: 14px;\n  color: #606266;\n}\n\n.component-actions {\n  display: flex;\n  gap: 4px;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}