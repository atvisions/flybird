{"ast":null,"code":"import _objectSpread from \"/Users/liuzhao/Documents/Projects/flybird/flybird-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { ref, computed } from 'vue';\nimport ToolbarPanel from './components/ToolbarPanel.vue';\nimport Canvas from './components/Canvas.vue';\nimport PropertyPanel from './components/PropertyPanel.vue';\nimport SaveTemplateDialog from './components/SaveTemplateDialog.vue';\nimport { useTemplateStore } from '@/stores/template';\nexport default {\n  __name: 'index',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const canvas = ref(null);\n    const toolbarRef = ref(null);\n    const selectedElement = ref(null);\n    const dataFields = ref([]);\n    const showSaveDialog = ref(false);\n    const scale = ref(1);\n\n    // 计算缩放百分比\n    const scalePercentage = computed({\n      get: () => scale.value * 100,\n      set: value => {\n        scale.value = value / 100;\n      }\n    });\n\n    // 增加缩放\n    const increaseScale = () => {\n      if (scale.value < 2) {\n        scale.value = Math.min(2, scale.value + 0.1);\n      }\n    };\n\n    // 减少缩放\n    const decreaseScale = () => {\n      if (scale.value > 0.25) {\n        scale.value = Math.max(0.25, scale.value - 0.1);\n      }\n    };\n    const snackbar = ref({\n      show: false,\n      text: '',\n      color: 'success'\n    });\n    const templateStore = useTemplateStore();\n\n    // 显示消息\n    const showMessage = (text, color = 'success') => {\n      snackbar.value = {\n        show: true,\n        text,\n        color\n      };\n    };\n\n    // 处理元素选择\n    const handleElementSelect = element => {\n      selectedElement.value = element;\n    };\n\n    // 处理数据字段更新\n    const handleDataFieldsUpdate = fields => {\n      dataFields.value = fields;\n    };\n\n    // 处理元素更新\n    const handleElementUpdate = update => {\n      if (canvas.value) {\n        canvas.value.handleElementUpdate(update);\n      }\n    };\n\n    // 预览模板\n    const previewTemplate = () => {\n      // TODO: 实现预览功能\n      showMessage('预览功能开发中');\n    };\n\n    // 处理保存模板\n    const handleSaveTemplate = async formData => {\n      try {\n        const canvasData = canvas.value.getCanvasData();\n        const templateData = _objectSpread(_objectSpread({}, formData), {}, {\n          content: {\n            elements: canvasData.elements\n          }\n        });\n        await templateStore.saveTemplate(templateData);\n        showMessage('保存成功', 'success');\n        showSaveDialog.value = false;\n        // 刷新模板列表\n        toolbarRef.value.refreshTemplates();\n      } catch (error) {\n        showMessage(error.message || '保存失败', 'error');\n      }\n    };\n\n    // 处理模板选择\n    const handleTemplateSelect = async template => {\n      try {\n        // 获取模板详情\n        const templateData = await templateStore.getTemplateDetail(template.id);\n        console.log('模板详情:', templateData);\n\n        // 加载模板内容到画布\n        if (canvas.value && templateData.content) {\n          await canvas.value.loadTemplate(templateData.content);\n          showMessage('模板加载成功', 'success');\n        } else {\n          throw new Error('模板内容为空');\n        }\n      } catch (error) {\n        console.error('加载模板失败:', error);\n        showMessage(error.message || '加载模板失败', 'error');\n      }\n    };\n    const __returned__ = {\n      canvas,\n      toolbarRef,\n      selectedElement,\n      dataFields,\n      showSaveDialog,\n      scale,\n      scalePercentage,\n      increaseScale,\n      decreaseScale,\n      snackbar,\n      templateStore,\n      showMessage,\n      handleElementSelect,\n      handleDataFieldsUpdate,\n      handleElementUpdate,\n      previewTemplate,\n      handleSaveTemplate,\n      handleTemplateSelect,\n      ref,\n      computed,\n      ToolbarPanel,\n      Canvas,\n      PropertyPanel,\n      SaveTemplateDialog,\n      get useTemplateStore() {\n        return useTemplateStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","ToolbarPanel","Canvas","PropertyPanel","SaveTemplateDialog","useTemplateStore","canvas","toolbarRef","selectedElement","dataFields","showSaveDialog","scale","scalePercentage","get","value","set","increaseScale","Math","min","decreaseScale","max","snackbar","show","text","color","templateStore","showMessage","handleElementSelect","element","handleDataFieldsUpdate","fields","handleElementUpdate","update","previewTemplate","handleSaveTemplate","formData","canvasData","getCanvasData","templateData","_objectSpread","content","elements","saveTemplate","refreshTemplates","error","message","handleTemplateSelect","template","getTemplateDetail","id","console","log","loadTemplate","Error"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/views/resume-editor/index.vue"],"sourcesContent":["<template>\n  <div class=\"resume-editor\">\n    <!-- 顶部工具栏 -->\n    <div class=\"editor-toolbar\">\n      <v-btn\n        color=\"primary\"\n        prepend-icon=\"mdi-content-save\"\n        @click=\"showSaveDialog = true\"\n      >\n        保存模板\n      </v-btn>\n      \n      <v-btn\n        color=\"info\"\n        prepend-icon=\"mdi-eye\"\n        class=\"ml-2\"\n        @click=\"previewTemplate\"\n      >\n        预览\n      </v-btn>\n    </div>\n\n    <div class=\"editor-content\">\n      <!-- 左侧工具面板 -->\n      <ToolbarPanel\n        ref=\"toolbarRef\"\n        @element-dragstart=\"handleElementDragStart\"\n        @template-select=\"handleTemplateSelect\"\n      />\n\n      <!-- 中间画布区域 -->\n      <Canvas\n        ref=\"canvas\"\n        :scale=\"scale\"\n        @element-select=\"handleElementSelect\"\n        @data-fields-update=\"handleDataFieldsUpdate\"\n      />\n\n      <!-- 右侧属性面板 -->\n      <PropertyPanel\n        :selected-element=\"selectedElement\"\n        :data-fields=\"dataFields\"\n        @update=\"handleElementUpdate\"\n      />\n    </div>\n\n    <!-- 底部工具栏 -->\n    <div class=\"editor-footer\">\n      <div class=\"zoom-controls\">\n        <v-btn\n          icon=\"mdi-minus\"\n          variant=\"text\"\n          density=\"comfortable\"\n          @click=\"decreaseScale\"\n          :disabled=\"scale <= 0.25\"\n        ></v-btn>\n        <div class=\"zoom-slider\">\n          <v-slider\n            v-model=\"scalePercentage\"\n            :min=\"25\"\n            :max=\"200\"\n            :step=\"5\"\n            hide-details\n            density=\"compact\"\n            color=\"primary\"\n            track-color=\"grey-lighten-2\"\n          >\n            <template v-slot:append>\n              <div class=\"zoom-text\">{{ Math.round(scalePercentage) }}%</div>\n            </template>\n          </v-slider>\n        </div>\n        <v-btn\n          icon=\"mdi-plus\"\n          variant=\"text\"\n          density=\"comfortable\"\n          @click=\"increaseScale\"\n          :disabled=\"scale >= 2\"\n        ></v-btn>\n      </div>\n    </div>\n\n    <!-- 保存模板对话框 -->\n    <SaveTemplateDialog\n      v-model=\"showSaveDialog\"\n      @save=\"handleSaveTemplate\"\n    />\n\n    <!-- 消息提示 -->\n    <v-snackbar\n      v-model=\"snackbar.show\"\n      :color=\"snackbar.color\"\n      :timeout=\"3000\"\n    >\n      {{ snackbar.text }}\n    </v-snackbar>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport ToolbarPanel from './components/ToolbarPanel.vue'\nimport Canvas from './components/Canvas.vue'\nimport PropertyPanel from './components/PropertyPanel.vue'\nimport SaveTemplateDialog from './components/SaveTemplateDialog.vue'\nimport { useTemplateStore } from '@/stores/template'\n\nconst canvas = ref(null)\nconst toolbarRef = ref(null)\nconst selectedElement = ref(null)\nconst dataFields = ref([])\nconst showSaveDialog = ref(false)\nconst scale = ref(1)\n\n// 计算缩放百分比\nconst scalePercentage = computed({\n  get: () => scale.value * 100,\n  set: (value) => {\n    scale.value = value / 100\n  }\n})\n\n// 增加缩放\nconst increaseScale = () => {\n  if (scale.value < 2) {\n    scale.value = Math.min(2, scale.value + 0.1)\n  }\n}\n\n// 减少缩放\nconst decreaseScale = () => {\n  if (scale.value > 0.25) {\n    scale.value = Math.max(0.25, scale.value - 0.1)\n  }\n}\n\nconst snackbar = ref({\n  show: false,\n  text: '',\n  color: 'success'\n})\n\nconst templateStore = useTemplateStore()\n\n// 显示消息\nconst showMessage = (text, color = 'success') => {\n  snackbar.value = {\n    show: true,\n    text,\n    color\n  }\n}\n\n// 处理元素选择\nconst handleElementSelect = (element) => {\n  selectedElement.value = element\n}\n\n// 处理数据字段更新\nconst handleDataFieldsUpdate = (fields) => {\n  dataFields.value = fields\n}\n\n// 处理元素更新\nconst handleElementUpdate = (update) => {\n  if (canvas.value) {\n    canvas.value.handleElementUpdate(update)\n  }\n}\n\n// 预览模板\nconst previewTemplate = () => {\n  // TODO: 实现预览功能\n  showMessage('预览功能开发中')\n}\n\n// 处理保存模板\nconst handleSaveTemplate = async (formData) => {\n  try {\n    const canvasData = canvas.value.getCanvasData()\n    const templateData = {\n      ...formData,\n      content: {\n        elements: canvasData.elements\n      }\n    }\n    await templateStore.saveTemplate(templateData)\n    showMessage('保存成功', 'success')\n    showSaveDialog.value = false\n    // 刷新模板列表\n    toolbarRef.value.refreshTemplates()\n  } catch (error) {\n    showMessage(error.message || '保存失败', 'error')\n  }\n}\n\n// 处理模板选择\nconst handleTemplateSelect = async (template) => {\n  try {\n    // 获取模板详情\n    const templateData = await templateStore.getTemplateDetail(template.id)\n    console.log('模板详情:', templateData)\n    \n    // 加载模板内容到画布\n    if (canvas.value && templateData.content) {\n      await canvas.value.loadTemplate(templateData.content)\n      showMessage('模板加载成功', 'success')\n    } else {\n      throw new Error('模板内容为空')\n    }\n  } catch (error) {\n    console.error('加载模板失败:', error)\n    showMessage(error.message || '加载模板失败', 'error')\n  }\n}\n</script>\n\n<style scoped>\n.resume-editor {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  background-color: #f5f5f5;\n}\n\n.editor-toolbar {\n  height: 64px;\n  padding: 0 20px;\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.editor-content {\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n}\n\n.editor-footer {\n  height: 48px;\n  padding: 0 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #fff;\n  border-top: 1px solid #e0e0e0;\n}\n\n.zoom-controls {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 4px;\n  border-radius: 4px;\n}\n\n.zoom-slider {\n  width: 200px;\n  margin: 0 8px;\n}\n\n.zoom-text {\n  min-width: 48px;\n  text-align: center;\n  font-size: 14px;\n  color: #606266;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}