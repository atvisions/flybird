{"ast":null,"code":"import { ref, computed, onMounted, defineAsyncComponent } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useAuthStore } from '@/stores/auth';\nimport { API_URL, BASE_API_URL } from '@/config';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const authStore = useAuthStore();\n\n    // 不需要登录的路由\n    const publicRoutes = ['/login', '/register', '/reset-password'];\n\n    // Toast 相关状态\n    const toastMessage = ref('');\n    const toastType = ref('info');\n    const toastDuration = ref(3000);\n\n    // 处理 Toast 销毁\n    const handleToastDestroy = () => {\n      toastMessage.value = '';\n      toastType.value = 'info';\n    };\n    onMounted(() => {\n      // 检查认证状态\n      if (!authStore.isAuthenticated) {\n        const currentPath = router.currentRoute.value.path;\n        // 只有非公开路由才需要重定向到登录页\n        if (!publicRoutes.includes(currentPath)) {\n          // 保存当前路径用于登录后重定向\n          const redirect = encodeURIComponent(currentPath);\n          router.push(`/login?redirect=${redirect}`);\n        }\n      }\n    });\n\n    // 异步导入组件\n    const ToastMessage = defineAsyncComponent(() => import('@/components/ToastMessage.vue'));\n    const __returned__ = {\n      router,\n      authStore,\n      publicRoutes,\n      toastMessage,\n      toastType,\n      toastDuration,\n      handleToastDestroy,\n      ToastMessage,\n      ref,\n      computed,\n      onMounted,\n      defineAsyncComponent,\n      get useRouter() {\n        return useRouter;\n      },\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get API_URL() {\n        return API_URL;\n      },\n      get BASE_API_URL() {\n        return BASE_API_URL;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","defineAsyncComponent","useRouter","useAuthStore","API_URL","BASE_API_URL","router","authStore","publicRoutes","toastMessage","toastType","toastDuration","handleToastDestroy","value","isAuthenticated","currentPath","currentRoute","path","includes","redirect","encodeURIComponent","push","ToastMessage"],"sources":["/Users/liuzhao/Documents/Projects/flybird/flybird-web/src/App.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50\">\n\n    \n    <!-- 主要内容区域 -->\n    <main>\n      <router-view></router-view>\n    </main>\n    \n    \n    <!-- Toast 消息组件 -->\n    <ToastMessage \n      v-if=\"toastMessage\"\n      :message=\"toastMessage\"\n      :type=\"toastType\"\n      :duration=\"toastDuration\"\n      @destroy=\"handleToastDestroy\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, defineAsyncComponent } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useAuthStore } from '@/stores/auth'\nimport { API_URL, BASE_API_URL } from '@/config'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\n\n// 不需要登录的路由\nconst publicRoutes = ['/login', '/register', '/reset-password']\n\n// Toast 相关状态\nconst toastMessage = ref('')\nconst toastType = ref('info')\nconst toastDuration = ref(3000)\n\n// 处理 Toast 销毁\nconst handleToastDestroy = () => {\n  toastMessage.value = ''\n  toastType.value = 'info'\n}\n\nonMounted(() => {\n  // 检查认证状态\n  if (!authStore.isAuthenticated) {\n    const currentPath = router.currentRoute.value.path\n    // 只有非公开路由才需要重定向到登录页\n    if (!publicRoutes.includes(currentPath)) {\n      // 保存当前路径用于登录后重定向\n      const redirect = encodeURIComponent(currentPath)\n      router.push(`/login?redirect=${redirect}`)\n    }\n  }\n})\n\n// 异步导入组件\nconst ToastMessage = defineAsyncComponent(() => import('@/components/ToastMessage.vue'))\n</script>\n\n<style>\n.app-wrapper {\n  position: relative;\n  min-height: 100vh;\n}\n\n.bg-image {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 0;\n  pointer-events: none;\n}\n\n/* 可选：添加一个半透明遮罩让内容更易读 */\n.bg-image::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n}\n\n/* 确保内容在背景之上 */\n.app-wrapper > *:not(.bg-image) {\n  position: relative;\n  z-index: 1;\n}\n</style>"],"mappings":"AAsBA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,oBAAoB,QAAQ,KAAI;AACnE,SAASC,SAAS,QAAQ,YAAW;AACrC,SAASC,YAAY,QAAQ,eAAc;AAC3C,SAASC,OAAO,EAAEC,YAAY,QAAQ,UAAS;;;;;;;IAE/C,MAAMC,MAAM,GAAGJ,SAAS,CAAC;IACzB,MAAMK,SAAS,GAAGJ,YAAY,CAAC;;IAE/B;IACA,MAAMK,YAAY,GAAG,CAAC,QAAQ,EAAE,WAAW,EAAE,iBAAiB;;IAE9D;IACA,MAAMC,YAAY,GAAGX,GAAG,CAAC,EAAE;IAC3B,MAAMY,SAAS,GAAGZ,GAAG,CAAC,MAAM;IAC5B,MAAMa,aAAa,GAAGb,GAAG,CAAC,IAAI;;IAE9B;IACA,MAAMc,kBAAkB,GAAGA,CAAA,KAAM;MAC/BH,YAAY,CAACI,KAAK,GAAG,EAAC;MACtBH,SAAS,CAACG,KAAK,GAAG,MAAK;IACzB;IAEAb,SAAS,CAAC,MAAM;MACd;MACA,IAAI,CAACO,SAAS,CAACO,eAAe,EAAE;QAC9B,MAAMC,WAAW,GAAGT,MAAM,CAACU,YAAY,CAACH,KAAK,CAACI,IAAG;QACjD;QACA,IAAI,CAACT,YAAY,CAACU,QAAQ,CAACH,WAAW,CAAC,EAAE;UACvC;UACA,MAAMI,QAAQ,GAAGC,kBAAkB,CAACL,WAAW;UAC/CT,MAAM,CAACe,IAAI,CAAC,mBAAmBF,QAAQ,EAAE;QAC3C;MACF;IACF,CAAC;;IAED;IACA,MAAMG,YAAY,GAAGrB,oBAAoB,CAAC,MAAM,MAAM,CAAC,+BAA+B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}